{"meta":{"title":"Y's blog","subtitle":"","description":"","author":"Roo1e","url":"https://sch01ar.github.io","root":"/"},"pages":[{"title":"å…³äº","date":"2023-10-24T03:02:05.262Z","updated":"2023-10-24T03:02:05.262Z","comments":false,"path":"about/index.html","permalink":"https://sch01ar.github.io/about/index.html","excerpt":"","text":"Â¶â˜ï¸about Â¶ğŸ Team å¼±åˆ°ä¸è¡Œçš„è§… ğŸ æ‰‹@Scr1w&amp;å¤§å‰åŒ— Do u know djb? Â¶è”ç³»æ–¹å¼ ğŸ§ MTUyOTU4OTk0Ng== âœ‰ï¸ yys1mple@163.com"},{"title":"ä¹¦å•","date":"2022-10-16T02:30:27.247Z","updated":"2022-10-15T08:09:45.464Z","comments":false,"path":"books/index.html","permalink":"https://sch01ar.github.io/books/index.html","excerpt":"","text":""},{"title":"åˆ†ç±»","date":"2022-10-16T02:33:21.117Z","updated":"2022-10-15T08:09:45.464Z","comments":false,"path":"categories/index.html","permalink":"https://sch01ar.github.io/categories/index.html","excerpt":"","text":""},{"title":"å‹æƒ…é“¾æ¥","date":"2022-10-17T01:02:57.129Z","updated":"2022-10-15T08:09:45.464Z","comments":false,"path":"links/index.html","permalink":"https://sch01ar.github.io/links/index.html","excerpt":"","text":""},{"title":"Repositories","date":"2022-10-16T03:25:28.438Z","updated":"2022-10-15T08:09:45.464Z","comments":false,"path":"repository/index.html","permalink":"https://sch01ar.github.io/repository/index.html","excerpt":"","text":""},{"title":"æ ‡ç­¾","date":"2022-10-16T02:41:49.050Z","updated":"2022-10-15T08:09:45.464Z","comments":false,"path":"tags/index.html","permalink":"https://sch01ar.github.io/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"2023DASCTF X 0psu3åä¸€æœˆæŒ‘æˆ˜èµ›","slug":"20230psu3CTF","date":"2023-12-12T11:05:45.000Z","updated":"2023-12-12T10:37:31.285Z","comments":true,"path":"2023/12/12/20230psu3CTF/","link":"","permalink":"https://sch01ar.github.io/2023/12/12/20230psu3CTF/","excerpt":"","text":"Â¶GeneratePrime è§£æœ€å¤šçš„é¢˜ï¼Œä½†æˆ‘ä¸ä¼šåšã€‚èµ›åä¸€çœ‹wpï¼Œå¥½å•ŠåŸæ¥æ˜¯åŸé¢˜ã€‚ç ”ç©¶ä¸€ä¸‹åŸç†ï¼Œæ„Ÿè§‰ç¡®å®éš¾åº¦å¯ä»¥ã€‚ Â¶é¢˜ç›® &lt;!â€“codeï¿¼0â€“&gt; Â¶åˆ†æ å‚è€ƒåšå®¢ $$n=(p4+p3+p^2+p+1)\\cdot p\\cdot r$$ $$p5-1=(p-1)\\cdot(p4+p3+p2+p+1)=(p-1)\\cdot q$$ æ„é€ ä¸€ä¸ªé˜¶ä¸º$p5-1$çš„åŸŸï¼Œåˆ©ç”¨å…¶ç”Ÿæˆå…ƒ$g$è®¡ç®—$gn$çš„é˜¶ã€‚ $$order(gn)=\\frac{p5-1}{gcd(n,p5-1)}=\\frac{p5-1}{q}=p-1$$ å¯¹äºé˜¶çš„å®šä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°é˜¶ä¸º$p-1$çš„ä»»æ„å…ƒç´ $a$æ»¡è¶³$a^{p-1}=1$ï¼Œ$1$æŒ‡å¹ºå…ƒã€‚ å‚è€ƒä¸Šè¿°åšå®¢ï¼Œåº”ç”¨ç¾¤ç¯åŸŸçš„æ€§è´¨å¾—åˆ°$gn=ax2+bx+c$ï¼Œå³è¡¨ç¤ºæˆåº¦æœ€å¤§ä¸ºäºŒçš„å¤šé¡¹å¼ã€‚ ç»“åˆä¸Šè¿°ä¸¤å¼å†™æˆå¦‚ä¸‹å½¢å¼ï¼š $$(0x2+0x+c){p-1}=1,c \\in (0,p)$$ æ­¤æ—¶ç”¨åˆ°å¦ä¸€æ¡æ€§è´¨ï¼Œé˜¶ä¸º$p-1$çš„å…ƒç´ ä¸ªæ•°ä¸º$\\phi(p-1)$ä¸ªï¼Œè€Œ$c$çš„å–å€¼ä¸ªæ•°è¦å¤§äº$\\phi(p-1)$ä¸ªï¼Œå› æ­¤$g^n$åªèƒ½ç”±å¸¸æ•°äº§ç”Ÿã€‚ è‡³æ­¤ä¸Šè¿°çš„åˆ†æéƒ½æ˜¯åœ¨é˜¶ä¸º$p5-1$çš„ç¯ä¸Šè¿›è¡Œçš„è®¨è®ºï¼Œè€Œå®é™…å½“ä¸­æˆ‘ä»¬å¹¶æ²¡æœ‰pï¼Œå€˜è‹¥æ„é€ å‡ºæ¨¡$n$çš„ç¯ï¼Œé‚£ä¹ˆåœ¨è¯¥ç¯ä¸Šè®¡ç®—å¾—åˆ°çš„$gn$çš„ä¸€æ¬¡é¡¹å’ŒäºŒæ¬¡é¡¹ç³»æ•°åº”è¯¥éƒ½æ˜¯$kp$ï¼Œè¿™æ ·å†ä¸$n$æ±‚è§£gcdå³å¯ã€‚ Â¶exp &lt;!â€“codeï¿¼1â€“&gt; Â¶FindPrime æ²¡å•¥æ„æ€ï¼Œå°±å—¯ç¼ï¼Œagcd+amm &lt;!â€“codeï¿¼2â€“&gt; Â¶exp &lt;!â€“codeï¿¼3â€“&gt; Â¶MathFactor1 Â¶é¢˜ç›® &lt;!â€“codeï¿¼4â€“&gt; Â¶æ€è·¯ä¸€ ç»™äº†$p{21}+q{17}$çš„ä½ä½ï¼Œç›¸å½“äºç»™äº†ä¸€ç»„å‰ªææ¡ä»¶ï¼Œä»ä½ä½å¼€å§‹çˆ†ç ´å³å¯ï¼Œæœ€åå¾—åˆ°çš„p_listéƒ½ä¸ç®—é•¿ï¼Œéå†ä¸€ä¸‹é€šè¿‡coppersmithæ‰“ä¸€ä¸ªé«˜ä½å°±å¯ã€‚è¿™æ˜¯å®˜æ–¹wpç»™çš„è§£æ³•ï¼Œç”¨å‰ªæç¡®å®ä¸å¥½æƒ³ï¼Œç»™äº†è¿™æ ·ä¸€ä¸ªé™åˆ¶å‰ªææ•ˆæœç¡®å®æŒºå¥½ã€‚ &lt;!â€“codeï¿¼5â€“&gt; Â¶æ€è·¯äºŒ é€šè¿‡è§£æ¨¡$2{300}$çš„æ–¹ç¨‹æ¥å¾—åˆ°å¯èƒ½çš„ä½300ä½pï¼Œ$d=p{21}+q^{17}$ï¼Œå†éå†æ±‚é«˜ä½å³å¯ã€‚ &lt;!â€“codeï¿¼6â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"æ ¼å¯†ç ","slug":"lattice","date":"2023-11-10T13:05:45.000Z","updated":"2023-11-11T01:24:42.882Z","comments":true,"path":"2023/11/10/lattice/","link":"","permalink":"https://sch01ar.github.io/2023/11/10/lattice/","excerpt":"","text":"Â¶çº¿æ€§ä»£æ•°å‰ç½®çŸ¥è¯† å…ˆå›é¡¾ä¸€ä¸‹å­¦æ ¡çº¿ä»£è¯¾ç¨‹è®²è¿‡çš„å‡ ä¸ªæ¦‚å¿µ Â¶å‘é‡ç©ºé—´ è®¾$V$æ˜¯ n å…ƒå‘é‡çš„é›†åˆï¼Œå¦‚æœ$V$éç©ºï¼Œå¹¶ä¸”å¯¹äºå‘é‡çš„çº¿æ€§è¿ç®—å°é—­(å³å¯¹ä»»æ„ $\\boldsymbol{v_1} \\in V,\\boldsymbol{v_2} \\in V,k \\in \\mathbb{R}$ ï¼Œéƒ½æœ‰ $\\boldsymbol{v_1+v_2} \\in V,k\\boldsymbol{v_1} \\in V$ )ï¼Œåˆ™ç§° $V$ æ˜¯ä¸€ä¸ªå‘é‡ç©ºé—´ã€‚ Â¶å‘é‡ç©ºé—´çš„åŸºä¸ç»´æ•° å‘é‡ç©ºé—´$V$çš„ä¸€ä¸ªæå¤§æ— å…³ç»„å«åš$V$çš„ä¸€ä¸ªåŸºï¼Œ$V$ çš„ç§©å«åš$V$çš„ç»´æ•°ï¼Œè®°ä½œ$dim(V)$ã€‚è‹¥ $dim(V)=r$ï¼Œåˆ™ç§°$V$ä¸º$r$ç»´å‘é‡ç©ºé—´ã€‚ è‹¥å·²çŸ¥$r$ç»´å‘é‡ç©ºé—´$V$çš„åŸºä¸º$\\boldsymbol{v_1,v_2,\\cdots,v_r}$ï¼Œåˆ™å‘é‡ç©ºé—´$V$å¯ä»¥è¡¨ç¤ºæˆ $$ V={ \\boldsymbol{v}=x_1\\boldsymbol{v_1}+x_2\\boldsymbol{v_2}+\\cdots +x_r\\boldsymbol{v_r} | x_1,x_2,\\cdots,x_r \\in \\mathbb{R}} $$ Â¶å‘é‡æ­£äº¤ä¸æ–½å¯†ç‰¹(Schmidt)æ­£äº¤åŒ– å½“$\\boldsymbol{a\\neq 0,b\\neq 0}$æ—¶ï¼Œå½“$(\\boldsymbol{a,b}=0)$ï¼Œå³$\\boldsymbol{a^Tb}=0$æ—¶ï¼Œç§°å‘é‡$\\boldsymbol{a,b}$æ­£äº¤ã€‚ ç”±ä¸¤ä¸¤æ­£äº¤çš„éé›¶å‘é‡ç»„æˆçš„å‘é‡ç»„ç§°ä¸ºæ­£äº¤å‘é‡ç»„ï¼Œç”±å•ä½å‘é‡ç»„æˆçš„æ­£äº¤å‘é‡ç»„ç§°ä¸ºæ ‡å‡†æ­£äº¤å‘é‡ç»„ã€‚ $n$ç»´æ¬§æ°ç©ºé—´æ±‚è§£æ­£äº¤åŸº,ä¸€ç»„åŸºåº•ä¸º$(\\alpha_1,\\alpha_2,\\cdots,\\alpha_n)$ Step1:ä»¤ $\\beta_1=\\alpha_1$ Step2:è®¡ç®—$\\alpha_2$åœ¨$\\beta_1$æ–¹å‘ä¸Šçš„æŠ•å½±ï¼Œå¹¶åšå·®å¾—åˆ° $$\\beta_2=\\alpha-\\frac{(\\beta_1,\\alpha_2)}{(\\beta_1,\\beta_1)}\\beta_1$$ Step3:è®¡ç®—$\\alpha_3$åœ¨å‘é‡$\\beta_1,\\beta_2$æ–¹å‘çš„æŠ•å½±ï¼Œç»§ç»­åšå·®å¾—åˆ°$\\beta_3$ Â¶æ ¼ $n$å…ƒå‘é‡çš„é›†åˆ $v_1,\\cdots,v_n \\in \\mathbb{R}^n$ï¼Œæ ¼ï¼ˆLatticesï¼‰å°±æ˜¯è¿™äº›å‘é‡çš„çº¿æ€§ç»„åˆ $$L={a_1v_1+a_2v_2+\\cdots+a_nv_n \\mid a_1,a_2,\\cdots,a_n \\in \\mathbb{Z}}$$ å¯¹æ¯”å‘é‡ç©ºé—´çš„å®šä¹‰ï¼Œå¯ä»¥å‘ç°ç³»æ•°æ˜¯æ•´æ•°ï¼Œå› æ­¤å®šä¹‰å‡ºæ¥çš„æ ¼ç©ºé—´æ˜¯ä¸€äº›æ ¼ç‚¹ï¼Œè€Œéè¿ç»­çš„å‘é‡ç©ºé—´ã€‚ ä¸‹å›¾æ˜¯ä¸€ä¸ªäºŒç»´æ ¼ï¼Œå¹³è¡Œå››è¾¹å½¢çš„ä¸€ç»„é‚»è¾¹æ˜¯æ ¼çš„åŸºåº•ã€‚é€šè¿‡å¯¹è¿™ä¸¤ä¸ªå‘é‡ä¸æ–­è¿›è¡Œçº¿æ€§ç»„åˆï¼Œé‚£ä¹ˆå°±äº§ç”Ÿäº†å¾ˆå¤šæ ¼ç‚¹ï¼Œå°±å½¢æˆäº†ä¸€ä¸ªæ ¼ã€‚ Â¶åŸºæœ¬åŸŸ å‡å®š $v_1,v_2,\\cdots,v_n$ æ˜¯æ ¼ $L$ çš„åŸºï¼Œ$F{v_1,v_2,\\cdots,v_n}={a_1v_1+a_2v_2+\\cdots+a_nv_n \\mid a_1,a_2,\\cdots,a_n \\in [0,1]}$ ä¸Šå›¾ä¸­çš„å¹³è¡Œå››è¾¹å½¢ï¼Œå°±æ˜¯äºŒç»´æ ¼ä¸­ä¸€ç»„åŸºåº•æ„æˆçš„åŸºæœ¬åŸŸã€‚ æ ¼åŸºæœ¬åŸŸçš„ä½“ç§¯ç­‰äºæ ¼çš„è¡Œåˆ—å¼çš„å€¼ï¼ŒåŸºæœ¬åŸŸçš„ä½“ç§¯å°±æ˜¯ç§¯åˆ†ï¼Œè€Œè¿™ä¹Ÿæ­£æ˜¯è¡Œåˆ—å¼çš„å‡ ä½•æ„ä¹‰ï¼Œ$Volume(F{v_1,v_2,\\cdots,v_n})=det(L)$ Â¶çŸ©é˜µè¡¨ç¤º å‡å®š $v_1,v_2,\\cdots,v_n$ æ˜¯æ ¼ $L$ çš„åŸºï¼Œ$w_1,w_2,\\cdots,w_n \\in L$ï¼Œåˆ™å¿…ç„¶å­˜åœ¨æ•´ç³»æ•° $a_{ij}$ ä½¿å¾—ï¼š $$ \\begin{cases} w_1=a_{11}v_1+a_{12}v_2+\\cdots+a_{1n}v_n \\ w_2=a_{21}v_1+a_{22}v_2+\\cdots+a_{2n}v_n \\ \\vdots \\ w_n=a_{n1}v_1+a_{n2}v_2+\\cdots+a_{nn}v_n \\end{cases} $$ å¯ä»¥æå–å‡ºä¸€ä¸ªç³»æ•°çŸ©é˜µ $$ A= \\begin{bmatrix} a_{1,1} &amp; a_{1,2} &amp; \\ldots &amp; a_{1,n}\\ a_{2,1} &amp; a_{2,2} &amp; \\ldots &amp; a_{2,n}\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\ a_{n,1} &amp; a_{n,2} &amp; \\ldots &amp; a_{n,n} \\end{bmatrix} $$ è¿›è€Œå°†ä¸Šè¿°æ–¹ç¨‹ç»„è½¬æ¢ä¸ºçŸ©é˜µè¡¨ç¤º$\\boldsymbol{w}=A * \\boldsymbol{v}$ Â¶LLL/BKZ ç®—æ³• ä¹‹å‰æ‰“å›½é™…èµ›çœ‹åˆ° discord é‡Œä¸€ç›´æœ‰äººèµç¾ flatterï¼Œåº”è¯¥æ˜¯åŠ é€Ÿ LLL ç”¨çš„ï¼Œæˆ‘è¿˜æ²¡é…å¥½ç¯å¢ƒã€‚ ä¸€ç§æ ¼åŸºçº¦ç®€ç®—æ³•ï¼Œå¯ä»¥æ‰¾åˆ°æ ¼ä¸Šçš„ä¸€ç»„æœ€çŸ­çš„æ­£äº¤åŸºã€‚ åœ¨Sagemathä¸­å¯ä»¥ç›´æ¥è°ƒç”¨å‡½æ•°ã€‚ ä½†å¯¹äºå‡½æ•°çš„å®ç°ä»¥åŠç®—æ³•çš„åŸç†æ²¡å¿…è¦æ·±ç©¶ï¼Œåœ¨å…·ä½“é¢˜ç›®å½“ä¸­ä¼šä½¿ç”¨å³å¯ã€‚ &lt;!â€“codeï¿¼0â€“&gt; ä¸‹å›¾æ˜¯é«˜æ–¯å¯å‘å¼ï¼Œä¸ºæˆ‘ä»¬å±•ç¤ºäº†æ ¼ä¸Šæœ€çŸ­å‘é‡çš„æ¬§å‡ é‡Œå¾—èŒƒæ•°çš„å¤§è‡´èŒƒå›´ã€‚ è¿™æ ·æˆ‘ä»¬å°±çŸ¥é“æ„é€ å‡ºæ¥çš„æ ¼ï¼Œæ˜¯å¦å¯ä»¥è§„çº¦å‡ºæˆ‘ä»¬çš„ç›®æ ‡å‘é‡ï¼Œä¹Ÿä¸ºæˆ‘ä»¬è°ƒæ•´æ ¼çš„å¹³è¡¡æä¾›äº†æ€è·¯ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨ä»¥ä¸‹å‡ ä¸ªé—®é¢˜å½“ä¸­å…·ä½“çœ‹ä¸€ä¸‹LLLç®—æ³•çš„åº”ç”¨ã€‚ Â¶lattice åº”ç”¨ ä¸‹é¢å°†é¦–å…ˆä»‹ç»ä¸¤ä¸ªæœ€åŸºæœ¬é—®é¢˜SVPå’ŒCVPï¼Œè¿™æ˜¯æ ¼ä¸Šçš„ä¸¤ä¸ªå›°éš¾é—®é¢˜ï¼Œéƒ½å±äº NP å®Œå…¨é—®é¢˜ã€‚å› æ­¤åœ¨è¿™ä¸¤ä¸ªå›°éš¾é—®é¢˜ä¸Šä¹Ÿå°†å»¶ä¼¸å‡ºå¾ˆå¤šæ ¼å¯†ç ä½“ç³»ã€‚ Â¶SVP æœ€çŸ­å‘é‡é—®é¢˜(Shortest Vector Problemï¼ŒSVP) è¿™æ˜¯æœ€åŸºæœ¬çš„ä¸€ä¸ªé—®é¢˜ï¼Œåç»­å¾ˆå¤šæ ¼é—®é¢˜æœ€ç»ˆéƒ½è½¬æ¢æˆäº†SVPé—®é¢˜ï¼Œä»LLLç®—æ³•ä¸­æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œæœ€ç»ˆå¾—åˆ°çš„æ˜¯æ ¼ä¸Šçš„æœ€çŸ­æ­£äº¤å‘é‡ç»„ã€‚ ä¸‹é¢ä»ä¸€ä¸ªä¾‹å­æ¥ä»‹ç»æ ¼çš„æ„é€ å’Œ LLL çš„åº”ç”¨ã€‚ &lt;!â€“codeï¿¼1â€“&gt; $$(p*f - 58 * f + q) % g = 44$$ $$k\\cdot g+44=(p-58)\\cdot f+q$$ æˆ‘ä»¬ç›®çš„æ˜¯é€šè¿‡$f,g$æ±‚å‡º$p,q$ï¼Œä»ä»£ç çš„å®šä¹‰å¯ä»¥çœ‹åˆ°ï¼Œ$p,q$çš„ä½æ•°ç›¸æ¯”äº$f,g$æ¥è¯´å¾ˆå°ï¼Œå› æ­¤å¯ä»¥åº”ç”¨æ ¼çš„æ€è·¯ï¼Œæ„é€ ä¸€ä¸ªåˆé€‚çš„æ ¼ï¼Œè§„çº¦å‡º$(p,q)$ å†™å‡ºå¦‚ä¸‹æ–¹ç¨‹ç»„ $$k\\cdot g-(p-58)\\cdot f=q-44$$ $$k\\cdot 0-(p-58)\\cdot (-1)=p-58$$ å¯ä»¥çœ‹åˆ°ç¬¬äºŒä¸ªå¼å­æ˜¯ä¸€ä¸ªæ’ç­‰å¼ï¼Œåœ¨æ„é€ æ ¼æ—¶æˆ‘ä»¬é€šå¸¸éœ€è¦åŠ å…¥è¿™æ ·çš„æ’ç­‰å¼ã€‚ ä¸‹é¢å°†æ–¹ç¨‹ç»„è½¬æ¢ä¸ºçŸ©é˜µã€‚ $$(k, p-58) \\begin{bmatrix}0&amp;g\\1&amp;-f \\end{bmatrix}=(p-58,q-44)$$ å¾—åˆ°äº†$v*B=w$çš„å½¢å¼ã€‚åœ¨è¿™ä¸ªå¼å­ä¸­æˆ‘ä»¬å…³å¿ƒçš„æ˜¯$w$å‘é‡æ˜¯å¦æ˜¯æ ¼$B$ä¸Šçš„æœ€çŸ­å‘é‡ï¼Œ$v$è¿™æ˜¯çº¿æ€§ç»„åˆçš„ç³»æ•°å¹¶ä¸ç”¨è¿‡å¤šå…³æ³¨ã€‚ åœ¨ä»‹ç»é«˜æ–¯å¯å‘å¼çš„æ—¶å€™ï¼Œæåˆ°äº†æ ¼ä¸Šæœ€çŸ­å‘é‡çš„æ¬§å‡ é‡Œå¾—èŒƒæ•°çš„å¤§è‡´èŒƒå›´ï¼Œæˆ‘ä»¬ç°åœ¨éªŒè¯ä¸€ä¸‹ï¼Œçœ‹çœ‹$w$æ˜¯å¦æ˜¯æ ¼$B$ä¸Šçš„æœ€çŸ­å‘é‡ï¼Œå³æ¯”è¾ƒé•¿åº¦$||w||$å’Œé«˜æ–¯æœŸæœ›å€¼$\\sigma(det(B))$ $$||w|| = \\sqrt{(p-58)2+(q-44)2}\\approx 2^{1024}$$ $$\\sigma(det(B))\\approx det(B)^{1/2}=\\sqrt{g}\\approx 2^{1024}$$ äºæ˜¯$w$å¤§æ¦‚ç‡ä¸ºæ ¼$B$ä¸Šçš„æœ€çŸ­å‘é‡ï¼Œæ„é€ æ ¼$B$è¿›è¡ŒLLLç®—æ³•å³å¯ã€‚ è¿˜æœ‰ä¸ªä¾‹å­å¯ä»¥çœ‹èƒŒåŒ…åŠ å¯† Â¶CVP æœ€è¿‘å‘é‡é—®é¢˜(Closest Vector Problem)ï¼Œæ ¼ä¸Šå¦ä¸€ä¸ªæœ€å¸¸è§çš„é—®é¢˜ã€‚ ç»™å®šæ ¼$L$çš„ä¸€ç»„åŸºä¸å‘é‡$v$ï¼Œæ‰¾åˆ°åœ¨$L$ä¸Šç¦»$v$æœ€è¿‘çš„ä¸€ä¸ªå‘é‡ã€‚ æ–¹ä¾¿ç†è§£è¿˜æ˜¯çœ‹ä¸€ä¸‹å‡ ä½•æ„ä¹‰ï¼Œåœ¨è¿ç»­ç©ºé—´ä¸­ä»»æ‰¾ä¸€ç‚¹$p$ï¼ˆæ³¨æ„ï¼šä¸ä¸€å®šåœ¨æ ¼ä¸Šï¼‰ï¼Œè¦æ‰¾åˆ°æ ¼ä¸Šè·ç¦»ç‚¹$p$æœ€è¿‘çš„ä¸€ä¸ªç‚¹ã€‚ Â¶LWE LWE é—®é¢˜(Learn With Error) Â¶ACD ACD é—®é¢˜(Approximate Common Divisor)ï¼Œè¿‘ä¼¼å…¬çº¦æ•°(åº”è¯¥ä¹Ÿå¯ä»¥å« AGCD) ç»™å®š$t$ç»„$x_i$æ»¡è¶³ï¼š$x_i=pq_i+r_i$ $x_i$ å·²çŸ¥ï¼Œ$p$ ä¸º $\\alpha$ ä½ï¼Œ$q_i$ ä¸º $\\beta$ ä½ ï¼Œ$r_i$ ä¸º $\\rho$ ä½ï¼ˆ$\\rho \\lt\\lt \\alpha$ï¼‰ï¼Œæ±‚ $p$ã€‚ $p$ç›¸å½“äº$t$ç»„$x$çš„è¿‘ä¼¼å…¬çº¦æ•°ï¼Œå› æ­¤è¦æ±‚äº†$r_i \\lt\\lt p$ æ„é€  $$(q_0,q_1,\\cdots,q_t)\\begin{bmatrix} 2^{\\rho} &amp; x_1 &amp; x_2 &amp; \\cdots &amp; x_t \\newline 0 &amp; -x_0 &amp; 0 &amp; \\cdots &amp; 0 \\newline 0 &amp; 0 &amp; -x_0 &amp; \\cdots &amp; 0 \\newline \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\newline 0 &amp; 0 &amp; 0 &amp; \\cdots &amp; -x_0\\end{bmatrix}=(q_02{\\rho},q_0x_1-q_1x_0,\\cdots,q_0x_t-q_tx_0)=(q_02{\\rho},q_0r_1-q_1r_0,\\cdots,q_0r_t-q_tr_0)$$ è®°ä¸º $v\\cdot B=w$ã€‚ ä½¿ç”¨LLLç®—æ³•å¾—åˆ° $q_02^{\\rho}$åå°±å¯ä»¥æ±‚å‡º$p$ã€‚ Â¶HNP","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"lattice","slug":"lattice","permalink":"https://sch01ar.github.io/tags/lattice/"}]},{"title":"ä¸€äº›å…³äºp^qé—®é¢˜å‰ªæç®—æ³•","slug":"å‰ªæ","date":"2023-11-07T04:05:45.000Z","updated":"2023-11-07T08:16:17.464Z","comments":true,"path":"2023/11/07/å‰ªæ/","link":"","permalink":"https://sch01ar.github.io/2023/11/07/%E5%89%AA%E6%9E%9D/","excerpt":"","text":"æ­¤ç¯‡æ–‡ç« é’ˆå¯¹ RSA ä¸­ p^q ç›¸å…³é—®é¢˜åŠå˜ç§åšä¸€ä¸ªæ€»ç»“ã€‚ä¹‹å‰åšè¿‡å¾ˆå¤š p^q ç›¸å…³çš„é—®é¢˜ï¼Œä½†æ˜¯æ€è·¯å¤§å·®ä¸å·®ï¼Œå‘¨æœ«æ‰“äº†é¹åŸæ¯ï¼Œå¤ç°æ—¶å‘ç°è¦ç»“åˆ copper å’Œ dfs æ¥å‰ªæã€‚ å‚è€ƒæ–‡ç«  https://tangcuxiaojikuai.xyz/post/342113ee.html https://mp.weixin.qq.com/s/Bi0iQOXwM5UlntrtdRL1oA Â¶p^q Â¶æœç´¢æ–¹å¼ ä»ä½ä½æœç´¢ï¼Œåœ¨å·²çŸ¥ p^q å’Œ p*q çš„æƒ…å†µä¸‹ï¼Œç”±äºå¼‚æˆ–æ˜¯æŒ‰ä½è¿›è¡Œçš„ï¼Œå¯¹äºæ¯ä¸€ä½å¼‚æˆ–çš„ç»“æœæ¥è¯´ï¼Œpã€q è¯¥ä½çš„ç»„åˆæƒ…å†µæœ‰ 4 ç§[1,0][0,1][1,1][0,0] Â¶å‰ªææ¡ä»¶ åˆ©ç”¨p*q==nè¿™ä¸€æ¡ä»¶æ¥è¿›è¡Œç­›é€‰ï¼Œç”±äºæ˜¯ä»ä½ä½å¼€å§‹çˆ†ç ´ï¼Œå› æ­¤æ»¡è¶³$p_{low}*q_{low}==n_{low}$ &lt;!â€“codeï¿¼0â€“&gt; Â¶p^q_rev &lt;!â€“codeï¿¼1â€“&gt; Â¶æœç´¢æ–¹å¼ ä»ä¸¤ç«¯çˆ†ç ´ æ¯ä¸€æ¬¡æœç´¢ï¼Œéœ€åˆ©ç”¨å½“å‰ gift ä¸¤ç«¯çš„ bit ä½ã€‚è¿™æ˜¯å› ä¸ºï¼Œgift çš„å½“å‰æœ€é«˜ä½å¯¹åº” p çš„æœ€é«˜ä½åŠ q çš„æœ€ä½ä½ï¼Œgift çš„å½“å‰æœ€ä½ä½å¯¹åº” p çš„æœ€ä½ä½åŠ q çš„æœ€é«˜ä½ Â¶å‰ªææ¡ä»¶ å°† pã€q æœªæœç´¢åˆ°çš„ä½å…¨å¡« 0ï¼Œä¹˜ç§¯åº”å°äº n å°† pã€q æœªæœç´¢åˆ°çš„ä½å…¨å¡« 1ï¼Œä¹˜ç§¯åº”å¤§äº n pã€q ä½ k ä½ä¹˜ç§¯å†å–ä½ k ä½ï¼Œåº”ä¸ n çš„ä½ k ä½ç›¸åŒ &lt;!â€“codeï¿¼2â€“&gt; Â¶p^(q&gt;&gt;nbits) &lt;!â€“codeï¿¼3â€“&gt; Â¶æ€è·¯ è¿™ä¸ªå…¶å®å¹¶ä¸ç®—å‰ªæäº†ï¼Œå› ä¸º gift çš„é«˜ 16 ä½å°±æ˜¯ P çš„é«˜ 16 ä½ã€‚ç”¨ N é™¤ä»¥ P åå¾—åˆ°çš„å°±æ˜¯ Q çš„é«˜ä½ï¼Œå†æ¬¡åˆ©ç”¨ Q çš„é«˜ä½å’Œ giftï¼Œå¯ä»¥æ±‚å‡º P çš„ 16 ï½ 32 ä½ï¼Œä»¥æ­¤ç±»æ¨æ¥æ¢å¤ Pã€Qã€‚ &lt;!â€“codeï¿¼4â€“&gt; Â¶(p^q)&gt;&gt;nbits &lt;!â€“codeï¿¼5â€“&gt; Â¶æœç´¢æ–¹å¼ ä»é«˜ä½æœç´¢ p çš„é«˜ä½ä¹˜ q çš„é«˜ä½çš„å‰åŠéƒ¨åˆ†ç­‰äº n çš„é«˜ä½ Â¶å‰ªææ¡ä»¶ ä½ä½å…¨è¡¥ 0ï¼Œç›¸ä¹˜ç»“æœ &lt; n ä½ä½å…¨è¡¥ 1ï¼Œç›¸ä¹˜ç»“æœ &gt; n &lt;!â€“codeï¿¼6â€“&gt; Â¶coppersmith ä¸Šè¿°å‰ªæåªèƒ½æ±‚å‡ºé«˜ 262 ä½äº†ï¼Œæœ‰å¤šç§ç»„åˆï¼Œä½†ä»ç¼ºå°‘ä½ 250 ä½ï¼Œå› æ­¤éœ€è¦ç”¨åˆ° coppersmith æ¥æ±‚è§£ã€‚ åœ¨å…·ä½“åº”ç”¨æƒ…æ™¯ä¸­åº”å½“é€‚å½“è°ƒæ•´betaå’Œepsilonã€‚ &lt;!â€“codeï¿¼7â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"2023CBCTF","slug":"2023CBCTF","date":"2023-11-01T12:23:06.239Z","updated":"2023-11-02T11:34:49.710Z","comments":true,"path":"2023/11/01/2023CBCTF/","link":"","permalink":"https://sch01ar.github.io/2023/11/01/2023CBCTF/","excerpt":"","text":"ä¹‹å‰å’Œ N1CTF æ’äº†ï¼Œä½†æ˜¯æ¯”èµ›é¢˜ç›®è´¨é‡å¾ˆé«˜ï¼Œå½“æ—¶æµ…çœ‹äº†ä¸€ä¸‹ï¼Œç°åœ¨è¡¥ä¸€ä¸‹ã€‚ Â¶CB_Curve åˆ©ç”¨ Grobner åŸºè§£ P ç‚¹ï¼Œåç»­å¤ç°æ‰çŸ¥é“è¿™æ˜¯HUFFæ›²çº¿ï¼Œæ ¹æ®è®ºæ–‡æ–¹æ³•å¾—åˆ°æ›²çº¿çš„å®šä¹‰å’Œæ˜ å°„æ–¹æ³•ï¼Œè¿™æ ·å°±å¯å¾—åˆ°ç»´å°”æ–¯ç‰¹æ‹‰æ–¯å½¢å¼ï¼Œåç»­é€šè¿‡å…‰æ»‘é˜¶æ±‚è§£ç¦»æ•£å¯¹æ•°å³å¯ã€‚ å…³äº Grobner åŸºçš„åº”ç”¨ï¼Œæƒ³åˆ°æš‘å‡0x401å¸ˆå‚…å‡ºçš„ä¸€é“é¢˜ï¼Œåç»­å†™åœ¨è¿™é“é¢˜åé¢ï¼ŒåŠ æ·±ä¸€ä¸‹å°è±¡ã€‚ æ›²çº¿å½¢å¼ $$ x(a2y-1)â‰¡y(bx2-1) mod \\quad p $$ æ›²çº¿æ˜ å°„ $$ (x,y)â†’(\\frac{bx-ay}{y-x},\\frac{b-a}{y-x}) $$ ç›®æ ‡æ›²çº¿ $$ y2â‰¡x3+(a+b)x^2+abx \\quad mod \\quad p $$ &lt;!â€“codeï¿¼0â€“&gt; Â¶ezAlgebra(DASCTF 2023 &amp; 0X401) é¢˜ç›®æè¿° &lt;!â€“codeï¿¼1â€“&gt; ä¸€å…ƒ coppersimth ç”¨ c1 æ±‚ tï¼Œä»è€Œè·å¾— p &lt;!â€“codeï¿¼2â€“&gt; æ ¹æ® c2ã€c3 å»ºç«‹ä¸¤ä¸ªå¤šé¡¹å¼ &lt;!â€“codeï¿¼3â€“&gt; è™½ç„¶åªæœ‰ m æœªçŸ¥ï¼Œä½†ä½¿ç”¨ Grobner åŸºéœ€è¦è‡³å°‘äºŒå…ƒå¤šé¡¹å¼ï¼Œæ‰€ä»¥å¼•å…¥ tï¼ŒåŒç†å¼•å…¥f3 = t-2915836867ï¼Œæ¥ä¸‹æ¥é‡‡ç”¨ Grobner è·å¾—ç†æƒ³åŸºå³å¯ã€‚ &lt;!â€“codeï¿¼4â€“&gt; æœ€ç»ˆè§£ flag &lt;!â€“codeï¿¼5â€“&gt; Â¶CB_RSA &lt;!â€“codeï¿¼6â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"2023ACTF","slug":"2023ACTF","date":"2023-10-30T12:05:45.000Z","updated":"2023-10-31T09:16:26.024Z","comments":true,"path":"2023/10/30/2023ACTF/","link":"","permalink":"https://sch01ar.github.io/2023/10/30/2023ACTF/","excerpt":"","text":"å‘¨æœ«æ‰“äº†ä¸€ä¸‹ ACTFï¼Œé¢˜ç›®è´¨é‡å¾ˆé«˜ã€‚æ€»å…± 6 é“é¢˜ç›®åšäº† 3 é“ï¼Œæœ‰ä¸€é“å¡ç€ç­‰åç»­å¤ç°ã€‚æœ€è¿‘å¤ªç´¯äº†ï¼Œå‘¨æœ«æ¯”èµ›ï¼Œå‘¨å†…å¤ç°ã€‚ã€‚ã€‚ğŸ­ğŸ­ æˆ‘å•Šï¼Œæ‰“ CTF æ‰“çš„ï¼ Â¶MDH æ‰‹å¿«æŠ¢äº†ä¸ªä¸‰è¡€ hh çœ‹åˆ°è¿™é“é¢˜ç¬¬ä¸€ååº”æ˜¯æ­»å»çš„çº¿ä»£å¼€å§‹æ”»å‡»æˆ‘ï¼Œå¥½åœ¨è¿˜æœ‰ç‚¹å°è±¡ï¼Œå¯¹äºçŸ©é˜µçš„è¿¹æ¥è¯´ï¼Œå°±æ˜¯å¯¹è§’çº¿å…ƒç´ çš„å’Œã€‚ &lt;!â€“codeï¿¼0â€“&gt; å°†sharedçš„çŸ©é˜µè¡¨ç¤ºä¸º$a_1^T\\cdot b_1\\cdot b_2^T \\cdot a_2$ è€Œé¢˜ç›®å·²çŸ¥$PKA=a_1\\cdot a_2^T,PKB=b_1\\cdot b_2^T$ å¯¹äºè¿¹çš„ä¸€ä¸ªæ€§è´¨æ¥è¯´ï¼Œè‹¥å¹²å‘é‡ç›¸ä¹˜æ‰€å¾—çš„æ–¹é˜µï¼Œæ”¹å˜å…¶ç›¸ä¹˜é¡ºåºï¼ŒçŸ©é˜µçš„è¿¹éƒ½åº”ä¸€è‡´ã€‚ å› æ­¤åªéœ€è®¡ç®—$PKA^T\\cdot PKB$çš„è¿¹å³å¯ã€‚ &lt;!â€“codeï¿¼1â€“&gt; Â¶claw crane é¢˜å¦‚å…¶åï¼ŒçœŸç‰›é­”æŠ“å¨ƒå¨ƒ &lt;!â€“codeï¿¼2â€“&gt; æ€»ä¹‹å°±æ˜¯è¦åœ¨ä½ æ„é€ å‡ºçš„ 128 ä½æ•°å½“ä¸­éšæœºé€‰æ‹©é€‰åˆ° 0 æ‰ä¼šåŠ åˆ†ï¼Œ256 æ¬¡ä¸­éœ€è¦æ­£ç¡® 220 æ¬¡ï¼Œå› æ­¤å°±æƒ³æ–¹è®¾æ³•è®©æ•°å­—çš„ 2 è¿›åˆ¶ 0 å¤šä¸€äº›ï¼Œdelta = abs(r * q - p * pow(2, 128))ï¼Œr å·²çŸ¥ï¼Œéœ€è¦æˆ‘ä»¬ä¼ å…¥ pã€qï¼Œç”±äº$p\\cdot 2^{128}$ç›¸å½“äºå·¦ç§» 128 ä½ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿè¦è®© rq çš„ä½ä½å°½å¯èƒ½ä¹Ÿä¸º 0ï¼Œq ä¸èƒ½è¶…è¿‡ 2^64 æ¬¡æ–¹ï¼Œå› æ­¤ q çš„å–å€¼å¯ä»¥ä¸º$2{63},2{63}+2{62},2{62}â€¦$ å¯¹äºç»™å®šçš„ r å’Œ q è®¡ç®—ä¸€ä¸ª p å€¼ï¼Œåœ¨å¤šç»„å½“ä¸­è¿›è¡Œ delta ä¸­ 0 ä¸ªæ•°çš„è®¡ç®—ï¼Œé€‰æ‹© 0 ä¸ªæ•°æœ€é«˜çš„ä¸€ç»„ pã€q å‘é€ï¼Œåˆ†æ•°å¯ä»¥ç¨³å®šåœ¨ 2000 ä»¥ä¸Šï¼Œè¿æ°”å¥½ä¸€ä¼šå°±å‡ºäº†ã€‚ &lt;!â€“codeï¿¼3â€“&gt; Â¶Easy RSA é¢˜ç›® &lt;!â€“codeï¿¼4â€“&gt; å…³é”®ä¿¡æ¯ &lt;!â€“codeï¿¼5â€“&gt; è¯´æ˜äº†è¿™ä¸€ç»„e_,d_æ»¡è¶³ä¸‰ä¸ªæ¨¡æ•° nï¼Œç›¸å½“äºå·²çŸ¥ä¸‰ç»„ nã€eï¼Œå¯¹äºé¢˜ç›®æ‰€é™åˆ¶çš„ d çš„ä½æ•°ï¼Œåˆšå¥½æ»¡è¶³é€ æ ¼çš„æƒ…å†µ &lt;!â€“codeï¿¼6â€“&gt; Â¶Review æ­¤éƒ¨åˆ†åœ¨é˜…è¯»å…¶ä½™é˜Ÿä¼ wp åçš„å¤ç›˜ï¼Œå¯¹äºä¸Šé¢˜ï¼Œæ ¼çš„å…·ä½“æ„é€ æ€è·¯æè¿°å¦‚ä¸‹ï¼š $$ \\begin{aligned} ED -k_1N_1 &amp;= 1+k_1x_1 \\ ED -aN_2 &amp;= 1+ax_2 \\ ED -dN_3 &amp;= 1+dx_3 \\end{aligned} $$ æ„é€ æ ¼: $$ \\begin{bmatrix} 2^{767} &amp; E &amp;E&amp;E\\ 0 &amp; -N_1 &amp;0&amp;0\\ 0 &amp; 0 &amp;-N_2&amp;0\\ 0 &amp; 0 &amp;0&amp;-N_3\\ \\end{bmatrix} $$ Â¶Mid RSA(èµ›åå¤ç°) ä¸ Easy ä¸åŒçš„åœ°æ–¹åœ¨äºå°† d ä½æ•°æé«˜ï¼ŒåŸæœ¬çš„æ ¼æ— æ³•è§„çº¦å‡ºæ¥ï¼Œå½“æ—¶è°ƒæ ¼å­è°ƒåäº†ï¼Œä½†æ˜¯çœŸæ²¡æƒ³åˆ°æœ¬åœ°ç”Ÿæˆä¸€ç»„æ•°å’Œä¸Šä¸€é¢˜å¯¹æ¯”ä¸€ä¸‹ï¼Œä¸Šé¢˜çš„æ ¼å­æ‹¿è¿‡æ¥åªæ˜¯å·®äº†å‡ ä½ä½ä½ã€‚ã€‚ã€‚ &lt;!â€“codeï¿¼7â€“&gt; å¯¹äº $$ \\begin{aligned} e(d_h\\times2^{16}+d_l) -1 &amp;= k_1\\phi(N_1) \\ e(d_h\\times2^{16}+d_l) -1 &amp;= k_2\\phi(N_2) \\ e(d_h\\times2^{16}+d_l) -1 &amp;= k_3\\phi(N_3) \\end{aligned} $$ æœ‰ $$ \\begin{aligned} e2^{16}d_h+ed_l -k_1N_1 &amp;= 1+k_1s_1 \\ e2^{16}d_h+ed_l -k_2N_2 &amp;= 1+k_2s_2 \\ e2^{16}d_h+ed_l -k_3N_3 &amp;= 1+k_3s_3 \\end{aligned} $$ æ„é€ æ ¼: $$ \\begin{bmatrix} 1 &amp; e2^{16} &amp;e2{16}&amp;e2{16}&amp;0\\ 0 &amp; -N_1 &amp;0&amp;0&amp;0\\ 0 &amp; 0 &amp;-N_2&amp;0&amp;0\\ 0 &amp; 0 &amp;0&amp;-N_3&amp;0\\ 0 &amp; ed_l&amp;ed_l&amp;ed_l&amp;1\\ \\end{bmatrix} $$ æ„é€ æ–¹æ³•å‚è€ƒæ˜Ÿç›Ÿ 0HB å¸ˆå‚…ï¼Œè‡³äºä¸ºä½•æ˜¯ä½ä½ 16 ä½ï¼Œå¸ˆå‚…ç»™å‡ºçš„è§£é‡Šæ˜¯ï¼Œæœ¬åœ°æµ‹äº†ä¸€ç»„æ•°æ®ï¼Œå‘ç°ç”¨ä¸Šä¸€é¢˜çš„æ ¼å­è·‘å‡ºæ¥ç›¸å·®äº† 16 ä½ï¼Œä½†å…·ä½“ç›¸å·®å¤šå°‘è¿˜éœ€è¦å…·ä½“ç ”ç©¶ï¼Œç”±äº 16 ä½å·²è¶³å¤Ÿçˆ†ç ´ï¼Œå› æ­¤å…¬å¼ä¸­å†™ä¸ºäº† 16 æ¬¡æ–¹ã€‚ ç»æœ¬äººæµ‹è¯•ï¼Œå¯¹äºæœ¬é¢˜çš„ d ç¼ºå¤±äº† 7 ä½ã€‚ &lt;!â€“codeï¿¼8â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"2023N1CTF","slug":"N1CTF2023","date":"2023-10-23T12:05:45.000Z","updated":"2023-10-30T02:44:11.760Z","comments":true,"path":"2023/10/23/N1CTF2023/","link":"","permalink":"https://sch01ar.github.io/2023/10/23/N1CTF2023/","excerpt":"","text":"å‘¨æœ«å’Œå‰å¤§ä¸œå¤§çš„å¥½å“¥å“¥ä»¬æ‰“äº† n1ï¼Œæœ€åæ‹¿äº† rank7ï¼Œè¢« webğŸ‘´ å’Œ pwnğŸ‘´ å¸¦é£ DJB æˆ˜é˜Ÿ wp:https://mp.weixin.qq.com/s/N03QtNsMvpux42xIAXxvrA e2W@rmup ECDSA æ¤­åœ†æ›²çº¿ç­¾åï¼Œä¹‹å‰æ²¡ç”¨è¿‡ecdsaåº“ï¼Œç»“æœå‘ç° d å°±æ˜¯ç§é’¥ï¼Œæ‹†åˆ†ä¸€ä¸‹é«˜ä½ä½ï¼ŒäºŒå…ƒ coppersmith æ¢­ä¸€ä¸‹ï¼Œä¸­é—´å¯èƒ½è¦è¡¥ä¸€ä½ï¼Œè¡¥äº† 0 ä¹‹åå°±å¯ä»¥äº†ã€‚ åé¢çœ‹å¸ˆå‚…ä»¬åšå®¢è¿˜å¯ä»¥ç”¨æ ¼åšï¼Œå­¦åˆ°äº†ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475from Crypto.Util.number import *import itertoolsimport hashlibfrom Crypto.Cipher import AESdef small_roots(f, bounds, m=1, d=None): if not d: d = f.degree() R = f.base_ring() N = R.cardinality() f /= f.coefficients().pop(0) f = f.change_ring(ZZ) G = Sequence([], f.parent()) for i in range(m + 1): base = N ^ (m - i) * f ^ i for shifts in itertools.product(range(d), repeat=f.nvariables()): g = base * prod(map(power, f.variables(), shifts)) G.append(g) B, monomials = G.coefficient_matrix() monomials = vector(monomials) factors = [monomial(*bounds) for monomial in monomials] for i, factor in enumerate(factors): B.rescale_col(i, factor) B = B.dense_matrix().LLL() B = B.change_ring(QQ) for i, factor in enumerate(factors): B.rescale_col(i, 1 / factor) H = Sequence([], f.parent().change_ring(QQ)) for h in filter(None, B * monomials): H.append(h) I = H.ideal() if I.dimension() == -1: H.pop() elif I.dimension() == 0: roots = [] for root in I.variety(ring=ZZ): root = tuple(R(root[var]) for var in f.variables()) roots.append(root) return roots return []msg = b&#x27;welcome to n1ctf2023!&#x27;msg_hash = bytes_to_long(hashlib.sha256(msg).digest())s = 98064531907276862129345013436610988187051831712632166876574510656675679745081r = 9821122129422509893435671316433203251343263825232865092134497361752993786340p = 115792089210356248762697446949407573529996955224135760342422259061068512044369leak = int(&quot;10000111001100100010110100100000000100101000111011000001001011010100001010010000101001100011011010100000010010011011100010111001&quot;, 2)P.&lt;low,small&gt; = PolynomialRing(Zmod(p))f = r*((small*(2^128))+low)+msg_hash-(leak&lt;&lt;128)*s-small*sroots = small_roots(f, [2^129, 2^130], m=3, d=4)print(roots)low = 109657576978117277727118025094273115603high = 222660286808164019769040839717358598716d = bin(high)[2:]+&#x27;0&#x27;+bin(low)[2:]d = int(d, 2)print(d.bit_length())aes = AES.new(long_to_bytes(d), mode=AES.MODE_ECB)cipher = b&#x27;\\xf3#\\xff\\x17\\xdf\\xbb\\xc0\\xc6v\\x1bg\\xc7\\x8a6\\xf2\\xdf~\\x12\\xd8]\\xc5\\x02Ot\\x99\\x9f\\xf7\\xf3\\x98\\xbc\\x045\\x08\\xfb\\xce1@e\\xbcg[I\\xd1\\xbf\\xf8\\xea\\n-&#x27;flag = aes.decrypt(cipher)print(flag)# b&#x27;n1ctf&#123;Wow!__You_bre4k_my_s1gn_chal1enge!!___&#125;\\x03\\x03\\x03&#x27; e2d1p[èµ›åå¤ç°] å‚è€ƒæ–‡ç« ï¼š https://tl2cents.github.io/2023/10/23/2023-N1CTF-Crypto-Writeups/ https://github.com/Nu1LCTF/n1ctf-2023/tree/main/crypto/e2D1p é¢˜ç›® Based on N1CTF 2022 â€œezdlpâ€. Easy dlp too, try again : ). 12345678910111213141516171819202122232425from Crypto.Util.number import *import osFLAG = os.environ.get(&#x27;FLAG&#x27;, b&#x27;n1ctf&#123;XXXXFAKE_FLAGXXXX&#125;&#x27;)assert FLAG[:6] == b&#x27;n1ctf&#123;&#x27; and FLAG[-1:] == b&#x27;&#125;&#x27;FLAG = FLAG[6:-1]def keygen(nbits): while True: q = getPrime(nbits) if isPrime(2*q+1): if pow(0x10001, q, 2*q+1) == 1: return 2*q+1def encrypt(key, message, mask): return pow(0x10001, message^mask, key)p = keygen(512)flag = bytes_to_long(FLAG)messages = [getRandomNBitInteger(flag.bit_length()) for i in range(200)]enc = [encrypt(p, message, flag) for message in messages]print(f&#x27;message = &#123;messages&#125;&#x27;)print(f&#x27;enc = &#123;enc&#125;&#x27;) 0x01 æ¢å¤æ¨¡æ•° p ç»™äº† 200 ç»„ mã€c æ»¡è¶³ç­‰å¼\\(65537^{m_iâŠ•mask}=c_i (mod p)\\) å¼‚æˆ–è¿ç®—åœ¨æŒ‡æ•°ä¸Šï¼Œæ²¡æœ‰ä»€ä¹ˆè¿ç®—æ€§è´¨ã€‚ä½†å¼‚æˆ–çš„æœ¬è´¨è¿˜æ˜¯æŒ‰ä½å¼‚æˆ–ï¼Œä»¥ä¸‹ç”¨ m[i]è¡¨ç¤º m çš„ç¬¬ i ä½ï¼Œå¯¹äºä¸€ç»„ m å’Œ c è€Œè¨€ \\[m\\oplus mask = mask+ \\sum\\limits_{j=0}\\limits^{158}(m[j]\\cdot2^i\\cdot(-1)^{s[i]})\\] è¿™æ ·è½¬æ¢åå³å¯æŠŠåº•æ•°çœ‹ä½œ\\(c_i=65537^{mask}\\)ï¼Œä¸‹ä¸€æ­¥çš„ç›®çš„å°±æ˜¯æ‰¾åˆ°æŸä¸ªå‘é‡\\(e_i\\)ä½¿å¾—\\(c_i^{e_i}â‰¡0\\;mod\\;p\\)ï¼Œè¿™æ ·å³å¯æ¢å¤å‡ºæ¨¡æ•°\\(gcd(e_i,e_j)=p\\) æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„\\(e_i\\)éœ€è¦\\(m_i\\)ï¼Œæ„é€ å¦‚ä¸‹æ ¼ï¼š \\(m_{i,j}=m_{i,j}*2^{256}\\) \\[ \\begin{bmatrix} m_{0,0} &amp; m_{0,1} &amp; \\ldots &amp; m_{0,158} &amp; 1 &amp; 0 &amp; \\ldots &amp;0\\\\ m_{1,0} &amp; m_{1,1} &amp; \\ldots &amp; m_{1,158} &amp; 0 &amp; 1&amp; \\ldots &amp;0\\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots &amp; \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots\\\\ m_{199,0} &amp; m_{199,1} &amp; \\ldots &amp; m_{199,158} &amp; 0 &amp;0&amp; \\ldots &amp;1\\\\ \\end{bmatrix} \\] åˆ©ç”¨LLLç®—æ³•å¾—åˆ°çš„\\(e_i\\)æ»¡è¶³\\(\\sum\\limits_{i=1}\\limits^{200}e_i=0\\)ï¼Œé‚£ä¹ˆä¹Ÿå°±æ»¡è¶³\\(\\sum\\limits_{i=1}\\limits^{200}e_i\\cdot m_i=\\vec{0}\\) 0x02 æ±‚è§£ mask x=mask \\[65537^{\\sum2^i\\cdot(x_i\\oplus m_i)}=c (mod \\;p)\\] å˜æ¢æˆå¦‚ä¸‹å½¢å¼ \\[(65537)^{\\sum\\limits_{\\{i|m_i=0\\}}2^i\\cdot x_i+\\sum\\limits_{\\{j|m_j=1\\}}2^j\\cdot(1-x_j)}=c\\;(mod \\;p)\\] \\[(65537)^{\\sum\\limits_{\\{i|m_i=0\\}}2^i\\cdot x_i+\\sum\\limits_{\\{j|m_j=1\\}}2^j\\cdot(-x_j)}=c\\cdot 65537^{-\\sum\\limits_{\\{j|m_j=1\\}}2^j} (mod \\;p)\\] æ ¹æ®ä¸Šå¼ä¸­\\(m_i\\)ä¸º 0 æˆ– 1 çš„æƒ…å†µæ„é€ å¯¹åº”\\(x_i\\)çš„ç³»æ•°çŸ©é˜µ\\(A\\)ï¼Œç³»æ•°åªä¸º 1 æˆ–-1 è®¡ç®—å‘é‡\\(u\\cdot A=(1,0,\\cdots,0)\\;(mod \\;q)\\)ï¼ˆæ¨¡ q æ˜¯ä¿è¯é˜¶ä¸ºç´ æ•°ï¼Œä½¿å¾—å‘é‡æœ‰è§£ï¼‰ å½“\\(mask_i=0\\)æ—¶ï¼Œä¾¿å¯æŒ‰ä¸‹å¼é€ä½æ¢å¤ mask \\[\\prod\\limits_{i=1}\\limits^{200}c_i^{u_i}=65537^0=1(mod\\;p)\\] \\[c_i=c_i\\cdot 65537^{-\\sum\\limits_{\\{j|m_j=1\\}}2^j}(mod\\;p)\\] exp 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970from tqdm import tqdmfrom Crypto.Util.number import *from ast import literal_evalfrom Crypto.Util.number import *lines = open(&quot;./output.txt&quot;, &quot;r&quot;).readlines()message = literal_eval(lines[0].strip())enc = literal_eval(lines[1].strip())m_l = 159dim = 200L = matrix(ZZ, dim, dim+m_l+1)g = 2 ^ 512for i in range(dim): L[i, i] = 1 L[i, dim+m_l] = gfor i in range(dim): line = bin(message[i])[2:].rjust(m_l, &#x27;0&#x27;) for j in range(len(line)): if int(line[j]): L[i, dim+j] = g else: L[i, dim+j] = 0basis = L.LLL()[:40]p = []for item in basis: g1 = 1 g2 = 1 vec = item[:dim] for i in range(len(vec)): if vec[i] &gt;= 0: g1 *= pow(enc[i], vec[i]) else: g2 *= pow(enc[i], -vec[i]) p.append(g1-g2)p = list(factor(reduce(GCD, p)))[-1][0]q = (p-1)//2A = matrix(Zmod(q), dim, m_l)for i in range(dim): line = bin(message[i])[2:].rjust(m_l, &#x27;0&#x27;) for j in range(len(line)): if int(line[j]): A[i, j] = -1 enc[i] = enc[i]*inverse_mod(pow(0x10001, 2 ^ (m_l-1-j), p), p) % p else: A[i, j] = 1m = &#x27;&#x27;for _ in tqdm(range(m_l)): v = vector(Zmod(q), [0]*_+[1]+[0]*(m_l-1-_)) u = A.solve_left(v) sign = 1 for i in range(len(u)): if u[i] &gt;= 0: sign = sign*pow(enc[i], int(u[i]), p) % p else: sign = sign*inverse_mod(pow(enc[i], -int(u[i]), p), p) % p if sign != 1: m += &#x27;1&#x27; else: m += &#x27;0&#x27;print(bytes.fromhex(hex(int(m, 2))[2:]))","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"LCG","slug":"LCG","date":"2023-06-19T03:05:45.000Z","updated":"2023-10-24T02:36:43.275Z","comments":true,"path":"2023/06/19/LCG/","link":"","permalink":"https://sch01ar.github.io/2023/06/19/LCG/","excerpt":"","text":"Â¶LCG çº¿æ€§åŒä½™ï¼ˆLCGï¼‰æ˜¯äº§ç”Ÿä¼ªéšæœºæ•°çš„æ–¹æ³•ã€‚ Â¶åŸºæœ¬å½¢å¼ï¼š $$ X_{n+1}=(aX_n+b);mod;m $$ Â¶åŸºæœ¬å…¬å¼ Â¶å…¬å¼ä¸€ æ±‚é€’å½’æ•°ç»„å…ƒç´  $$X_n=a^{-1}(X_{n+1}-b);mod;m$$ Â¶å…¬å¼äºŒ æ±‚å‚æ•° a åˆ©ç”¨ä¸¤ä¸ªé€’å½’å¼æ¶ˆå» b å¾—åˆ° a $$a=(X_{n+2}-X_{n+1})(X_{n+1}-X_n)^{-1}$$ Â¶å…¬å¼ä¸‰ æ±‚å‚æ•° b $$b=(X_{n+1}-aX_{n});mod;m$$ Â¶å…¬å¼å›› æ±‚å‚æ•° m $$t_n=X_{n+1}-X_n$$ $$t_n=(aX_n+b)-(aX_{n-1}+b);mod;m$$ $$t_{n+1}t_{n-1}-t_nt_n=0;mod;m$$ $$T_n=t_{n+1}t_{n-1}-t_nt_næ˜¯ m çš„å€æ•°$$ $$m=gcd(T_n,T_{n-1})$$ Â¶ç›¸å…³æ±‚è§£ä»£ç  &lt;!â€“codeï¿¼0â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"D^3CTF","slug":"d3ctf2023","date":"2023-05-07T06:05:45.000Z","updated":"2023-05-10T12:22:25.734Z","comments":true,"path":"2023/05/07/d3ctf2023/","link":"","permalink":"https://sch01ar.github.io/2023/05/07/d3ctf2023/","excerpt":"","text":"d3noisy &lt;!â€“codeï¿¼0â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"RSA(æŒç»­æ›´æ–°ğŸ«¡)","slug":"RSA","date":"2023-04-20T13:05:45.000Z","updated":"2023-11-03T02:27:06.700Z","comments":true,"path":"2023/04/20/RSA/","link":"","permalink":"https://sch01ar.github.io/2023/04/20/RSA/","excerpt":"","text":"åŸºæœ¬åŸç† RSA ä¸­åŠ ã€è§£å¯†ï¼š åŠ å¯†$c = m^e\\quad mod\\quad n$ è§£å¯†$m = c^d\\quad mod\\quad n$ æ¥ä¸‹æ¥è¯æ˜ä¸€ä¸‹è§£å¯†è¿‡ç¨‹ï¼Œå…ˆå¼•å…¥æ¬§æ‹‰å®šç†ã€‚ Â¶æ¬§æ‹‰å®šç† å¯¹äºäº’ä¸ºè´¨æ•°çš„ mã€n ä¸¤ä¸ªæ•°ï¼Œæœ‰$m^{\\phi(n)} = 1\\quad mod\\quad n$ï¼Œå…¶ä¸­$\\phi(n)$è¡¨ç¤ºå°äº n çš„è´¨æ•°çš„ä¸ªæ•°ã€‚ Â¶è§£å¯†åŸç† é€šè¿‡$c = m^e\\quad mod\\quad n$ä¸æ¬§æ‹‰å®šç†$m^{\\phi(n)} = 1\\quad mod\\quad n$ï¼Œæˆ‘ä»¬ä¾¿å¯è¿›è¡Œæ¨å¯¼ã€‚ å¯¹æ¬§æ‹‰å®šç†è¿›è¡Œå˜å½¢ï¼Œå¾—åˆ°$m^{k\\phi(n)+1} = m\\quad mod\\quad n$ å› ä¸ºæˆ‘ä»¬å·²ç»çŸ¥é“$c = m^e\\quad mod\\quad n$ï¼Œæ‰€ä»¥å¯»æ‰¾ä¸€ä¸ª dï¼Œä½¿å¾—$ed = k\\phi(n)+1$,åˆ™å¯ä»¥å¾—åˆ°$m^{ed}=m\\quad mod \\quad n$ åˆ™å¾—åˆ°äº†$c^d =m\\quad mod\\quad n$ å…±æ¨¡æ”»å‡» æ‰€è°“å…±æ¨¡ï¼Œå°±æ˜¯ n ç›¸åŒï¼Œä¼šå¯¹åº”å¤šç»„ cï¼Œeã€‚ ä¾‹ï¼šç»™å®š nã€c1ã€c2ã€e1ã€e2 m = c1e1 mod n m = c2e2 mod n Â¶æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³• ç»™å®šä¸¤ä¸ªæ•´æ•° aã€bï¼Œå¿…å®šå­˜åœ¨ xã€yï¼Œä½¿å¾— gcd(a,b)=ax+by è¿ç”¨è¯¥ç®—æ³•æ¨å¯¼è¿‡ç¨‹ m = m % n m = ms1e1+s2e2 % n m = (me1s1 * me2s2)% n m = (me1s1 % n) * (me2s2 % n) % n m = (c1s1 % n) * (c2s2 % n) % n Â¶EXP &lt;!â€“codeï¿¼0â€“&gt; Wienerâ€™s Attack é€‚ç”¨äºå·²çŸ¥ Nã€eï¼Œä¸” e è¿‡å¤§æˆ–è¿‡å°ã€‚ Wiener è¡¨ç¤ºå¦‚æœ$d&lt;\\frac{1}{3}n^{\\frac{1}{4}}$,é‚£ä¹ˆä¸€ç§åŸºäºè¿åˆ†æ•°çš„æ”»å‡»å°±å¯å±åŠ RSA å®‰å…¨ã€‚ é‚£ä¹ˆä»€ä¹ˆæ˜¯è¿åˆ†æ•°ä»¥åŠå¦‚ä½•åˆ©ç”¨å‘¢ï¼Ÿ Â¶è¿åˆ†æ•° å½“ $a_0, a_1, a_2, \\dots, a_n$ éƒ½æ˜¯æ­£æ•´æ•°æ—¶ï¼Œä¸€ä¸ªè¿åˆ†æ•°å¯ä»¥è¡¨ç¤ºä¸ºï¼š $$x;=;a_0 + \\cfrac{1}{a_1 + \\cfrac{1}{a_2 + \\cfrac{1}{\\ddots + \\cfrac{1}{a_n}}}}$$ ä¾‹å¦‚æˆ‘ä»¬å¯ä»¥æ±‚è§£$\\pi$çš„è¿‘ä¼¼å€¼ $$\\pi = 3 + \\cfrac{1}{7 + \\cfrac{1^2}{15 + \\cfrac{2^2}{1 + \\cfrac{3^2}{1 + \\cfrac{4^2}{2 + \\cdots}}}}}$$ å…¶ä¸­æ¯ä¸€é¡¹å¯ä»¥ç”¨å¦‚ä¸‹å…¬å¼è®¡ç®—ï¼š $$ a_k = \\begin{cases} a_0, &amp; k=0 \\ \\lfloor b_k \\rfloor, &amp; k &gt; 0 \\end{cases}\\ $$ $$ b_k = \\begin{cases} a_0, &amp; k=0 \\ \\dfrac{1}{b_{k-1} - \\lfloor b_{k-1} \\rfloor}, &amp; k &gt; 0 \\end{cases} $$ åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ$a_0 = 3$ï¼Œå¹¶ä¸”æŒ‰ç…§ä¸Šè¿°å…¬å¼é€’å½’è®¡ç®— $a_k$ å’Œ $b_k$ ç›´åˆ°è¾¾åˆ°ä¸€å®šç²¾åº¦ä¸ºæ­¢ï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªè¿‘ä¼¼å€¼ $\\pi \\approx 3.14159265$ã€‚ è‡³æ­¤ä¹Ÿå°±æ˜ç™½äº†è¿åˆ†æ•°çš„ä½œç”¨ï¼Œå¸¸ç”¨äºæ— ç†æ•°çš„é€¼è¿‘ã€‚ å½“ç„¶ï¼Œä¹Ÿå¯ä»¥é€¼è¿‘ä¸€ä¸ªä»»æ„æ•°ï¼Œå¾—åˆ°æœ€æ¥è¿‘ç²¾ç¡®å€¼çš„è¿‘ä¼¼å€¼ã€‚ Â¶Legendreâ€™s theorem $$\\left | \\frac{e}{N}-\\frac{k}{d} \\right |\\leq \\frac{1}{2d^2}$$ å½“æ»¡è¶³è¿™ä¸€ç‚¹æ—¶ï¼Œ$\\frac{k}{d}$å°±æ˜¯$\\frac{e}{N}$çš„è¿åˆ†æ•°æ”¶æ•›ã€‚ Â¶æ”»å‡» RSA åŸç† $$\\phi(n)=(p-1)(q-1)$$ $$\\because p,qå¾ˆå¤§,\\therefore \\phi(n) \\approx N$$ $$ed - 1=k\\phi(n)$$ åŒé™¤ $d\\phi(n)$ å¾— $$\\frac{e}{\\phi(n)}-\\frac{k}{d}=\\frac{1}{d\\phi(n)}$$ $$\\therefore \\frac{e}{N}-\\frac{k}{d}=\\frac{1}{d\\phi(n)}$$ åˆ°è¿™é‡Œå‘ç°ï¼Œç­‰å¼å³è¾¹çš„$\\frac{1}{d\\phi(n)}$å¾ˆå°ï¼Œå› æ­¤$\\frac{k}{d}$å°±æ˜¯ä¸€ä¸ªå¯¹äºå·²çŸ¥é‡$\\frac{e}{N}$çš„ä¸€ä¸ªè¿åˆ†æ•°é€¼è¿‘ã€‚ å› æ­¤å¯ä»¥é€šè¿‡å°†$\\frac{e}{N}$çš„è¿åˆ†æ•°å±•å¼€ï¼Œä¾æ¬¡è®¡ç®—æ¯ä¸€ä¸ªæ¸è¿›åˆ†æ•°ã€‚Wiener è¯æ˜äº†å¯ä»¥ç²¾å‡†è¦†ç›–$\\frac{k}{d}$ã€‚ Â¶exp &lt;!â€“codeï¿¼1â€“&gt; Extending Wienerâ€™s Attack æ‰©å±•ç»´çº³æ”»å‡»æ˜¯ä¸ºäº†æ‰©å±•åˆ°$n$ä¸ªåŠ å¯†æŒ‡æ•°$e_i$,ä¸”$d_i$éƒ½è¾ƒå°çš„æƒ…å†µã€‚ ç”±$ed-k\\lambda(N)=1$å¾— $$d_ige_i-k_iN=g+k_is$$ è®°ä¸ºç»´çº³ç­‰å¼$W_i$ã€‚ åˆ©ç”¨ Guo çš„æ–¹æ³•å¯å¾—åˆ°å…³ç³»å¼: $$k_id_je_j-k_jd_ie_i=k_i-k_j$$ è®°ä¸ºéƒ­ç­‰å¼$G_{i,j}$ã€‚æ³¨æ„åˆ°ä¸¤ç§ç­‰å¼çš„å³ä¾§éƒ½éå¸¸å°ã€‚ å‚è€ƒè®ºæ–‡å’Œ wiki ä¸­çš„åšæ³•ï¼Œåç»­çš„æ€è·¯æ˜¯ä½¿ç”¨è¿™ä¸¤ä¸ªå¼å­çš„ä¸åŒå…³ç³»å»æ„é€ æ ¼ï¼Œè¿›è€Œæ ¼åŸºçº¦åŒ–æ±‚å¾—$\\phi(N)$æ¥å®ç°$N$çš„åˆ†è§£ã€‚ Â¶ä¸¤ä¸ªå°è§£å¯†æŒ‡æ•° Â¶ä¸‰ä¸ªå°è§£å¯†æŒ‡æ•° ä½åŠ å¯†æŒ‡æ•°æ”»å‡» e=3 &lt;!â€“codeï¿¼2â€“&gt; ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡» ç‰¹ç‚¹æ˜¯ e å°ï¼Œæœ‰å¤šç»„ nï¼Œå¯¹åº”äº†å¤šç»„ c me = c1 mod n1 me = c2 mod n2 me = c3 mod n3 Â¶ä¸­å›½å‰©ä½™å®šç†(CRT) å®šç†å†…å®¹å¦‚ä¸‹ é’ˆå¯¹ä¸Šè¿°æ–¹ç¨‹ç»„ï¼Œè‹¥ n1ã€n2ã€n3 äº’è´¨ï¼Œå¯¹äºä»»æ„çš„ c1ã€c2ã€c3ï¼Œæ–¹ç¨‹ç»„éƒ½æœ‰è§£ mã€‚ ä½¿ç”¨æ¡ä»¶æ˜¯ m^e &lt; n1ã€n2ã€n3ã€‚é€šè§£æ¨å¯¼å¦‚ä¸‹ï¼š è®¾$N=n_1 \\times n_2 \\times n_3, N_1=N/n_1, N_2=N/n_2, N_3=N/n_3$ è®¾$t_i=N_i^{-1}$,è¿™é‡Œè¡¨ç¤º$t_i$æ˜¯$N_i$åœ¨æ¨¡$n_i$çš„é€†å…ƒã€‚ æœ‰äº†ä»¥ä¸Šå‡ ä¸ªæ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å‡ºé€šè§£å½¢å¼ï¼š $$m=c_1t_1N_1+c_2t_2N_2+c_3t_3N_3+kN=kN+\\sum_{i=1}^3c_it_iN_i$$ åœ¨æ¨¡ N åï¼Œåªå‰©å”¯ä¸€è§£$m=\\sum_{i=1}^3c_it_iN_i$ Â¶EXP &lt;!â€“codeï¿¼3â€“&gt; dpã€dq ç›¸å…³ Â¶ç»™å®š dpã€dq ç±»å‹ dp â‰¡ d mod (p-1) dq â‰¡ d mod (q-1) m â‰¡ cd mod n m = cd + k * n m = cd +k _ p _ q å¯¹ä¸Šå¼ä¸¤ç«¯åŒæ—¶å¯¹ pã€q åˆ†åˆ«å–ä½™ï¼Œå¾—ï¼šï¼ˆä¸­å›½å‰©ä½™å®šç†ï¼‰ m1 â‰¡ cd mod p m2 â‰¡ cd mod q åŒç†ï¼Œå¯å¾—åˆ° cd = m1 +k * p ä»£å…¥åˆ° m2 â‰¡ cd mod q ä¸­ï¼š m2 â‰¡ (m1 + k * p)mod q ï¼Œä¸¤ç«¯å‡å» m1 å¾— m2 - m1 â‰¡ k * p mod q ï¼Œä¸¤ç«¯ä¹˜ p çš„é€†å…ƒå¾— (m2 - m1)p-1 â‰¡ k mod q å°† k ä»£å…¥åˆ° cd = m1 +k * p ä¸­å¾—ï¼š cd = m1 + ((m2 - m1)p-1 mod q) * p m=cd mod n å¾—åˆ° m â‰¡ (((m2 - m1) _ p-1 mod q) _ p + m1) mod n æ¥ä¸‹æ¥å°±æ˜¯æ±‚è§£ m1ï¼Œm2 m1 â‰¡ cdp+k(p-1) mod p m2 â‰¡ cdq+k(q-1) mod q æ ¹æ®è´¹é©¬å°å®šç† è‹¥ p æ˜¯ç´ æ•°ï¼Œåˆ™ a(p-1) â‰¡ 1 mod p å› æ­¤ m1 â‰¡ cdp mod pï¼Œm2 â‰¡ cdq mod q æœ€ç»ˆå¯æ±‚å¾— m Â¶EXP &lt;!â€“codeï¿¼4â€“&gt; Â¶åªç»™å®š dp dp â‰¡ d mod (p-1) ed â‰¡ 1 mod (p-1) * (q-1) ed = 1 + k2(p-1)(q-1) å¯¹ 1 å¼ä¸¤ç«¯åŒä¹˜ eï¼Œå¾— e * dp â‰¡ ed mod (p-1) e * dp = k1(p-1) + ed ä»£å…¥ ed å¾— e * dp = k1(p-1) + 1 + k2(p-1)(q-1) ç”±äºä¸¤ä¸ªæœªçŸ¥æ•°ç•¥æ˜¾éº»çƒ¦ï¼Œå‘ç°å…¬å› å­(p-1)ï¼Œç­‰å¼ä¸¤è¾¹åŒæ—¶å–ä½™ p-1ï¼Œå³å¯æ¶ˆæ‰ n e * dp â‰¡ 1 mod (p-1) e * dp =k(p-1) + 1 å¾—åˆ°è¿™ä¸ªå¼å­åï¼Œå…¶å®çœŸæ­£æ„ä¹‰ä¸Šçš„æœªçŸ¥æ•°åªæœ‰æˆ‘ä»¬è¦æ±‚çš„ pï¼Œä½†æ˜¯è¿˜å­˜åœ¨ä¸€ä¸ª kã€‚ é’ˆå¯¹ kï¼Œæˆ‘ä»¬åˆ¤æ–­ä¸€ä¸‹ä»–çš„èŒƒå›´ï¼Œçœ‹çœ‹èƒ½å¦é‡‡ç”¨çˆ†ç ´çš„æ–¹å¼ã€‚ k = (e * dp - 1)/(p-1) å› ä¸º dp &lt; p-1 æ‰€ä»¥ k &lt; e é€šè¿‡éå† k ç„¶åæ‰¾åˆ°(e * dp - 1)å¯ä»¥æ•´é™¤ k çš„æƒ…å†µå³å¯ã€‚ (è·‘äº†ä¸€ä¸‹å‘ç°é™åˆ¶æ¡ä»¶è¿˜ä¸å¤Ÿ) å› æ­¤å†åŠ ä¸€ä¸ª n èƒ½å¦æ•´é™¤ p å³å¯ã€‚ Â¶EXP &lt;!â€“codeï¿¼5â€“&gt; DLP Â¶magic(hitcon2021) &lt;!â€“codeï¿¼6â€“&gt; Â¶EXP rabin é€‚ç”¨äº RSA ä¸­ e=2 çš„æƒ…å†µ Â¶pqpq(seccon2022) &lt;!â€“codeï¿¼7â€“&gt; Â¶å¤§è‡´æ€è·¯ æ ¹æ®é¢˜ç›®ï¼Œå¯å…ˆé€šè¿‡è®¡ç®— c1ã€c2 è¡¨è¾¾å¼ï¼Œåˆå¹¶æ‰¾å‡ºå…¬å› å­ï¼Œå³å¯æ±‚å‡º pã€qï¼Œä»è€Œ r ä¹Ÿå¯æ±‚å¾—ã€‚ å‘ç° e=65537 * 2ï¼Œå› æ­¤æ˜¯æ— é€†å…ƒå­˜åœ¨çš„ï¼Œç´¢æ€§å°±å°† e æ‹†åˆ†ä¸º 65537 ä¸ 2ï¼Œe2=2 æ—¶ä¾¿å¯é€šè¿‡ Rabin ç®—æ³•è§£å¯†ã€‚ Â¶æ±‚ pã€qã€r $c2 = (p - q)^e \\mod n \\$ å·¦å³åŒä¹˜ r $c2 * r = rp^e + rq^e + X*pqr = rp^e + rq^e \\mod n\\$ $c2 = p^e + q^e \\mod n\\$ åŒç†å¾—åˆ°$c1 = p^e - q^e \\mod n \\$ ä»è€Œæ±‚å¾— pã€q $p=gcd(c1+c2,n)\\$ $q=gcd(c1-c2,n)\\$ Â¶æ±‚è§£ m^2 $\\phi(n)=(p-1)(q-1)(r-1)\\$ é€šè¿‡ e1(e/2)å’Œ$\\phi(n)$æ±‚å‡º dï¼Œå¾—åˆ°$cmd=m{2e1d}=m^2 \\mod n$ Â¶Rabin è§£å¯† æ¥ä¸‹æ¥å°±æ˜¯ä¼ ç»Ÿ Rabin è§£å¯†ï¼Œæ‰¾äº†ä¸¤ç§è„šæœ¬ï¼Œexp ä¸­çš„sqrtPrime(n,p)å’ŒTonelli_Shanks(n,p)ä»»é€‰å…¶ä¸€å³å¯ï¼Œéƒ½æ˜¯åŸºäºäºŒæ¬¡å‰©ä½™å®šç†æ‰€å®ç°çš„è§£å¯†ç®—æ³• &lt;!â€“codeï¿¼8â€“&gt; e ä¸ phi ä¸äº’ç´  Â¶GCD(p-1,e)!=1 GCD(q-1,e)!=1 &lt;!â€“codeï¿¼9â€“&gt; Â¶m^GCD &lt; n æ±‚å‡º$d*t$åï¼Œå¯¹$m$å¼€$t$æ¬¡æ–¹æ ¹ã€‚ &lt;!â€“codeï¿¼10â€“&gt; Â¶m^GCD &gt; n $$t=GCD(e,phi)$$ $$d=inverse(e//t,phi)$$ $$c=pow(c,d,n)$$ ä½¿ç”¨ CRT è¿›è¡Œæœ‰é™åŸŸå¼€æ ¹ $$x^t;=c;mod;p$$ $$x^t;=c;mod;q$$ &lt;!â€“codeï¿¼11â€“&gt; Â¶AMM é€‚ç”¨äº$e$å¯æ•´é™¤$\\phi$çš„æƒ…å†µ &lt;!â€“codeï¿¼12â€“&gt; å·²çŸ¥ p^q å’Œ p*q &lt;!â€“codeï¿¼13â€“&gt; æ˜æ–‡ç›¸å…³æ”»å‡» &lt;!â€“codeï¿¼14â€“&gt; é€‚ç”¨äº $$ C_1=M^e ; mod; n \\ C_2=(aM+b)^e ; mod ; n $$ &lt;!â€“codeï¿¼15â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"ECC(æŒç»­æ›´æ–°ğŸ¥±)","slug":"ECC","date":"2023-04-19T06:05:45.000Z","updated":"2023-05-01T14:49:32.679Z","comments":true,"path":"2023/04/19/ECC/","link":"","permalink":"https://sch01ar.github.io/2023/04/19/ECC/","excerpt":"","text":"ECC æ¤­åœ†æ›²çº¿å¯†ç å­¦(Elliptic Curve Cryptography)ï¼Œæ˜¯ä¸€ç§åŸºäºæ¤­åœ†æ›²çº¿æ•°å­¦çš„å…¬é’¥å¯†ç ã€‚ åŸºäº ECC çš„ä¸‰å¤§é—®é¢˜ï¼šå¯†é’¥äº¤æ¢ã€æ•°å­—ç­¾åã€ç¦»æ•£å¯¹æ•° Â¶æ¤­åœ†æ›²çº¿ æ¤­åœ†æ›²çº¿å®šä¹‰å¼ï¼š$y2;=x3+ax+b$ï¼Œï¼ˆç»´å°”æ–¯ç‰¹æ‹‰æ–¯æ ‡å‡†å½¢å¼ï¼‰ æ›²çº¿çš„ä¸€èˆ¬å½¢å¼ï¼š$y2+a_1xy+a_3y;=x3+a_2x^2+a_4x+a_6$ åˆ¤åˆ«å¼$\\Delta=-16(4a3+27b2);mod;p=0$ Â¶æ›²çº¿æ€§è´¨ æ¤­åœ†æ›²çº¿ä¸Šçš„å›°éš¾é—®é¢˜:$Q=nP$ï¼Œç»™å®šæ¤­åœ†æ›²çº¿ä¸Š$Pã€Q$ä¸¤ç‚¹ï¼Œæ±‚$n$ååˆ†å›°éš¾ Â¶point addition ç‚¹åŠ æ³• æ²¿æ›²çº¿çš„ P + Q ä¸¤ç‚¹ç”»ä¸€æ¡é€šè¿‡ä¸¤ç‚¹çš„ç›´çº¿ã€‚ç°åœ¨ç»§ç»­è¿™æ¡çº¿ï¼Œç›´åˆ°å®ƒç¬¬ä¸‰æ¬¡ä¸ä½ çš„æ›²çº¿ç›¸äº¤ã€‚æœ€ååœ¨è¯¥ç‚¹æ²¿ y è½´çš„æ–¹å‘å–åå°„ã€‚ $P+Q+Râ€™=0,R=P+Q,Râ€™(x,-y)=R(x,y)$ Â¶æœ‰é™åŸŸ å®šä¹‰åœ¨æœ‰é™åŸŸ$F_p$ä¸Šï¼Œé›¶å…ƒæ˜¯$O$ **ç‚¹çš„é˜¶:**å¯¹äºæ¤­åœ†æ›²çº¿ä¸Šä¸€ç‚¹$P$ï¼Œè‹¥å­˜åœ¨ä¸€ä¸ªæœ€å°çš„æ­£æ•´æ•°$n$ï¼Œä½¿å¾—$nP=O$ï¼Œåˆ™ç§°$n$æ˜¯ç‚¹$P$çš„é˜¶ã€‚ **æ¤­åœ†æ›²çº¿çš„é˜¶:**æ¯ä¸ªåœ¨æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿éƒ½ç”±æœ‰é™ä¸ªç‚¹ç»„æˆï¼Œæœ‰å¤šå°‘ä¸ªç‚¹æ¤­åœ†æ›²çº¿çš„é˜¶å°±æ˜¯å¤šå°‘ã€‚ Â¶Sage ç¯å¢ƒ åœ¨çº¿ç¯å¢ƒhttps://sagecell.sagemath.org/ æœ¬åœ°ç¯å¢ƒhttps://doc.sagemath.org/html/en/installation/index.html (æ¨èåœ¨ Linux ç¯å¢ƒæ­å»º) åŸºæœ¬è¯­æ³•https://www.osgeo.cn/sagemath/tutorial/index.html Â¶ç®€å•è¿ç®— &lt;!â€“codeï¿¼0â€“&gt; Â¶ECDHï¼ˆå¯†é’¥äº¤æ¢ï¼‰ ECDH æ˜¯æ¤­åœ†æ›²çº¿è¿ªè²-èµ«å°”æ›¼ç§˜é’¥äº¤æ¢ï¼ˆElliptic Curve Diffieâ€“Hellman key Exchangeï¼‰ï¼Œä¸»è¦æ˜¯ç”¨æ¥åœ¨ä¸€ä¸ªä¸å®‰å…¨çš„é€šé“ä¸­å»ºç«‹èµ·å®‰å…¨çš„å…±æœ‰åŠ å¯†èµ„æ–™ï¼Œä¸€èˆ¬æ¥è¯´äº¤æ¢çš„éƒ½æ˜¯ç§é’¥ã€‚ Â¶ç®—æ³•äº¤æ¢è¿‡ç¨‹ å…¬æœ‰å‚æ•°ï¼š$p,g$ Alice ç§é’¥ï¼šå¤§æ•´æ•°$a$ ç”Ÿæˆ Alice å…¬é’¥ï¼š$A=g^a;\\mod;p$ Alice å°†$A,p,g$ä¼ é€’ç»™ Bob Bob ç§é’¥ï¼šå¤§æ•´æ•°$b$ ç”Ÿæˆ Bob å…¬é’¥ï¼š$B=g^b;\\mod;p$ Bob è®¡ç®—å…¬å…±å¯†é’¥ï¼š$K=A^b;\\mod;p$ Bob å°†$B,p,g$ä¼ é€’ç»™ Alice Alice è®¡ç®—å…¬å…±å¯†é’¥ï¼š$K=B^a;\\mod;p$ äº¤æ¢å®Œæˆï¼ŒäºŒè€…åå•†å‡ºKå…¬å…±å¯†é’¥ï¼Œå¹¶ä¸”æœªåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æš´éœ² Kã€‚ Â¶An_der_schonen_Elliptische_Kurve &lt;!â€“codeï¿¼1â€“&gt; Â¶exp &lt;!â€“codeï¿¼2â€“&gt; Â¶ECDSAï¼ˆæ•°å­—ç­¾åï¼‰ åŸºäºæ¤­åœ†æ›²çº¿çš„ DSA Â¶åœºæ™¯ Alice æƒ³è¦ä½¿ç”¨å¥¹çš„ç§é’¥$d_A$æ¥ç­¾åï¼ŒBob æƒ³ç”¨ Alice çš„å…¬é’¥ $H_A$è¦éªŒè¯ç­¾å$H_A=d_AG$ã€‚ åªæœ‰ Alice æ‰èƒ½æä¾›æ­£ç¡®çš„ç­¾åï¼Œè€Œæ¯ä¸ªäººéƒ½å¯ä»¥éªŒè¯ç­¾åã€‚ Â¶ç­¾å 1.é€‰å®šä¸€æ¡æ¤­åœ†æ›²çº¿$E_p(a,b)$ã€‚ 2.é€‰å–ä¸€ä¸ªéšæœºæ•°$k,1&lt;k&lt;n-1$ï¼Œ$n$ä¸ºæ¤­åœ†æ›²çº¿çš„é˜¶ã€‚ 3.é€‰å–æ¤­åœ†æ›²çº¿çš„åŸºç‚¹$G(a,b)$,è®¡ç®— $K=k * G(a,b)$ï¼Œä»¤$r=K[0]\\mod n$ï¼Œå³ r æ˜¯ K ç‚¹çš„æ¨ªåæ ‡ï¼ˆè‹¥ r ä¸º 0ï¼Œé‡æ–°é€‰ k è¿›è¡Œè®¡ç®—ï¼‰ã€‚ 4.è®¡ç®—æ˜æ–‡ M çš„å“ˆå¸Œï¼Œä»¤$e=hash(M)$ï¼Œè®¡ç®—$s=k^{-1}(z+rd_A)\\mod n$ã€‚ 5.ç»™å‡ºç­¾å$(r,s)$ Â¶éªŒè¯ 1.è®¡ç®— $u_1=s^{-1}z\\mod n$ 2.è®¡ç®— $u_2=s^{-1}r\\mod n$ 3.è®¡ç®—ç‚¹$P=u_1G+u_2H_A$ å½“$r=x_P\\mod n$æ—¶ï¼Œç­¾åéªŒè¯æˆåŠŸã€‚ Â¶DSA-LCG è¯•è¯•è¿™ä¸ª &lt;!â€“codeï¿¼3â€“&gt; Â¶ECDLPï¼ˆç¦»æ•£å¯¹æ•°ï¼‰ ç»™å®šæ¤­åœ†æ›²çº¿ Eï¼Œå·²çŸ¥ Pã€Q ä»¥åŠ$Q=kP$ï¼Œæ±‚ kã€‚ &lt;!â€“codeï¿¼4â€“&gt; Â¶PH å…‰æ»‘é˜¶åˆ†è§£ Â¶crypto-sign-in-1(VNCTF2023) ä¸€é“ ECDLP é¢˜ç›®ï¼Œå½“æ—¶æƒ³åˆ°ä½¿ç”¨Pohlig-Hellmanç®—æ³•ï¼Œä½†æ˜¯ä¸€ç›´æ²¡èƒ½æ‰¾åˆ°åˆé€‚çš„ Aã€B æ¥ç¡®å®š G çš„é˜¶ nï¼Œèµ›åçœ‹å¤§ä½¬ wpï¼Œæœç„¶æ˜¯ç”¨ pwntools è¿œç¨‹å¤šè¯•å‡ ç»„ y1ã€y2ï¼Œæ‰¾åˆ°å…‰æ»‘çš„é˜¶ï¼Œä»è€Œè§£å¯†æˆåŠŸã€‚ &lt;!â€“codeï¿¼5â€“&gt; Â¶EXP &lt;!â€“codeï¿¼6â€“&gt; Â¶Singular Attack åˆ©ç”¨æ›²çº¿ä¸Šçš„å¥‡å¼‚ç‚¹è¿›è¡Œæ”»å‡»ï¼Œå¥‡ç‚¹å°±æ˜¯è¯¥ç‚¹å¯¼æ•°ä¸å­˜åœ¨ï¼Œæˆ–è€…å¯¼æ•°ä¸º 0 ä½†ä¸æ˜¯æå€¼ç‚¹ã€‚ è‹¥æ¤­åœ†æ›²çº¿çš„åˆ¤åˆ«å¼$\\Delta=-16(4a3+27b2);mod;p=0$ï¼Œè¯´æ˜è¯¥æ›²çº¿æœ‰å¥‡ç‚¹ã€‚ Â¶RWCTF2023 ä½“éªŒèµ› &lt;!â€“codeï¿¼7â€“&gt; æ ¹æ®é¢˜ç›®ï¼Œå¯å¾—åˆ°æ›²çº¿å…³äº x çš„å¯¼æ•°ï¼Œ$3x2+4x+1$ï¼Œæ‰€ä»¥å¯å¾—åˆ°æ–¹ç¨‹ä¸º$y2=x3+2x2+x+C$ é¢˜ç›®å·²çŸ¥ç‚¹(4,10)åœ¨æ›²çº¿ä¸Šï¼Œä»£å…¥å¾—åˆ° 100 = 64 + 32 + 4 + Cï¼Œå³ C = 0ï¼Œæ‰€ä»¥æ–¹ç¨‹ç¡®å®š$y2=x3+2x^2+x$ æ–¹ç¨‹å·¦å³æ±‚å¯¼å¾—åˆ°$2y \\frac{dy}{dx}=3x^2+4x+1$ï¼Œæ‰€ä»¥å½“ y=0 æ—¶å¯¼æ•°ä¸å­˜åœ¨ï¼Œå†æŠŠ y=0 ä»£å…¥æ–¹ç¨‹ï¼Œæ±‚å¾— x=-1ï¼Œæ‰€ä»¥æ‰¾åˆ°è¯¥æ›²çº¿çš„å¥‡ç‚¹ä¸º(-1,0)ã€‚ ä¸‹ä¸€æ­¥æˆ‘ä»¬æŠŠæ›²çº¿å¹³ç§»ï¼Œä½¿å¾—æ›²çº¿ä»¥(0,0)ä¸ºå¥‡ç‚¹ï¼Œå¾—åˆ°y^2 = x^3 + 193387944202565886198256260591909756040*x^2ï¼Œæ”¹å†™ä¸ºy^2 = (x + 193387944202565886198256260591909756040) * x^2 å› ä¸º193387944202565886198256260591909756040 = pow(89654903351345918131227153390056628523,2,p) æˆ‘ä»¬å°±å¯æŠŠ Pã€Q ç‚¹æ˜ å°„åˆ°ä¹˜æ³•ç¾¤ä¸Šï¼Œä»è€Œè¿›è¡Œç®€å•çš„å¯¹æ•°è®¡ç®—ã€‚ æ˜ å°„æ³•åˆ™å¦‚ä¸‹: $$(x,y)\\rightarrow\\frac{y+tx}{y-tx}$$ Â¶EXP &lt;!â€“codeï¿¼8â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"Euler's Factoring to RSA","slug":"Euler","date":"2023-04-18T06:05:45.000Z","updated":"2023-04-18T10:39:11.334Z","comments":true,"path":"2023/04/18/Euler/","link":"","permalink":"https://sch01ar.github.io/2023/04/18/Euler/","excerpt":"","text":"Eulerâ€™s Factoring to RSA Â¶Outline å¯¹äº RSA ä¸­$N=(ma2+nb2)(mc2+nd2)$çš„æƒ…å†µè¿›è¡Œåˆ†æä»¥åŠå®‰å…¨æ€§è¯„æµ‹ã€‚ Â¶Eulerâ€™s factorization method æ¬§æ‹‰å› å¼åˆ†è§£æ³•æ˜¯é€šè¿‡ä¸¤ç§æ–¹å¼å°†æ•°å­—å†™æˆä¸¤ä¸ªå¹³æ–¹å’Œæ¥åˆ†è§£æ•°å­—çš„æ–¹æ³•ï¼Œå¯¹äºä¸€ä¸ªåˆæ•°$N$æ¥è¯´ï¼Œè‹¥$N=a2+b2$ï¼Œåˆ™å¯ä»¥å°†$N$è¿›è¡Œå› å¼åˆ†è§£ï¼Œä¾‹å¦‚$1000009=10002+32=9722+2352=293\\cdot3413$ Â¶Theoretical basis Brahmagupta-Fibonacci æ’ç­‰å¼ $$(a2+b2)(c2+d2)=(ac-bd)2+(ad+bc)2=(ac+bd)2+(ad-bc)2$$ Â¶Proof $$a-c=kl$$ $$d-b=km$$ $$a+c=hm$$ $$d+b=hl$$ è¿ç”¨Brahmagupta-Fibonacci æ’ç­‰å¼ $$(k2+h2)(l2+m2)=(kl+hm)2+(km-hl)2=((a-c)+(a+c))2+((d-b)-(d+b))2=4a2+4b2=4n$$ æ‰€ä»¥å¾—åˆ° $$n=((\\frac{k}{2})2+(\\frac{h}{2})2)(l2+m2)$$ åç»­æ±‚è§£å¦‚ä¸‹ï¼š $$khl2+khm2=(a-c)(d+b)+(a+c)(d-b)$$ $$kh(l2+m2)=2ad-2bc$$ $$l2+m2=GCD(ad-bc,n)$$ Â¶Generally å¯¹äºæ›´ä¸€èˆ¬çš„$N$æ¥è¯´ï¼Œå¦‚æœ$N=ma2+nb2=mc2+nd2$çš„æƒ…å†µåº”ç”¨æ¬§æ‹‰åˆ†è§£æ˜¯å¦å¯ä»¥è¿›è¡Œï¼Ÿ å½“ç„¶æ˜¯å¯ä»¥çš„ï¼Œä½†å¯æƒœæ¬§æ‹‰åœ¨ 1891 å¹´å¤±å»äº†ç”Ÿå‘½ï¼Œæ²¡èƒ½ç»§ç»­è¿›è¡Œä»–çš„ç ”ç©¶ã€‚åä¸– Lucas å’Œ Mathews å…ˆåå¯¹è¿™æ ·çš„æƒ…å†µè¿›è¡Œäº†åˆ†ææ¨å¯¼ï¼Œè¯æ˜äº†$N$æ˜¯å¯åˆ†è§£çš„ã€‚ Â¶My proof å¯¹äº$a,b,c,d,m,n\\in \\mathbb{Z}^+,å¹¶ä¸”gcd(ma,nb)=gcd(mc,nd)=1$ $$N=ma2+nb2=mc2+nd2$$ $$N=\\frac{1}{2}[m(a2+c2)+n(b2+d2)]$$ $$N(d2-b2)=\\frac{1}{2}(ma2d2+mc2d2+nb2d2+nd4-ma2b2-mc2b2-nb4-nb2d2)$$ $$\\because n(d2-b2)=m(a2-c2)$$ $$\\therefore N=\\frac{1}{2}[ma2d2-mb2c2+mc2d2-ma2b2+m(a2-c2)(d2+b2)]$$ $$N=m(ad+bc)(ad-bc)$$ æˆ‘ä»¬è¿˜éœ€è¦å¦å¤–ä¸€ä¸ªç­‰å¼ï¼Œè¿ç”¨Brahmagupta-Fibonacci æ’ç­‰å¼å¾—åˆ° $$N2=(ma2+nb2)(mc2+nd^2)$$ $$N2=(mac-nbd)2+mn(ad+bc)^2$$ å› ä¸º$gcd(m,N)=1$,ç”±æ­¤å¾—åˆ° $$N=gcd(N,ad-bc)* \\frac{N}{gcd(N,ad-bc)}$$ Â¶Apply to RSA åœ¨ RSA ä¼ ç»ŸåŠ å¯†ä¸­æˆ‘ä»¬çŸ¥é“ï¼Œ$N$çš„é€‰å–å°¤ä¸ºé‡è¦ï¼Œå¦‚æœé€‰å–çš„$N$æ˜“äºåˆ†è§£ï¼Œé‚£ä¹ˆæ˜æ–‡å°†ä¸å†å®‰å…¨ã€‚ å¯¹äº$N=(ma2+nb2)(mc2+nd2)$ï¼Œå³$p=ma2+nb2,q=mc2+nd2$ é’ˆå¯¹è¿™ç§çœ‹ä¼¼æ•°å­—å¾ˆå¤§çš„$N$,ä¸‹é¢è¿›è¡Œä¸€äº›å®é™…çš„ä»£ç ç”Ÿæˆä¸æ”»å‡»ã€‚ Â¶Pã€Q_generate &lt;!â€“codeï¿¼0â€“&gt; Â¶abcd_generate &lt;!â€“codeï¿¼1â€“&gt; Â¶Encrypt &lt;!â€“codeï¿¼2â€“&gt; Â¶Attack &lt;!â€“codeï¿¼3â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"NSSCTF Round11","slug":"NSSCTFRound11","date":"2023-04-08T13:05:45.000Z","updated":"2023-04-11T11:55:17.610Z","comments":true,"path":"2023/04/08/NSSCTFRound11/","link":"","permalink":"https://sch01ar.github.io/2023/04/08/NSSCTFRound11/","excerpt":"","text":"æœ€å rank æ’ç¬¬ 4ï¼Œå·®ä¸€é“ AKï¼Œå¯æƒœã€‚ ez_enc é¢˜ç›®æè¿°è¯´äº†ä¸æ˜¯åŸ¹æ ¹åŠ å¯†ï¼Œæ‰€ä»¥è€ƒè™‘ AB ä¸ºäºŒè¿›åˆ¶æƒ…å†µï¼Œ192 ä½æ•°åˆ¤æ–­ï¼Œ8 ä½ä¸ºä¸€ç»„ï¼Œç®€å•å†™ä¸ªè„šæœ¬è·‘å°±è¡Œã€‚NSSCTF&#123;mS4gT1Kv9L8NjPzx&#125; MyMessage(2ğŸ©¸) Â¶é¢˜ç›® &lt;!â€“codeï¿¼0â€“&gt; Â¶é¢˜è§£ åˆ†æä¸€ä¸‹å‘ç°æ˜¯ CRTï¼Œe æ˜¯ 127ï¼Œä¸ç®—å¾ˆå¤§ï¼Œpwntools è¿œç¨‹è¿ä¸€ä¸‹å°±å‡ºäº†ï¼Œç”¨ 127 ç»„ nã€c å°±èƒ½å‡ºã€‚ &lt;!â€“codeï¿¼1â€“&gt; MyGame(3ğŸ©¸) Â¶é¢˜ç›® &lt;!â€“codeï¿¼2â€“&gt; Â¶é¢˜è§£ ä»”ç»†è¯»ä»£ç ï¼Œå‘ç°æ˜¯å…±æ¨¡æ”»å‡»ï¼Œæ‰¾ä¸¤ç»„ cã€e å³å¯ &lt;!â€“codeï¿¼3â€“&gt; ez_signin(3ğŸ©¸) Â¶é¢˜ç›® &lt;!â€“codeï¿¼4â€“&gt; Â¶é¢˜è§£ ä» num1 å’Œ num2 å…¥æ‰‹è¿›è¡Œæ¨å¯¼ï¼Œè¿™ç§ç±»ä¼¼æ¨å¯¼åœ¨secconä¸­çš„pqpqä¹Ÿé‡åˆ°è¿‡ï¼Œé‡åˆ° p å’Œ q å’Œä¸å·®çš„æ¬¡æ–¹æ—¶è¦å–„äºå±•å¼€ã€‚ $$num1=p^e - q^e ; mod ;n$$ $$num2=(p-q)^e ; mod ;n=p^e + q^e ;mod;n$$ $$num1-num2=2q^e ;mod;n$$ ä¸ n æ±‚ gcd å³å¯å¾—åˆ° qã€‚åç»­åˆå‘ç°gcd(e,phi)=4 æˆ‘ç›´æ¥ç”¨phi//4å°±å‡ºäº†ï¼Œä½†çœ‹åˆ«çš„å¸ˆå‚…é¢˜è§£æ˜¯ä½¿ç”¨äº† 16 æ¬¡ rabinã€‚App1e_Tree &lt;!â€“codeï¿¼5â€“&gt; NTR(4â„ï¸) Â¶é¢˜ç›® &lt;!â€“codeï¿¼6â€“&gt; Â¶é¢˜è§£ åŸºç¡€ NTRU æ ¼å¯†ç ï¼Œå…·ä½“æ¨å¯¼å¯çœ‹å‰å‡ ç¯‡åšå®¢ DUTCTF çš„ ez_RSA &lt;!â€“codeï¿¼7â€“&gt; ez_fac(æœªå‡º) Â¶é¢˜ç›® &lt;!â€“codeï¿¼8â€“&gt; Â¶é¢˜è§£ èµ›åè‡ªå·±æ¨äº†ä¸€ä¸‹ï¼Œæ¬§æ‹‰å…¬å¼åˆ†è§£ å› æ­¤æœ‰ $$a-c=kl$$ $$d-b=km$$ $$a+c=hm$$ $$d+b=hl$$ æ¨åˆ°è¿™æ­¥ä¹‹åï¼Œè¿ç”¨Brahmagupta-Fibonacciæ’ç­‰å¼ï¼Œå¾—åˆ° $$n=((\\frac{k}{2})2+(\\frac{h}{2})2)(l2+m2)$$ $$khl2+khm2=(a-c)(d+b)+(a+c)(d-b)$$ $$kh(l2+m2)=2ad-2bc$$ $$l2+m2=GCD(ad-bc,n)$$ æ‰€ä»¥å¯¹åº”åˆ°æœ¬é¢˜å½“ä¸­ï¼Œp=GCD((a0*b1-a1*b0),n) &lt;!â€“codeï¿¼9â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"NKCTF2023","slug":"2023NKCTF","date":"2023-04-04T02:05:45.000Z","updated":"2023-04-27T01:01:03.377Z","comments":true,"path":"2023/04/04/2023NKCTF/","link":"","permalink":"https://sch01ar.github.io/2023/04/04/2023NKCTF/","excerpt":"","text":"æ•°å­—ä¸­å›½ Babysecret é¢˜ç›® &lt;!â€“codeï¿¼0â€“&gt; $enc=pow(x,flag,p)$,ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼Œp æ˜¯å…‰æ»‘çš„ï¼Œåç»­å¯é€šè¿‡ PH æ±‚è§£ï¼Œä½† x æœªçŸ¥ $c=(rx+s);mod;p$,c å’Œ r æ˜¯ 30 ä½çš„å‘é‡ï¼Œé€šè¿‡ LWE æ±‚è§£ x å³å¯ã€‚ &lt;!â€“codeï¿¼1â€“&gt; NKCTF2023 Â¶babyRSA é¢˜ç›® &lt;!â€“codeï¿¼2â€“&gt; Â¶é¢˜ç›®åˆ†æ é¢˜ç›®ååŠéƒ¨åˆ†æ˜¯ dp æ³„éœ²ï¼Œé€šè¿‡ Nã€eã€dP å¯æ±‚å‡º Pã€Q &lt;!â€“codeï¿¼3â€“&gt; Â¶æ³•ä¸€ ä¹‹åè¦é€šè¿‡$P = mp;mod;n$ä¸$Q=mq; mod ;n$æ¥æ±‚è§£ mï¼Œä¸‹é¢è¿›è¡Œä¸€äº›æ•°å­¦æ¨å¯¼ $$c_1q=m{pq};mod;n$$ $$c_1{pq}=c_2{p^2};mod;n$$ $$c_1{pq}=c_2{p^2};mod;p$$ æ ¹æ®è´¹é©¬å°å®šç†è½¬æ¢å¯å¾— $$c_1n=c_2p;mod;p$$ $$gcd(c_1^n-c_2,n);=;p$$ æ±‚å‡º p å’Œ q åï¼Œä½¿ç”¨ crt å³å¯æ±‚å¾— m &lt;!â€“codeï¿¼4â€“&gt; Â¶æ³•äºŒ é€šè¿‡æ¨å¯¼å°†åŸå¼è½¬æ¢ä¸º $$PQ=(k_1p+m)(k_2q+m)$$ $$m(P+Q)=2m^2+(k_1p+k_2q)m$$ $$PQ-m(P+Q)+m^2=k_1k_2n$$ $$PQ-m(c_1+c_2)+m^2=0;mod;n$$ &lt;!â€“codeï¿¼5â€“&gt; Â¶ezRSA å·²çŸ¥ phi åˆ†è§£ n,åç»­åŒ babyRSA &lt;!â€“codeï¿¼6â€“&gt; Â¶ez_math é¢˜ç›® &lt;!â€“codeï¿¼7â€“&gt; æ ¹æ®ä¸€ä¸ª hint å¾—åˆ° $$8^x;mod;n=4$$ $$2^{3x-2}=1;mod;n$$ ç”±è´¹é©¬å°å®šç†å¾—ï¼Œ3x-2=phi &lt;!â€“codeï¿¼8â€“&gt; Â¶ez_polynomial é¢˜ç›® &lt;!â€“codeï¿¼9â€“&gt; Â¶é¢˜è§£ å¤šé¡¹å¼ RSAï¼Œç»™å®š nã€eã€c &lt;!â€“codeï¿¼10â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"DUTCTF2023","slug":"DUTCTF2023","date":"2023-03-28T02:05:45.000Z","updated":"2023-03-28T09:29:06.114Z","comments":true,"path":"2023/03/28/DUTCTF2023/","link":"","permalink":"https://sch01ar.github.io/2023/03/28/DUTCTF2023/","excerpt":"","text":"DUTCTF2023wp Â¶å†™åœ¨å‰é¢ ä»”ç»†ä¸€æƒ³è‡ªå·±å­¦ CTF ä¹Ÿä¸€å¹´äº†ï¼Œçºªå¿µä¸€ä¸‹æœ€åä¸€æ¬¡å‚åŠ æ ¡èµ› ğŸ¥¹ï¼Œæ˜å¹´å¯å°±æ˜¯å‡ºé¢˜äººäº† ğŸ¤“ã€‚ä½†æ˜¯æ„Ÿè§‰ä¸€å¹´ä»¥æ¥è’åºŸäº†å¾ˆå¤šæ—¶é—´ï¼Œåœ¨å¾ˆå¤šæ–¹é¢å¯¹é¢˜ç›®ä¸ç†Ÿæ‚‰ï¼Œæ€»è·‘åï¼Œç”šè‡³æ˜¯è‡ªå·±å¤ç°è¿‡çš„ä¸€äº›æ–¹æ³•éƒ½æ²¡æ„è¯†åˆ°ï¼ˆhint å¤ªåˆ°ä½äº† ğŸ˜­ï¼‰ã€‚ Â¶Crypto ç¬¬ä¸€æ¬¡ akï¼Œå¥½çˆ½ ğŸ˜­ Â¶*è€æ»šäº” ç™¾åº¦æœé¾™è¯­ï¼Œè€å¿ƒå¯¹ç€æ‰¾å°±å‡ºäº†DUTCTF&#123;YOU_ARE_A_REAL_DRAGONBORN&#125; Â¶*ç¥å¥‡çš„çŸ­ä¿¡ è¯ºåŸºäºšæ‰‹æœºï¼Œ9 é”®ï¼Œç¬¬ä¸€ä½ä»£è¡¨å“ªä¸ªé”®ï¼Œç¬¬äºŒä¸ªä»£è¡¨ç¬¬å‡ ä¸ªå­—æ¯ï¼ŒDUTCTF&#123;SCREW&#125; Â¶éšæœºæ•°çš„åŠ›é‡ å¯å…ˆäº†è§£ä¸€ä¸‹ MT19937 ä¼ªéšæœºæ•°åŸç†ï¼Œç„¶åçœ‹ä¸€ä¸‹ç ´è§£æ–¹æ³•ï¼Œå¯¹äºæ¢…æ£®æ—‹è½¬ç®—æ³•ä¹‹å‰åšå®¢ä¹Ÿè¯¦ç»†æ¨å¯¼è¿‡ã€‚è¿™é‡Œé’ˆå¯¹é¢˜ç›®åˆ†æä¸€ä¸‹ï¼Œé¦–å…ˆ ban æ‰äº† 32 ä½çš„é¢„æµ‹æ–¹æ³•ï¼Œé€šè¿‡äº†è§£åˆ°ï¼Œrandcrackåº“å®é™…ä¸Šæ˜¯é€šè¿‡æ”¶å–ç‰¹å®šä½æ•°æ¥å®ç°é¢„æµ‹ï¼Œä¾‹å¦‚ 32 ä½æ•°ï¼Œå°±éœ€è¦ 624 ä¸ªï¼Œé‚£ä¹ˆå¦‚æœä½¿ç”¨ 64 ä½æ•°ï¼Œåº”è¯¥å°±éœ€è¦ 312 ä¸ªã€‚åç»­åªè¦å¯¹æ”¶å–çš„æ•°å­—è¿›è¡Œä¸€ä¸‹å¤„ç†ï¼Œè½¬æˆ 624 ä¸ª 32 ä½æ•°å³å¯ã€‚ è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªç–‘é—®å°±æ˜¯ï¼Œæœ€å¤§çš„ 64 ä½æ•°æ˜¯$2{64}-1$ï¼Œä½†æ˜¯å¦‚æœä¼ $name=2{64}-1$å°±æ— æ³•é¢„æµ‹ï¼Œè€Œæ”¹æˆå…¶ä½™ç•¥å°ä¸€ç‚¹çš„ 64 ä½æ•°å³å¯ã€‚ Â¶exp &lt;!â€“codeï¿¼0â€“&gt; Â¶shamir ç›´æ¥æ‰¾è„šæœ¬è·‘ï¼Œå…·ä½“å¦‚ä½•æ¢å¤ a0 ç³»æ•°å°±ä¸ç»†è¯´äº†ã€‚ä¹‹å‰ hitcon æœ‰ä¸ªä¹Ÿæ˜¯ shamir çš„é¢˜ï¼Œä¹ŸæŒºæœ‰æ„æ€çš„ã€‚babysss &lt;!â€“codeï¿¼1â€“&gt; Â¶ECC1 å‘ç°æ˜¯ ECDSA ç±»å‹ï¼Œäºæ˜¯ç°å­¦ã€‚ã€‚ã€‚ä¸‹é¢å†™ä¸€ä¸‹ ECDSA çš„ç­¾åä¸éªŒè¯è¿‡ç¨‹ã€‚ Â¶åœºæ™¯ Alice æƒ³è¦ä½¿ç”¨å¥¹çš„ç§é’¥$d_A$æ¥ç­¾åï¼ŒBob æƒ³ç”¨ Alice çš„å…¬é’¥ $H_A$è¦éªŒè¯ç­¾å$H_A=d_AG$ã€‚ åªæœ‰ Alice æ‰èƒ½æä¾›æ­£ç¡®çš„ç­¾åï¼Œè€Œæ¯ä¸ªäººéƒ½å¯ä»¥éªŒè¯ç­¾åã€‚ Â¶ç­¾å 1.é€‰å®šä¸€æ¡æ¤­åœ†æ›²çº¿$E_p(a,b)$ã€‚ 2.é€‰å–ä¸€ä¸ªéšæœºæ•°$k,1&lt;k&lt;n-1$ï¼Œ$n$ä¸ºæ¤­åœ†æ›²çº¿çš„é˜¶ã€‚ 3.é€‰å–æ¤­åœ†æ›²çº¿çš„åŸºç‚¹$G(a,b)$,è®¡ç®— $K=k * G(a,b)$ï¼Œä»¤$r=K[0]\\mod n$ï¼Œå³ r æ˜¯ K ç‚¹çš„æ¨ªåæ ‡ï¼ˆè‹¥ r ä¸º 0ï¼Œé‡æ–°é€‰ k è¿›è¡Œè®¡ç®—ï¼‰ã€‚ 4.è®¡ç®—æ˜æ–‡ M çš„å“ˆå¸Œï¼Œä»¤$e=hash(M)$ï¼Œè®¡ç®—$s=k^{-1}(z+rd_A)\\mod n$ã€‚ 5.ç»™å‡ºç­¾å$(r,s)$ Â¶éªŒè¯ 1.è®¡ç®— $u_1=s^{-1}z\\mod n$ 2.è®¡ç®— $u_2=s^{-1}r\\mod n$ 3.è®¡ç®—ç‚¹$P=u_1G+u_2H_A$ å½“$r=x_P\\mod n$æ—¶ï¼Œç­¾åéªŒè¯æˆåŠŸã€‚ Â¶è§£é¢˜è¿‡ç¨‹ é€šè¿‡å¯¹é¢˜ç›®çš„åˆæ­¥é˜…è¯»ï¼Œå‘ç°å…³é”®æ˜¯æ±‚å‡ºç§é’¥d=privkeyï¼Œè€Œæƒ³è¦æ±‚å‡º$d$å°±è¦æ±‚å‡º$k$ï¼Œè™½ç„¶$k$ æ˜¯ä»¥éšæœºæ•°çš„å½¢å¼å‡ºç°ï¼Œä½†å‘ç°æœ¬é¢˜ä¸­æ¯æ¬¡ç­¾åè¿‡ç¨‹çš„ k å¹¶ä¸æ˜¯å®Œå…¨éšæœºï¼Œè€Œæ˜¯çº¿æ€§ä¼ªéšæœº$k = (a * k + b)\\mod n$ã€‚è¿™é‡Œæˆ‘å¾ˆæƒ³æŠŠ$k$æ±‚å‡ºæ¥ï¼Œç„¶åå†å»æ±‚ç§é’¥$d$ã€‚æ‰€ä»¥æœ‰æ²¡æœ‰ä¸€ç§å¯èƒ½ï¼Œä¸ç”¨æ±‚$k$ï¼Œå¦‚æœæŠŠ$k$æ¶ˆæ‰ï¼Œæ–¹ç¨‹é‡Œåªå‰©ä¸€ä¸ªæœªçŸ¥æ•°$d$ï¼Œå³å¯ã€‚ç»†å¿ƒä¸€ç‚¹è¿›è¡Œæ•°å­¦æ¨å¯¼ï¼Œå°±ä¼šå‘ç°ç­”æ¡ˆã€‚ $$k_1s_1=e+r_1d\\mod n$$ $$k_2s_2=e+r_2d\\mod n$$ $$k_2=ak_1+b\\mod n$$ $$k_2=ak_1+b+xn$$ $$s_1s_2k_2=s_1s_2ak_1+s_1s_2b+s_1s_2xn$$ $$s_1(e+r_2d)=s_2a(e+r_1d)+s_1s_2b \\mod n$$ $$d=(s_1r_2-s_2ar_1)^{-1}(s_2ae-s_1e+s_1s_2b)\\mod n$$ è¿™é‡Œä¸¤æ¬¡çš„ä½¿ç”¨çš„$e$ä¸€æ ·ï¼Œæ˜¯å› ä¸ºä¼ çš„æ˜æ–‡ä¸€æ ·ï¼Œ$n$å¯¹åº”çš„æ˜¯é¢˜ç›®é‡Œç»™çš„$order$ã€‚è¿™é‡Œè¿˜æƒ³è¯´ä¸€ä¸‹è‡ªå·±å› ä¸ºä¸ç»†è‡´èµ°è¿‡çš„å¼¯è·¯ï¼Œé¢˜ç›®é‡Œé€šè¿‡$p$å®šä¹‰çš„æ›²çº¿ï¼Œæ‰€ä»¥è¯¯ä»¥ä¸º$curve.order$æ˜¯$p$ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´å‰ä¸¤ä¸ªå¼å­å’Œç¬¬ä¸‰ä¸ªç®—å¼çš„æ¨¡æ•°ä¸åŒã€‚æœ‰è¶£çš„æ˜¯ï¼Œæ‰¾åˆ°äº†ä¸€ç¯‡è®ºæ–‡å’Œæ–‡ç« è¿›è¡Œäº†å®ç°ã€‚ è®ºæ–‡ ä½†å…¶å®$curve.order=order$æ‰€ä»¥ä¸Šè¿°æ‰€æœ‰éƒ½æ˜¯åœ¨æ¨¡$orderçš„æ¡ä»¶ä¸‹$ï¼Œæ‰€ä»¥è¿›è¡Œä¸€ä¸‹æ¨å¯¼å°±å‡ºäº†ã€‚ Â¶exp &lt;!â€“codeï¿¼2â€“&gt; Â¶ECC2 hint:äºŒå…ƒ copper çœ‹åˆ° hint ç¬é—´çŸ¥é“æ€ä¹ˆåšäº†ï¼Œå‰æ®µæ—¶é—´åˆšå­¦äº†ä¸€ä¸‹å¤šå…ƒ copperï¼Œæ„Ÿæ…¨ä¸€ä¸‹è¿˜æ˜¯è¿ç”¨ä¸ç†Ÿç»ƒï¼Œæ²¡æœ‰ä¸€çœ¼å‘ç°ã€‚ Â¶è§£é¢˜æ€è·¯ åŒæ ·æ˜¯ ECDSAï¼Œç›¸æ¯”äºä¸Šé¢˜æ¥è¯´ï¼Œk æ˜¯éšæœºçš„ï¼Œä½†æ˜¯æ¯æ¬¡ç­¾åçš„æ—¶å€™ä¼šæ³„éœ² k çš„é«˜ä½ã€‚æ­¤é¢˜å¦å¤–ä¸€ä¸ªå…³é”®æ˜¯ï¼Œ$r$æ˜¯ç”±ç§é’¥$d$ç”Ÿæˆçš„ï¼Œæ‰€ä»¥ä¸ç®¡ä¼ ä»€ä¹ˆæ˜æ–‡ï¼Œæ‰€å¾—åˆ°çš„$r$æ˜¯ä¸€æ ·çš„ï¼Œåˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªäºŒå…ƒæ–¹ç¨‹ã€‚ $$s_1k_1=z_1+dr \\mod n$$ $$s_2k_2=z_2+dr \\mod n$$ $$k=kh+kl$$ $$s_1(k_1h+k_1l)-z_1=s_2(k_2h+k_2l)-z_2 \\mod n$$ $$f(k_1l,k_2l)=s_1(k_1h+k_1l)-z_1-s_2(k_2h+k_2l)+z_2$$ éšåä½¿ç”¨å¤šå…ƒ copper è¿›è¡Œæ±‚è§£ã€‚å…·ä½“å¯çœ‹ä¸Šç¯‡åšå®¢ã€‚ &lt;!â€“codeï¿¼3â€“&gt; Â¶ez_RSA hint 1:è®ºæ–‡ hint 2: &lt;!â€“codeï¿¼4â€“&gt; Â¶è§£é¢˜æ€è·¯ é€šè¿‡è®ºæ–‡ï¼Œå‰åŠéƒ¨åˆ†ç™½ç»™ï¼ŒæŒ‰ç…§è®ºæ–‡é€ æ ¼ï¼Œå³å¯è§„çº¦å‡º$_P$ã€‚ æ¥ä¸‹æ¥çš„é—®é¢˜å°±æ˜¯å¦‚ä½•æ±‚$_E$ $$c=rh+m \\mod p$$ $$h=f^{-1}g \\mod p$$ å°†ä¸€å¼å¸¦å…¥äºŒå¼ $$c=r(f^{-1}g)+m \\mod p$$ $$cf=rg+mf \\mod p$$ å› ä¸º r æ˜¯ 1024 ä½ï¼Œg æ˜¯ 768 ä½ï¼Œf æ˜¯ 1024 ä½ï¼Œm æ˜¯ 128 ä½ï¼Œp æ˜¯ 2048 ä½ï¼Œæ‰€ä»¥ $$rg+mf \\mod p=rg+mf$$ $$cf \\mod p=rg+mf$$ ä¸¤è¾¹åŒæ—¶å¯¹$g$å–æ¨¡ï¼Œå³å¯æ¶ˆå»æœªçŸ¥æ•°$r$ï¼Œå¾—åˆ° $$m=(f*c \\mod p)*f^{-1} \\mod g$$ Â¶exp &lt;!â€“codeï¿¼5â€“&gt; Â¶misc Â¶*ç­¾åˆ° b ç«™ 21 çº§ pwn ä¾‹ä¼šè¯„è®ºåŒº Â¶æˆ‘åœ¨å“ª æ”¾å¤§å›¾ç‰‡çœ‹åˆ°åå…«ä¸­ï¼Œæœç´¢ä¸´æ±Ÿåå…«ä¸­ï¼Œå‘ç°æ˜¯é‡åº†åå…«ä¸­ï¼Œåœ°å›¾ä¸Šæœä¸€ä¸‹é™„è¿‘åœ°é“ç«™ï¼ŒæŒ¨ç€æ¡¥çš„å°±æ˜¯ï¼Œæ›¾å®¶å²©ã€‚ Â¶ä¸è¦æ›´æ–° æµé‡åˆ†æé¢˜ï¼Œwireshark é‡Œè¿‡æ»¤ä¸€ä¸‹ httpï¼Œæ‰¾åˆ° github ç½‘é¡µ æ ¹æ® hint æŸ¥çœ‹å†å²æäº¤è®°å½•ï¼Œå‘ç°å‡ flagï¼Œå¯¹äºå¯†ç æ‰‹æ¥è¯´ä¸€çœ¼å‡¯æ’’ï¼Œç§»ä½ 13ã€‚ Â¶web Â¶*Trenja F12 æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œæœç´¢ flag å­—æ®µå³å¯ã€‚ Â¶pwn Â¶*ä¸­é—´äºº å¤ªå¥½ç©äº†ï¼ŒåŸç†æ˜¯æ±½è½¦æ»šåŠ¨ç ã€‚bob æ¥å¼€è½¦é—¨ï¼Œæˆªæ–­ï¼Œå¼€é—¨å¤±è´¥ã€‚bob å†å¼€è½¦é—¨ï¼Œæˆªæ–­ï¼Œå‘é€ç¬¬ä¸€æ¬¡æˆªæ–­ä¿¡å·ï¼Œbob å¼€é—¨æˆåŠŸã€‚bob ç¦»å¼€ï¼Œæˆ‘ä»¬å‘é€ç¬¬äºŒæ¬¡æˆªæ–­çš„ä¿¡å·ï¼Œæ‰“å¼€è½¦é—¨ï¼ Â¶reverse Â¶*è´ªåƒè›‡ æ‹–å…¥ IDAï¼Œalt+t æœç´¢ DUT å³å¯ Â¶*GAME ä¸‹æ£‹èµ¢äº†å°±å‡ºäº†","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"Coppersmithç›¸å…³æ”»å‡»","slug":"Coppersmithæ”»å‡»","date":"2023-03-07T02:05:45.000Z","updated":"2023-06-30T02:10:55.040Z","comments":true,"path":"2023/03/07/Coppersmithæ”»å‡»/","link":"","permalink":"https://sch01ar.github.io/2023/03/07/Coppersmith%E6%94%BB%E5%87%BB/","excerpt":"","text":"åŸç† Coppersmith å®šç†æ˜¯åœ¨ä¸€ä¸ª e é˜¶æ¨¡ n çš„å¤šé¡¹å¼$f(x)$ä¸­ï¼Œè‹¥æœ‰æ ¹å°äº$n^{\\frac{1}{e}}$ï¼Œåˆ™å¯ä»¥ç”¨ O(log n)çš„ç®—æ³•æ±‚å‡ºæ ¹ã€‚ ç›´æ¥æ±‚è§£$f(x)$çš„æ ¹å¯èƒ½æ¯”è¾ƒå›°éš¾ï¼Œåœ¨æ­¤åˆ©ç”¨LLLç®—æ³•æ±‚å¾—å¤šé¡¹å¼$g(x)$ï¼Œæ±‚å¾—çš„å¤šé¡¹å¼ä¸$f(x)$å…·æœ‰ç›¸åŒçš„æ ¹$x_0$ï¼Œ$g(x)$å…·æœ‰æ›´å°çš„ç³»æ•°ï¼Œä¸”å®šä¹‰åŸŸä¸ºæ•´æ•°åŸŸã€‚ æœ¬è´¨æ€æƒ³å°±æ˜¯æŠŠæœ‰é™åŸŸä¸Šçš„æ–¹ç¨‹è½¬åŒ–åˆ°æ•´æ•°åŸŸã€‚ ç†è®ºåŸºç¡€ $$f(x,y) = \\sum_{i=0}{d}\\sum_{j=0}{e} a_{i,j}xiyj$$ Â¶Howgrave-Graham éœ€è¦æ„é€ ä¸€ä¸ªç³»æ•°æ›´å°çš„å¤šé¡¹å¼ï¼Œ$||g(x)||$ä»£è¡¨èŒƒæ•°ï¼Œå³æœ€å¤§çš„ç³»æ•°ã€‚æ„é€ æ–¹æ³•å¦‚ä¸‹ Â¶LLL ç®—æ³• æ ¼åŸºçº¦åŒ–ç®—æ³•ï¼Œé€šè¿‡å¯¹æ„é€ å‡ºçš„æ ¼ï¼Œä»è€Œçº¦åŒ–äº§ç”Ÿç¬¦åˆçº¦æŸçš„å¤šé¡¹å¼ã€‚ Â¶p é«˜ä½æ”»å‡» &lt;!â€“codeï¿¼0â€“&gt; Â¶exp &lt;!â€“codeï¿¼1â€“&gt; Â¶p é«˜ä½éƒ¨åˆ†æ³„éœ² &lt;!â€“codeï¿¼2â€“&gt; Â¶q ä½ä½å’Œ p é«˜ä½ &lt;!â€“codeï¿¼3â€“&gt; Â¶dp é«˜ä½æ”»å‡» ç»™å®š$e,n,c,dp_0,k,;dp_0=dp&gt;&gt;k$ $$ edp\\equiv ed\\equiv 1;mod;(p-1)\\ edp=k(p-1)+1\\ edp+k-1=kp\\ edp+k-1 \\equiv 0; mod; p\\ \\because dp&lt; p-1\\ \\because edp=k(p-1)+1\\ \\therefore e&gt;k\\ \\therefore e(dp_0 &lt;&lt; k+x)+k-1 \\equiv 0;mod;p $$ &lt;!â€“codeï¿¼4â€“&gt; Â¶EXP &lt;!â€“codeï¿¼5â€“&gt; Â¶å¤šå…ƒ coppersmith åŸç†å­¦ä¹  è®ºæ–‡å­¦ä¹  1ã€ è®ºæ–‡å­¦ä¹  2 è„šæœ¬æ¥æº &lt;!â€“codeï¿¼6â€“&gt; å…·ä½“å‚æ•°è¯´æ˜ï¼Œä¾‹å¦‚ &lt;!â€“codeï¿¼7â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"DLPä¸­å¸¸ç”¨ç®—æ³•","slug":"DLPä¸­å¸¸ç”¨ç®—æ³•","date":"2023-02-24T10:05:45.000Z","updated":"2023-03-04T06:03:05.157Z","comments":true,"path":"2023/02/24/DLPä¸­å¸¸ç”¨ç®—æ³•/","link":"","permalink":"https://sch01ar.github.io/2023/02/24/DLP%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95/","excerpt":"","text":"Pohlig-Hellman ç®—æ³•ï¼ˆå…‰æ»‘é˜¶ï¼‰ ç»™å®š a,b,pï¼Œp æ˜¯ç´ æ•°ï¼Œæ±‚ xï¼Œ$a^x \\equiv b (mod;p)$ åœ¨æ¨¡ p ä¸‹ï¼Œè®¾è¯¥ç¾¤çš„ç”Ÿæˆå…ƒä¸º gï¼Œåˆ™æœ‰ $$ a \\equiv g^{a1} (mod;p) \\newline b \\equiv g^{b1} (mod;p) $$ è”ç«‹æ¡ä»¶æœ‰ $$ g^{a1x} \\equiv g^{b1} (mod;p) $$ ç”±æ¬§æ‹‰å®šç†å¾—$\\phiÂ§;=;p-1$ï¼Œåˆ™æœ‰$a1x;=b1;(mod;(p-1))$ 1.å°† p-1 åˆ†è§£ï¼Œå³ $p-1=p_1{k_1}p_2{k_2}\\cdots p_m^{k_m}$ 2.å°† x è¡¨ç¤ºæˆ$p_i$ è¿›åˆ¶, åˆ—å‡ºæ–¹ç¨‹ $$x;=p_i^0a_0 + p_i1a_1+â€¦+p_i{k_i-1}a*{k_i-1}$$ 3.ä»¤ r=1ï¼Œæ±‚$(ax){\\frac{p-1}{p_i^r}}; \\equiv b{\\frac{p-1}{p_ir}}(mod; p)$ 4.å°† 2 ä¸­çš„å…¬å¼ä»£å…¥åˆ° 3ï¼Œå±•å¼€å¾—åˆ° $$a^{a0*\\frac{p-1}{p_i}}* a^{(p-1)a1} * a{(p-1)p_ia_2}â€¦a{(p-1)p_i^{k_i-2}a_{k_i-1}} \\equiv b^{\\frac{p-1}{p_i}}(mod;p)$$ 5.ä»ç¬¬äºŒé¡¹å¼€å§‹ï¼Œåé¢æ¯é¡¹éƒ½æ˜¯ 1ï¼Œæ¬§æ‹‰å®šç†:$a^{(p-1)} \\equiv 1(mod;p)$ï¼ŒåŒ–ç®€å¾—åˆ°çš„å¼å­ä¸º $$\\newline a^{a0*\\frac{p-1}{p_i}} \\equiv b^{\\frac{p-1}{p_i}}(mod ;p)\\newline$$ å› ä¸ºè¯¥æ–¹ç¨‹åªæœ‰ a0 æœªçŸ¥ï¼Œæ‰€ä»¥å¯åœ¨[0,pi-1]èŒƒå›´å†…çˆ†ç ´å‡º a0 6.å†ä»¤ r = 2,3,4â€¦kiï¼Œé‡å¤æ­¥éª¤ 3ï¼Œå³å¯æ±‚å‡ºæ‰€æœ‰çš„$a_2,a_3â€¦a_{k_i-1}$ï¼Œä»è€Œå¾—åˆ° m ä¸ªå…³äº x çš„æ–¹ç¨‹ï¼Œæœ€åä½¿ç”¨ CRT è¿›è¡Œæ±‚è§£å³å¯ã€‚ æ€»ç»“:å°† p-1 çš„ m ä¸ªè´¨å› å­ï¼Œåˆ†åˆ«æ±‚å‡ºå…¶æ–¹ç¨‹å†…çš„æ‰€æœ‰ç³»æ•° aï¼Œä»è€Œæ„é€ äº† m ä¸ªå…³äº x çš„æ–¹ç¨‹ï¼Œæœ€ç»ˆåˆ©ç”¨ CRT æ±‚è§£ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"2022DASCTF_NOV-lllcccggg-wp","slug":"2022DASCTF_NOV-lllcccgggwp","date":"2022-11-30T02:05:45.000Z","updated":"2022-12-01T09:42:22.869Z","comments":true,"path":"2022/11/30/2022DASCTF_NOV-lllcccgggwp/","link":"","permalink":"https://sch01ar.github.io/2022/11/30/2022DASCTF_NOV-lllcccgggwp/","excerpt":"","text":"é¢˜ç›®æè¿° å¦‚é¢˜ç›®åå­—ä¸€æ ·ï¼Œæœ‰å¥½å¤šä¸ªlcgï¼Œå½“æ—¶çœ‹æ™•äº† &lt;!â€“codeï¿¼0â€“&gt; é¢˜ç›®åˆ†æ 1.keyæ˜¯ä¸€ä¸ªèƒŒåŒ…é—®é¢˜ï¼Œå·²çŸ¥å…¬é’¥mï¼Œå’Œçš„è¯ç›®å‰ä¸çŸ¥é“ã€‚ 2.ä»¥1ä¸­çš„å’Œä¸ºseedï¼Œé€šè¿‡LCGäº§ç”Ÿäº†ä¸€ç»„åºåˆ—outputã€‚ è‡³æ­¤ï¼Œå·²ç»å¯ä»¥æ ¹æ®outputæ¥æ±‚å‡ºLCGä¸­çš„aã€bã€nï¼Œä»è€Œæ±‚å‡ºseedï¼Œä»è€Œé€šè¿‡èƒŒåŒ…å¯æ±‚å¾—keyã€‚ 3.ä»¥keyä¸ºseedï¼Œç§°ä½œstateï¼Œå†è¿›è¡ŒLCGï¼Œstate = (a * state + b) % cï¼Œå¹¶ä¸”aï¼Œbï¼Œcå·²çŸ¥ã€‚ ä½†æ˜¯æƒ³è¦ç›´æ¥æ­£å‘æ±‚è§£å‡ºæœ€åçš„stateï¼Œååˆ†å›°éš¾ï¼Œforå¾ªç¯äº†10^10000æ¬¡ï¼Œè¿™é‡Œæ¶‰åŠåˆ°äº†çŸ©é˜µå¿«é€Ÿå¹‚çš„ä½¿ç”¨ã€‚ é€šè¿‡æ„é€ çŸ©é˜µ $$ \\mathbf{A} = \\begin{bmatrix} state &amp; 1 \\end{bmatrix} $$ $$ \\mathbf{C} = \\begin{bmatrix} a &amp; 0\\ b &amp; 1\\ \\end{bmatrix} $$ é€šè¿‡è®¡ç®—$AC^{1010000}$å³å¯å¾—åˆ°çŸ©é˜µBï¼ŒB = [ state, 1] 4.æ±‚å‡ºstateåè¿›è¡Œå¼‚æˆ–è§£å¯†å³å¯ã€‚ EXP &lt;!â€“codeï¿¼1â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"wp","slug":"wp","permalink":"https://sch01ar.github.io/tags/wp/"}]},{"title":"èƒŒåŒ…åŠ å¯†ç®—æ³•","slug":"èƒŒåŒ…é—®é¢˜ç®—æ³•","date":"2022-11-28T16:00:00.000Z","updated":"2022-12-01T09:50:05.003Z","comments":true,"path":"2022/11/29/èƒŒåŒ…é—®é¢˜ç®—æ³•/","link":"","permalink":"https://sch01ar.github.io/2022/11/29/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98%E7%AE%97%E6%B3%95/","excerpt":"","text":"Â¶å‰è¨€ åœ¨ä¸€æ¬¡CTFæ¯”èµ›ä¸­é‡åˆ°äº†ï¼Œå†™äº†10ä¸ªforåµŒå¥—ç¡¬çˆ†å‡ºæ¥äº†ï¼Œå¤ç°çš„æ—¶å€™å‘ç°æ˜¯èƒŒåŒ…åŠ å¯†ã€‚ Â¶Merkleâ€“Hellman å…¬é’¥åŠ å¯†ç®—æ³• æ•´ä½“åŠ å¯†æµç¨‹ &lt;!â€“codeï¿¼0â€“&gt; å¯ä»¥å‘ç°ï¼ŒåŠ å¯†ååˆ†å®¹æ˜“ï¼Œä½†è§£å¯†ååˆ†å›°éš¾ï¼Œè¿™ä¹Ÿæ˜¯éå¯¹ç§°åŠ å¯†çš„ç‰¹ç‚¹ã€‚ Â¶åŠ å¯† Â¶ç”Ÿæˆç§é’¥ è¶…é€’å¢åºåˆ—ï¼Œä¹Ÿå°±æ˜¯aä¸­æ¯ä¸€ä½å…ƒç´ éœ€è¦å¤§äºå…¶ä¹‹å‰æ‰€æœ‰å…ƒç´ çš„å’Œã€‚ &lt;!â€“codeï¿¼1â€“&gt; Â¶ç”Ÿæˆå…¬é’¥ æ¨¡æ•°mè¦æ±‚ï¼šm &gt; sum(a) ä¹˜æ•°wè¦æ±‚ï¼šgcd(w,m) == 1 &lt;!â€“codeï¿¼2â€“&gt; bå’Œmä½œä¸ºå…¬é’¥ã€‚ åŠ å¯†ï¼šS = numpy.dot(x,b) Â¶è§£å¯† æ‹¿åˆ°å…¬é’¥$M=(m_1,m_2,\\ldots,m_n)$ï¼Œæ„é€ å¦‚ä¸‹çŸ©é˜µ $$ \\begin{bmatrix} 2 &amp; 0 &amp; \\ldots &amp; 0 &amp; m_1 \\ 0 &amp; 2 &amp; \\ldots &amp; 0 &amp; m_2 \\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots &amp; \\vdots \\ 0 &amp; 0 &amp; \\ldots &amp; 2 &amp; m_n \\ 1 &amp; 1 &amp; \\ldots &amp; 1 &amp; S \\ \\end{bmatrix} $$ è¿™ä¸ªçŸ©é˜µçš„æ‰€æœ‰è¡Œå‘é‡çš„çº¿æ€§ç»„åˆæ„æˆäº†ä¸€ä¸ªæ ¼ï¼Œæ¥ä¸‹æ¥å°†é€šè¿‡æ˜æ–‡çš„ç‰¹ç‚¹å’Œæ ¼ä¸Šçš„ç‰¹æ®Šè§£æ³•æ¥è¿›è¡Œè§£å¯†ã€‚ Â¶LLL å¯¹äºæ˜æ–‡$X=(x_1,x_2,\\ldots,x_n)$è¿™ä¸€ç»„æ•°æ¥è¯´ï¼Œæ„é€ ä¸€ä¸ªå‘é‡ $$ a=\\sum_{i=1}^nx_iv_i-v_{n+1}=(2x_1-1,2x_2-1,\\ldots,2x_n-1,0) $$ æ˜¾ç„¶ï¼Œaå‘é‡åœ¨æ ¼Lä¸Šã€‚å› ä¸ºXä¸­çš„æ‰€æœ‰xåªèƒ½å–å€¼0æˆ–1ï¼Œå› æ­¤aå‘é‡çš„é•¿åº¦å¾ˆå°ï¼Œçº¦ä¸º$\\sqrt{n}$ï¼Œå¯¹äºå¾ˆå¤§çš„æ ¼åŸºæ¥è¯´ï¼Œaå‘é‡æ— ç–‘æ˜¯æ ¼Lä¸Šçš„æœ€å°å‘é‡ï¼Œå› æ­¤æˆ‘ä»¬åˆ©ç”¨LLLç®—æ³•å³å¯æ±‚å‡ºaå‘é‡ã€‚ Â¶ä¾‹é¢˜ &lt;!â€“codeï¿¼3â€“&gt; è¿™é‡Œæ³¨æ„ä¸€ä¸‹ï¼Œç¬¬ä¸€è¡Œå‘é‡ä¸­æ˜¯æœ‰+1ä¸-1ï¼Œéœ€è¦è¿›è¡Œå–åï¼Œå³-1ä»£è¡¨1ï¼Œ1ä»£è¡¨0ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"éå¯¹ç§°åŠ å¯†","slug":"éå¯¹ç§°åŠ å¯†","permalink":"https://sch01ar.github.io/tags/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/"}]},{"title":"Hitcon 2022-ãŠ™ï¸BabySSS","slug":"hitcon2022-BabySSS","date":"2022-11-27T16:00:00.000Z","updated":"2022-12-01T09:37:56.735Z","comments":true,"path":"2022/11/28/hitcon2022-BabySSS/","link":"","permalink":"https://sch01ar.github.io/2022/11/28/hitcon2022-BabySSS/","excerpt":"","text":"I implemented a toy Shamirâ€™s Secret Sharing for fun. Can you help me check is there any issues with this? Shamirâ€™s Secret Sharingå¯†é’¥åˆ†äº«ç®—æ³• $$f(x)=a_0 + a_1x + a_2x^2 + â€¦â€¦ + a_{k-1} x^{k-1} mod p $$ é¢˜ç›®æºç  &lt;!â€“codeï¿¼0â€“&gt; é¢˜ç›®åˆ†æ é¢˜ç›®ç»™äº†8ç»„xï¼Œyçš„å€¼ï¼Œå¯é€šè¿‡CRTæ¨¡xæ±‚å‡ºa_0 ï¼Œé€šè¿‡æ¨¡x^2 å¯æ±‚å‡ºa_1 ï¼ŒåŒç†å¯æ±‚å‡ºæ‰€æœ‰ç³»æ•°ï¼Œæ¢å¤å‡ºpolyevalå‡½æ•°ï¼Œä»è€Œå¾—åˆ°æ­£ç¡®çš„secretã€‚ EXP &lt;!â€“codeï¿¼1â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"wp","slug":"wp","permalink":"https://sch01ar.github.io/tags/wp/"}]},{"title":"Gaussæ ¼åŸºçº¦ç®€ç®—æ³•","slug":"Gaussæ ¼åŸºçº¦ç®€ç®—æ³•","date":"2022-11-23T16:00:00.000Z","updated":"2022-12-07T09:39:00.075Z","comments":true,"path":"2022/11/24/Gaussæ ¼åŸºçº¦ç®€ç®—æ³•/","link":"","permalink":"https://sch01ar.github.io/2022/11/24/Gauss%E6%A0%BC%E5%9F%BA%E7%BA%A6%E7%AE%80%E7%AE%97%E6%B3%95/","excerpt":"","text":"ç”±Gaussæå‡ºçš„äºŒç»´æ ¼åŸºçº¦åŒ–ç®—æ³• ç®—æ³•ä¼ªä»£ç  å³å¯¹ç»™å®šçš„ä¸¤ä¸ªåŸºå‘é‡è¿›è¡Œä¸æ–­çš„ç›¸äº’çº¦åŒ–ï¼Œæœ€ç»ˆæ±‚å¾—æ ¼ä¸Šçš„æœ€å°å‘é‡ Loop (a) If ||v2|| &lt; ||v1||, swap v1, v2 (b) Compute m = âŒŠ v1âˆ™v2 / v1âˆ™v1 âŒ‰ Â© If m = 0, return v1, v2 (d) v2 = v2 - m*v1 Continue Loop ä»£ç å®ç° &lt;!â€“codeï¿¼0â€“&gt; ä¾‹é¢˜ &lt;!â€“codeï¿¼1â€“&gt; Â¶æ€è·¯ ç»™å®šå…¬é’¥qã€hï¼Œä»¥åŠæ˜æ–‡e è¦æ±‚ç§é’¥fã€g ä»–ä»¬ä¹‹é—´æœ‰å¦‚ä¸‹å…³ç³»ï¼š fh â‰¡ g mod q å³ kq + g =fh g = fh -kq æ ¹æ®è¿™ä¸€ç‰¹ç‚¹å³å¯æ„é€ æ ¼ï¼Œä¹Ÿå°±æ˜¯æ ¼å¯†ç ä¸­å¾ˆç»å…¸çš„ï¼Œé‡åˆ°ä¸€ä¸ªå‘é‡ä¹˜çŸ©é˜µï¼Œå³å¯è¿›è¡Œæ„é€  ç”±äºå­˜åœ¨ä¸€ç»„aã€bï¼Œä½¿å¾—aï¼ˆ1ï¼Œhï¼‰+ bï¼ˆ0ï¼Œqï¼‰=ï¼ˆfï¼Œgï¼‰$a(1,h) + b(0,q) = (f,g)$ a = fï¼Œb = k é€‰å–ä¸€ç»„åŸºåº•ä¸ºï¼ˆ1ï¼Œhï¼‰å’Œï¼ˆ0ï¼Œqï¼‰ï¼Œä¹Ÿå°±æ˜¯ä¸Šè¿°é«˜æ–¯çº¦ç®€ç®—æ³•å½“ä¸­çš„v1ä¸v2ï¼Œæ±‚å‡ºv1ä¸v2æ ¼ä¸Šæœ€å°çš„å‘é‡ï¼Œå³ä¸ºï¼ˆfï¼Œgï¼‰ Â¶EXP &lt;!â€“codeï¿¼2â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"lattice","slug":"lattice","permalink":"https://sch01ar.github.io/tags/lattice/"}]},{"title":"äºŒå‰æ ‘å»ºç«‹ä¸éå†","slug":"äºŒå‰æ ‘å»ºç«‹ä¸éå†","date":"2022-11-09T16:00:00.000Z","updated":"2022-12-01T05:15:01.487Z","comments":true,"path":"2022/11/10/äºŒå‰æ ‘å»ºç«‹ä¸éå†/","link":"","permalink":"https://sch01ar.github.io/2022/11/10/%E4%BA%8C%E5%8F%89%E6%A0%91%E5%BB%BA%E7%AB%8B%E4%B8%8E%E9%81%8D%E5%8E%86/","excerpt":"","text":"ç½‘ä¸Šå¾ˆå¤šç®—æ³•é€šè¿‡ç›´æ¥å°†äºŒå‰æ ‘ç»“ç‚¹è¿æ¥ï¼Œä»è€Œæ„æˆäºŒå‰æ ‘ï¼Œè¿™é‡Œæˆ‘æ„å»ºäº†ä¸€ä¸ªäºŒå‰æ ‘ç±»ï¼Œé€šè¿‡ç”¨æˆ·æ§åˆ¶è¾“å…¥æ¥å»ºç«‹äºŒå‰æ ‘ã€‚ æœ‰å±‚åºéå†ï¼Œé€’å½’ã€éé€’å½’çš„å‰åºéå†ã€ä¸­åºéå†ã€ååºéå†ç®—æ³•ã€‚ &lt;!â€“codeï¿¼0â€“&gt;","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://sch01ar.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"äºŒå‰æ ‘","slug":"äºŒå‰æ ‘","permalink":"https://sch01ar.github.io/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/"}]},{"title":"2022ç¥¥äº‘æ¯wp-crypto","slug":"2022-10-30-2022ç¥¥äº‘æ¯wp-crypto","date":"2022-10-29T16:00:00.000Z","updated":"2022-12-07T09:43:16.370Z","comments":true,"path":"2022/10/30/2022-10-30-2022ç¥¥äº‘æ¯wp-crypto/","link":"","permalink":"https://sch01ar.github.io/2022/10/30/2022-10-30-2022%E7%A5%A5%E4%BA%91%E6%9D%AFwp-crypto/","excerpt":"","text":"little little fermat Â¶é¢˜ç›®æºç  &lt;!â€“codeï¿¼0â€“&gt; Â¶é¢˜ç›®åˆ†æ æ ¹æ®é¢˜ç›®åå­—æ¥çœ‹ï¼Œæ­¤é¢˜å’Œè´¹é©¬å°å®šç†çš„ä½¿ç”¨æœ‰å…³ï¼Œé¢˜ç›®ä¸­æœ‰ä¸€ä¸ª obfuscateå‡½æ•°ï¼Œè¿›è¡Œäº†å¯¹qçš„ç”Ÿæˆï¼Œq=p+Aï¼Œè¿™é‡Œå¯ä»¥çœ‹ä¸€ä¸‹Açš„èŒƒå›´ï¼Œæ˜¯åœ¨2[18,319]ä¹‹é—´ï¼Œå› æ­¤pã€qæ¥è¿‘ï¼Œå°è¯•ä¸€ä¸‹yafuåˆ†è§£ã€‚ é¢˜ç›®å¯¹må…ˆè¿›è¡Œäº†å¤„ç†ï¼Œå†è¿›è¡ŒRSAåŠ å¯†ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦çŸ¥é“xã€‚assert 114514 ** x % p == 1è¿ç”¨è´¹é©¬å°å®šç†ï¼Œè‹¥114514ä¸päº’ç´ ï¼Œåˆ™x=p-1ï¼Œå³å¯æ±‚è§£mã€‚ Â¶EXP &lt;!â€“codeï¿¼1â€“&gt; fill Â¶é¢˜ç›®æºç  &lt;!â€“codeï¿¼2â€“&gt; Â¶é¢˜ç›®åˆ†æ éšæœºäº§ç”Ÿ32ä½çš„æ•°ï¼Œsha256()åŠ å¯†åä½œä¸ºflagï¼Œå¹¶å°†å…¶2è¿›åˆ¶çš„æ¯ä¸€ä½å­˜åˆ°äº†f_listæ•°ç»„ä¸­ã€‚ åˆ åˆ›å»ºäº†ä¸€ä¸ªr_list32ä½æ•°ç»„ï¼Œé‡Œé¢å­˜ç€éšæœºæ•°ï¼Œå…ˆæš‚æ—¶ä¸ç®¡ã€‚ åŒ å¯¹r_listæ•°ç»„ä¸­çš„éšæœºæ•°åšäº†åŠ å¯†ï¼Œäº§ç”Ÿäº†Mæ•°ç»„ã€‚ å¯¹f_listå’ŒMæ•°ç»„è¿›è¡Œäº†numpy.dotè¿ç®—ï¼Œå³å‘é‡ä¹˜æ³•ï¼Œå¾—åˆ°å’Œä¸ºSã€‚ å’ åˆ›å»ºäº†ä¸€ä¸ªsæ•°ç»„ï¼Œè¿™ä¸ªå¾ˆæ˜æ˜¾ï¼Œç”¨LCGçº¿æ€§åŒä½™ç®—æ³•è¿›è¡Œäº†åŠ å¯†ã€‚ æœ€åå°†Mæ•°ç»„ä¸sæ•°ç»„ç›¸åŠ ã€‚ è¿™å°±æ˜¯è¿™é“é¢˜æ•´ä½“çš„æµç¨‹ï¼Œæ¯ä¸€æ­¥å¹¶ä¸éš¾ï¼Œåªæ˜¯æ­¥éª¤å¤šï¼Œç•¥æ˜¾å¤æ‚ã€‚ Â¶EXP Â¶0x01 å¯ä»¥å…ˆè¿›è¡Œä¸€ä¸‹LCGçš„æ±‚è§£ï¼ŒæŠŠsæ•°ç»„æ±‚è§£å‡ºæ¥ï¼Œä»è€Œæ±‚å‡ºMæ•°ç»„ã€‚ &lt;!â€“codeï¿¼3â€“&gt; Â¶0x02 æŒ‰ç†æ¥è¯´ï¼Œæ„Ÿè§‰åº”è¯¥æ ¹æ®æ±‚å‡ºæ¥çš„Mæ•°ç»„è¿›è¡Œé€†è¿ç®—ï¼Œæ±‚å‡ºr_listæ•°ç»„ï¼Œä½†æ˜¯æ±‚å‡ºæ¥r_listæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Œæ‰€ä»¥ç›´æ¥å°è¯•æ±‚f_listã€‚å› ä¸ºf_listä¸­ä¸æ˜¯0å°±æ˜¯1ï¼Œä¸Måšå‘é‡ä¹˜æ³•ï¼Œå³ä¸ºMæ•°ç»„ä¸­è‹¥å¹²å…ƒç´ çš„å’Œã€‚æ ¹æ®é¢˜ç›®ç»™å®šå’ŒSï¼Œå…ˆå¤§æ¦‚çœ‹ä¸€ä¸‹éœ€è¦Mä¸­å¤šå°‘ä¸ªå…ƒç´ ç´¯åŠ ã€‚å‘ç°åœ¨Må‰21ä½å’Œ &lt; Sï¼Œå‰22ä½å’Œ &gt; Sï¼Œæ‰€ä»¥çŒœæƒ³åº”è¯¥æ˜¯Må½“ä¸­ï¼Œé™¤10ä¸ªå·¦å³å…ƒç´ ä¹‹å¤–çš„å’Œã€‚ è¿™é‡Œå°±éå†äº†ä¸€ä¸‹ï¼Œå¤æ‚åº¦å®åœ¨å¤ªé«˜äº†ï¼Œä¹Ÿæ²¡æƒ³ç€èƒ½å‡ºï¼Œç»“æœè¿˜çœŸç®—å‡ºæ¥äº†o.O &lt;!â€“codeï¿¼4â€“&gt; ä¹Ÿå°±è¯´æ˜ï¼Œf_listä¸­ä¸‹æ ‡ä¸ºè¿™äº›çš„ï¼Œå¯¹åº”å€¼æ˜¯0ï¼Œå…¶ä½™ä¸º1ï¼Œå³å¯å¾—åˆ°msgçš„2è¿›åˆ¶æ•°ï¼Œè½¬ä¸ºåè¿›åˆ¶åè¿›è¡Œsha256()åŠ å¯†å³å¯ã€‚ &lt;!â€“codeï¿¼5â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"wp","slug":"wp","permalink":"https://sch01ar.github.io/tags/wp/"}]},{"title":"2022NewStarCTF-flip_flop","slug":"2022NewStarCTF-flip_flop","date":"2022-10-26T16:00:00.000Z","updated":"2022-12-07T09:41:52.644Z","comments":true,"path":"2022/10/27/2022NewStarCTF-flip_flop/","link":"","permalink":"https://sch01ar.github.io/2022/10/27/2022NewStarCTF-flip_flop/","excerpt":"","text":"flip-flop AES-CBCåŠ å¯†æ¨¡å¼ Â¶é¢˜ç›® æºç å¦‚ä¸‹ï¼š &lt;!â€“codeï¿¼0â€“&gt; Â¶é¢˜ç›®åˆ†æ æ­¤é¢˜æ˜¯é€šè¿‡æ³¨å†Œå¾—åˆ°çš„ç”¨æˆ·è´¦æˆ·çš„å¯†æ–‡ï¼Œç„¶åè¾“å…¥ç®¡ç†å‘˜è´¦æˆ·å¯¹åº”çš„å¯†æ–‡ï¼Œæ‰èƒ½å¾—åˆ°flagã€‚ å¯¹ç”¨æˆ·è´¦æˆ·å’Œç®¡ç†å‘˜è´¦æˆ·çš„åŠ å¯†è§£å¯†å‡é‡‡ç”¨AES-CBCæ¨¡å¼ï¼Œä½†æ˜¯æœ¬é¢˜ä»…æœ‰ä¸€ç»„æ˜æ–‡ï¼Œivä»…ä½œä¸ºåç§»é‡ï¼Œä¹Ÿå°±æ˜¯æœ¬é¢˜ä¸­çš„user_keyã€‚ è¿™é‡Œå…ˆæ¥è¯´ä¸€ä¸‹æˆ‘æœ€ä¸€å¼€å§‹çš„æ€è·¯ï¼Œç”±äºuser_keyæ¯æ¬¡æ˜¯éšæœºäº§ç”Ÿçš„ï¼Œä½†æ˜¯ä¸€æ¬¡ç¨‹åºçš„è¿è¡Œå½“ä¸­æ˜¯ä¸å˜çš„ã€‚ç”±äºå¯†æ–‡ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œå‰åŠéƒ¨åˆ†ä¸ºuser_key.hex()ï¼ŒååŠéƒ¨åˆ†ä¸ºcode.hex()ï¼Œæ‰€ä»¥åªè¦æ„é€ å‡ºadminå¯¹åº”çš„codeå³å¯ï¼Œé‚£ä¹ˆå°±éœ€è¦AESåŠ å¯†å½“ä¸­çš„keyï¼Œæ‰€ä»¥å°±éœ€è¦æ„é€ ä¸€ä¸ªkeyæ¥äº§ç”Ÿå‡ºadminå¯¹åº”çš„codeã€‚æŸ¥è¯¢äº†å¾ˆå¤šèµ„æ–™å‘ç°éƒ½éš¾ä»¥å®ç°ã€‚äºæ˜¯â€¦â€¦ é‚£ä¸ºä»€ä¹ˆä¸æ¢ä¸€ä¸‹æ€è·¯ï¼Ÿä¸èƒ½æ„é€ codeï¼Œèƒ½ä¸èƒ½æ„é€ ivï¼Ÿ å…ˆæ¥çœ‹ä¸€ä¸‹åŠ å¯†æ–¹å¼ï¼š C = encrypt(M ^ iv) M = decryptÂ©^iv å¯¹åº”ä¸€ä¸‹æœ¬é¢˜å½“ä¸­çš„NewStarCTFerå’Œadminï¼š b'NewStarCTFer____' = decrypt(code) ^ iv1 b'AdminAdmin______' = decrypt(code) ^ iv2 å› æ­¤å¯æ±‚å‡ºadminå¯¹åº”çš„iv2ï¼Œéšåæ‹¼æ¥ä¸Šæ™®é€šç”¨æˆ·çš„ååŠæ®µcodeå³å¯ã€‚ Â¶EXP &lt;!â€“codeï¿¼1â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"wp","slug":"wp","permalink":"https://sch01ar.github.io/tags/wp/"}]},{"title":"BUUåˆ·é¢˜æ—¥è®°20221026","slug":"BUUåˆ·é¢˜æ—¥è®°20221026","date":"2022-10-25T16:00:00.000Z","updated":"2022-12-07T09:39:19.641Z","comments":true,"path":"2022/10/26/BUUåˆ·é¢˜æ—¥è®°20221026/","link":"","permalink":"https://sch01ar.github.io/2022/10/26/BUU%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B020221026/","excerpt":"","text":"RSA5 Â¶é¢˜ç›®åˆ†æ ç»™å®še=65537 ç»™äº†å¾ˆå¤šç»„nã€c ç”±äºeè¿‡å¤§ï¼Œæ‰€ä»¥ä¸è€ƒè™‘ä½¿ç”¨CRTï¼Œç”±äºmæ˜¯åŒä¸€ä¸ªï¼Œå› æ­¤éå†ä¸€ä¸‹ï¼Œæ±‚å‡ºä¸¤ä¸ªnçš„æœ€å¤§å…¬çº¦æ•°ï¼Œå³ä¸ºpï¼Œåç»­å°±ç®€å•äº†ã€‚ Â¶EXP &lt;!â€“codeï¿¼0â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"diary","slug":"diary","permalink":"https://sch01ar.github.io/tags/diary/"}]},{"title":"2022 DASCTF 10æœˆæŒ‘æˆ˜èµ›wp","slug":"2022DASCTF10æœˆæŒ‘æˆ˜èµ›wp","date":"2022-10-22T16:00:00.000Z","updated":"2022-12-07T09:42:51.960Z","comments":true,"path":"2022/10/23/2022DASCTF10æœˆæŒ‘æˆ˜èµ›wp/","link":"","permalink":"https://sch01ar.github.io/2022/10/23/2022DASCTF10%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9Bwp/","excerpt":"","text":"RSA Â¶é¢˜ç›®å¦‚ä¸‹ &lt;!â€“codeï¿¼0â€“&gt; Â¶é¢˜ç›®åˆ†æ è¯¥é¢˜çš„åŠ å¯†é¡ºåºæ˜¯ï¼š 1ã€åŠ å¯†flagï¼Œåˆ†ä¸ºä¸¤éƒ¨åˆ†m1ã€m2 2ã€åŠ å¯†m1 3ã€åŠ å¯†m2 åŒç†æˆ‘ä»¬è§£å¯†çš„é¡ºåºåº”è¯¥ä¹Ÿæ˜¯ 1ã€è§£å‡ºm1ã€m2 2ã€è§£å‡ºflag Â¶æ±‚m2 å…ˆè§‚å¯Ÿä¸€ä¸‹encrypt4å‡½æ•° è™½ç„¶è¯´e_2=3ï¼ŒæŒ‰ç†æ¥è¯´ä½¿ç”¨ä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼Œä½†å¹¶ä¸å¯è¡Œã€‚ åˆå› ä¸ºm = m % k å¯é€šè¿‡è¿™ç‚¹å’Œc_3 = pow(m, e_2, n_3)åšéå†æ±‚å‡ºm æœ€åå‘ç°må³ä¸ºm2ï¼Œm2 &lt; k Â¶æ±‚m1 å‘ç°m1åŠ å¯†æ–¹å¼é‡‡ç”¨RSAï¼Œä½†æ˜¯n_1æœªçŸ¥ n_1åˆé€šè¿‡ä¸€æ¬¡RSAåŠ å¯†ï¼Œå·²çŸ¥n_1å¯¹åº”çš„å¯†æ–‡ åˆ©ç”¨ä½åŠ å¯†æŒ‡æ•°æ”»å‡»è§£å‡ºn1 å‘ç°n1å¯åˆ†è§£ä¸º3ä¸ªç´ æ•°ä¹˜ç§¯ æ•…phiå¯æ±‚ï¼Œå³æ±‚å‡ºm1 Â¶æ±‚flag è§‚å¯Ÿencryt1 m1æ˜¯flagå³ç§»200ä½ä¹‹åè½¬ä¸ºå­—èŠ‚ m2æ˜¯flagçš„20ä½ä¹‹åè½¬æˆå­—èŠ‚ æ‰€ä»¥æ¥è¯´m2æ˜¯æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä¸»è¦æ‰¾åˆ°flagçš„å‰20ä½ï¼Œå†æŠŠm2æ‹¼åˆ°åé¢å³å¯ã€‚ ç”±äºm1æ˜¯flagå³ç§»200ä½ï¼Œå› æ­¤flagçš„ä½ä½ç¼ºå¤±ï¼Œä½†é«˜ä½è¿˜åœ¨ï¼Œç”±äºä¸çŸ¥é“flagæ€»é•¿åº¦ï¼ŒæŠ±ç€è¯•ä¸€è¯•çš„å¿ƒæ€ï¼ŒçŒœæµ‹ä¸€ä¸‹å®ƒçš„é«˜ä½å‰20ä½æ²¡æœ‰ç¼ºå¤± æˆ‘ä»¬å°†m1å’Œm2è½¬ä¸ºå­—èŠ‚å‘ç° m1:bâ€™0x666c61677b3230366538353964â€™ m2:bâ€™383539643865383534633466363030636231323735376262663966357dâ€™ å‘ç°m1å’Œm2æœ‰é‡å éƒ¨åˆ†ï¼Œå³38353å¼€å§‹ å¯ä»¥è¯å®m1å‰20ä½ç¡®å®æ²¡æœ‰ç¼ºå¤± å› æ­¤å–m1å‰20ä½ï¼ŒåŠ m2ï¼Œå³å¯è§£å‡ºflag Â¶EXP &lt;!â€“codeï¿¼1â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"wp","slug":"wp","permalink":"https://sch01ar.github.io/tags/wp/"}]},{"title":"BUUåˆ·é¢˜æ—¥è®°20221022","slug":"BUUåˆ·é¢˜æ—¥è®°20221022","date":"2022-10-21T16:00:00.000Z","updated":"2022-12-07T09:40:10.592Z","comments":true,"path":"2022/10/22/BUUåˆ·é¢˜æ—¥è®°20221022/","link":"","permalink":"https://sch01ar.github.io/2022/10/22/BUU%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B020221022/","excerpt":"","text":"RSA4 é¢˜ç›®åªç»™äº†ä¸‰ç»„nã€cï¼Œé‡‡ç”¨ä¸­å›½å‰©ä½™å®šç†ï¼Œå…·ä½“æ¨å¯¼å¦‚ä¸‹ Â¶æ¨å¯¼è¿‡ç¨‹ me â‰¡ c1 mod n1 me â‰¡ c2 mod n2 me â‰¡ c3 mod n3 Â¶ä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰ ä¸­å›½å‰©ä½™å®šç†çš„å†…å®¹æ˜¯ï¼š é’ˆå¯¹ä¸Šè¿°æ–¹ç¨‹ç»„ï¼Œè‹¥n1ã€n2ã€n3äº’è´¨ï¼Œå¯¹äºä»»æ„çš„c1ã€c2ã€c3ï¼Œæ–¹ç¨‹ç»„éƒ½æœ‰è§£ï¼Œä½¿ç”¨æ¡ä»¶æ˜¯m^e &lt; n1ã€n2ã€n3ã€‚é€šè§£å½¢å¼å¦‚ä¸‹ï¼š ä»¤N = n1 * n2 * n3ï¼ŒN1 = N/n1ï¼ŒN2ã€N3åŒç† ä»¤t1 = N1(-1)ï¼Œå³å…¶å¯¹åº”çš„æ¨¡n1è¿ç®—çš„é€†å…ƒï¼Œt2ï¼Œt3åŒç†ï¼Œå¯ç”¨t1=gmpy2.invert(N1,n1)è¡¨ç¤ºã€‚ æœ‰äº†Niå’Œtiçš„å®šä¹‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»™å‡ºé€šè§£å½¢å¼ï¼š x = c1 * N1 * t1 â€¦â€¦ æœ‰äº†é€šè§£å…¬å¼æˆ‘ä»¬å°±å¯ä»¥æ±‚å‡ºm^eï¼Œå¯¹eè¿›è¡Œä¸€ä¸‹éå†å³å¯ï¼Œmå¼€æ–¹æˆåŠŸå³å¯ã€‚ Â¶EXP &lt;!â€“codeï¿¼0â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"diary","slug":"diary","permalink":"https://sch01ar.github.io/tags/diary/"}]},{"title":"BUUåˆ·é¢˜æ—¥è®°20221021","slug":"BUUåˆ·é¢˜æ—¥è®°20221021","date":"2022-10-20T16:00:00.000Z","updated":"2022-12-08T05:42:21.849Z","comments":true,"path":"2022/10/21/BUUåˆ·é¢˜æ—¥è®°20221021/","link":"","permalink":"https://sch01ar.github.io/2022/10/21/BUU%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B020221021/","excerpt":"","text":"RSA2 é¢˜ç›®ç»™å®šnã€eã€dpã€c éé¢„æœŸè§£ï¼šç›´æ¥åˆ†è§£n ä¸‹é¢è€ƒè™‘nä¸èƒ½åˆ†è§£çš„æƒ…å†µ Â¶æ¨å¯¼è¿‡ç¨‹ dp â‰¡ d mod (p-1) ed â‰¡ 1 mod (p-1) * (q-1) ed = 1 + k2(p-1)(q-1) å¯¹1å¼ä¸¤ç«¯åŒä¹˜eï¼Œå¾— e * dp â‰¡ ed mod (p-1) e * dp = k1(p-1) + ed ä»£å…¥edå¾— e * dp = k1(p-1) + 1 + k2(p-1)(q-1) ç”±äºä¸¤ä¸ªæœªçŸ¥æ•°ç•¥æ˜¾éº»çƒ¦ï¼Œå‘ç°å…¬å› å­(p-1)ï¼Œç­‰å¼ä¸¤è¾¹åŒæ—¶å–ä½™p-1ï¼Œå³å¯æ¶ˆæ‰n e * dp â‰¡ 1 mod (p-1) e * dp =k(p-1) + 1 å¾—åˆ°è¿™ä¸ªå¼å­åï¼Œå…¶å®çœŸæ­£æ„ä¹‰ä¸Šçš„æœªçŸ¥æ•°åªæœ‰æˆ‘ä»¬è¦æ±‚çš„pï¼Œä½†æ˜¯è¿˜å­˜åœ¨ä¸€ä¸ªkã€‚ é’ˆå¯¹kï¼Œæˆ‘ä»¬åˆ¤æ–­ä¸€ä¸‹ä»–çš„èŒƒå›´ï¼Œçœ‹çœ‹èƒ½å¦é‡‡ç”¨çˆ†ç ´çš„æ–¹å¼ã€‚ k = (e * dp - 1)/(p-1) å› ä¸ºdp &lt; p-1 æ‰€ä»¥k &lt; e é€šè¿‡éå†kç„¶åæ‰¾åˆ°(e * dp - 1)å¯ä»¥æ•´é™¤kçš„æƒ…å†µå³å¯ã€‚ (è·‘äº†ä¸€ä¸‹å‘ç°é™åˆ¶æ¡ä»¶è¿˜ä¸å¤Ÿ) å› æ­¤å†åŠ ä¸€ä¸ªnèƒ½å¦æ•´é™¤på³å¯ã€‚ Â¶EXP &lt;!â€“codeï¿¼0â€“&gt; RSA3 ç»™å®šnã€e1ã€c1ã€e2ã€c2ã€‚ m â‰¡ c1^e1 mod n m â‰¡ c2^e2 mod n è¿™é‡Œé‡‡ç”¨å…±æ¨¡æ”»å‡»ï¼Œè¯¦ç»†åŸç†å¦‚ä¸‹ï¼š æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼šç»™å®šä¸¤ä¸ªæ•´æ•°aã€bï¼Œå¿…å®šå­˜åœ¨xã€yï¼Œä½¿å¾—gcd(a,b)=ax+by å¯¹åº”åˆ°æœ¬é¢˜å½“ä¸­ï¼Œç”±äºe1ã€e2äº’ä¸ºç´ æ•°ï¼Œå› æ­¤gcd(e1,e2)=1ï¼Œä»è€Œå­˜åœ¨s1ã€s2ä½¿å¾—: s1 * e1 + s2 * e2 = 1 Â¶æ¨å¯¼è¿‡ç¨‹ m = m % n m = m^(s1 * e1 + s2 * e2)^ % n m = m^(e1 * s1)^ * m^(e2 * s2)^ % n m = (m^(e1 * s1)^ % n) * (m^(e2 * s2)^ % n) % n m = (c1s1 % n) * (c2s2 % n) % n Â¶EXP &lt;!â€“codeï¿¼1â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"diary","slug":"diary","permalink":"https://sch01ar.github.io/tags/diary/"}]},{"title":"BUUåˆ·é¢˜æ—¥è®°20221020","slug":"BUUåˆ·é¢˜æ—¥è®°20221020","date":"2022-10-19T16:00:00.000Z","updated":"2022-12-06T07:25:59.850Z","comments":true,"path":"2022/10/20/BUUåˆ·é¢˜æ—¥è®°20221020/","link":"","permalink":"https://sch01ar.github.io/2022/10/20/BUU%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B020221020/","excerpt":"","text":"RSA1 ç»™å®šdpã€dqç±»å‹ dp â‰¡ d mod (p-1) dq â‰¡ d mod (q-1) m â‰¡ cd mod n m = cd + k * n m = cd +k * p * q å¯¹ä¸Šå¼ä¸¤ç«¯åŒæ—¶å¯¹pã€qåˆ†åˆ«å–ä½™ï¼Œå¾—ï¼šï¼ˆä¸­å›½å‰©ä½™å®šç†ï¼‰ m1 â‰¡ cd mod p m2 â‰¡ cd mod q åŒç†ï¼Œå¯å¾—åˆ° cd = m1 +k * p ä»£å…¥åˆ° m2 â‰¡ cd mod q ä¸­ï¼š m2 â‰¡ (m1 + k * p)mod q ï¼Œä¸¤ç«¯å‡å»m1å¾— m2 - m1 â‰¡ k * p mod q ï¼Œä¸¤ç«¯ä¹˜pçš„é€†å…ƒå¾— (m2 - m1)p-1 â‰¡ k mod q å°†kä»£å…¥åˆ° cd = m1 +k * p ä¸­å¾—ï¼š cd = m1 + ((m2 - m1)p-1 mod q) * p m=cd mod n å¾—åˆ° m â‰¡ (((m2 - m1) * p-1 mod q) * p + m1) mod n æ¥ä¸‹æ¥å°±æ˜¯æ±‚è§£m1ï¼Œm2 m1 â‰¡ cdp+k(p-1) mod p m2 â‰¡ cdq+k(q-1) mod q æ ¹æ®è´¹é©¬å°å®šç† è‹¥pæ˜¯ç´ æ•°ï¼Œåˆ™a(p-1) â‰¡ 1 mod p å› æ­¤ m1 â‰¡ cdp mod pï¼Œm2 â‰¡ cdq mod q æœ€ç»ˆå¯æ±‚å¾—m Â¶exp &lt;!â€“codeï¿¼0â€“&gt; RSAROLL &lt;!â€“codeï¿¼1â€“&gt; ç»™äº†ä¸€ä¸ªdata.txtæ–‡ä»¶ï¼Œæ‰“å¼€ç›²çŒœä¸€ä¸‹ç¬¬ä¸€è¡Œæ˜¯nï¼Œeï¼Œåé¢æ˜¯c &lt;!â€“codeï¿¼2â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"diary","slug":"diary","permalink":"https://sch01ar.github.io/tags/diary/"}]},{"title":"2021ByteCTF-easyxor","slug":"2021ByteCTF-easyxor","date":"2022-10-15T16:00:00.000Z","updated":"2022-12-07T09:34:59.756Z","comments":true,"path":"2022/10/16/2021ByteCTF-easyxor/","link":"","permalink":"https://sch01ar.github.io/2022/10/16/2021ByteCTF-easyxor/","excerpt":"","text":"é¢˜ç›®æºç å¦‚ä¸‹ &lt;!â€“codeï¿¼0â€“&gt; é¢˜ç›®åˆ†æ å°†flagåˆ†ä¸ºä¸¤æ®µï¼Œå‰åŠæ®µé‡‡ç”¨OFBåŠ å¯†ï¼ŒååŠæ®µé‡‡ç”¨CBCåŠ å¯† Â¶OFBè§£å¯† å°†å‰åŠæ®µflagåˆè¿›è¡Œåˆ‡åˆ†ï¼Œå°†å…¶8ä½åˆ†ä¸ºä¸€ç»„ï¼Œå­˜åˆ°groupæ•°ç»„ä¸­ã€‚ &lt;!â€“codeï¿¼1â€“&gt; é’ˆå¯¹ä¸€ä¸ªéšæœºç”Ÿæˆçš„64ä½çš„lastï¼Œä¸keysè¿›è¡ŒconvertåŠ å¯†ï¼Œå†ä¸groupä¸­çš„æ•°è¿›è¡Œå¼‚æˆ–ã€‚ keysæ˜¯å››ä¸ª-32ï½32çš„æ•°ï¼Œå¯çˆ†ç ´ã€‚ å¯¹äºOFBè§£å¯†ååˆ†ç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬å·²çŸ¥ç¬¬ä¸€ç»„æ˜æ–‡ï¼Œæ°å¥½æ˜¯8ä½çš„â€™ByteCTF{'ï¼Œç”±äºåˆ†ç»„å¯†ç çš„æ€§è´¨ï¼Œæ‰€ä»¥åé¢çš„ä¹Ÿå°±è¿åˆƒè€Œè§£ï¼Œé€šè¿‡group[ 0]^cipher[ 0] å³å¯å¾—åˆ°cur_cï¼Œä»è€Œæ±‚å¾—ä¸‹ä¸€æ¬¡çš„cur_cï¼Œä»¥æ­¤ç±»æ¨ã€‚ Â¶expOFB &lt;!â€“codeï¿¼2â€“&gt; Â¶CBCè§£å¯† é’ˆå¯¹ååŠéƒ¨åˆ†ï¼Œæˆ‘ä»¬éœ€è¦é€†å‘è§£å‡ºconvertå‡½æ•°ï¼Œå› æ­¤å°±æ˜¯å¯¹shiftå‡½æ•°ä¸­çš„åŠ å¯†è¿ç®—è¿›è¡Œè§£å¯†ã€‚ ä¹‹å‰ä¸Šç½‘æœçš„wpéƒ½ä¸€ç¬”å¸¦è¿‡ï¼Œæ²¡è§£é‡Šunshifté€†å‡½æ•°æ€ä¹ˆå†™çš„ã€‚â€œéš¾é“æœ‰ä»€ä¹ˆå®šç†ï¼Ÿï¼Ÿâ€ è¿™é‡Œç®€å•å†™ä¸€ä¸‹æˆ‘çš„ç†è§£ã€‚ Â¶åˆ†æshift &lt;!â€“codeï¿¼3â€“&gt; Â¶æ¨ç†è¿‡ç¨‹ è¿™é‡Œæˆ‘ä»¬ä¸¾ä¾‹k&gt;0æ—¶çš„æƒ…å†µã€‚ï¼ˆk&lt;0åŒç†ï¼‰ må’Œcéƒ½æ˜¯64ä½,kæ˜¯-32ï½32çš„10è¿›åˆ¶æ•°ã€‚ 1ã€m &lt;&lt; kç›¸å½“äºåœ¨måè¡¥kä½0ï¼Œå¾—åˆ°çš„æ–°æ•°æˆ‘ä»¬ç§°ä¸ºaï¼Œa=m &lt;&lt; kã€‚ 2ã€ä»¤b = a &amp; cï¼Œç”±äºaæ˜¯64+kä½ï¼Œcæ˜¯64ä½ï¼Œæ‰€ä»¥bæ˜¯64ä½ï¼Œå¹¶ä¸”bçš„åkä½éƒ½æ˜¯0ã€‚ 3ã€ä»¤x = m ^ bï¼Œxåˆ™æ˜¯shiftåŠ å¯†ä¹‹åçš„å€¼ï¼Œxä¹Ÿæ˜¯64ä½ï¼Œå¹¶ä¸”xçš„åkä½æ˜¯ä¸mçš„åkä½ç›¸åŒçš„ï¼Œä¸0å¼‚æˆ–å¾—æœ¬èº«ã€‚ æˆ‘ä»¬èµ°å®Œäº†ä¸€éshiftåŠ å¯†ï¼Œå¾—åˆ°çš„ç»“è®ºæ˜¯ï¼Œå¯†æ–‡çš„ä½æ•°åŒæ ·æ˜¯64ï¼Œå¹¶ä¸”å¯†æ–‡çš„åkä½ä¸æ˜æ–‡ç›¸åŒã€‚ Â¶åˆ†æunshift &lt;!â€“codeï¿¼4â€“&gt; Â¶æ¨ç†è¿‡ç¨‹ åŒæ ·æˆ‘ä»¬ä¸¾ä¾‹k&gt;0çš„æƒ…å†µã€‚ ä¹‹å‰æˆ‘ä»¬å¾—åˆ°çš„å¯†æ–‡xï¼Œç›¸å½“äºtmpã€‚ 1ã€aâ€™=tmp &lt;&lt; kï¼Œtmpåkä½ä¸º0ï¼Œtmpå2kï½kä½ç­‰äºmçš„åkä½ã€‚ 2ã€bâ€™=aâ€™ &amp; cï¼Œbâ€™åkä½ä¸º0ï¼Œå2kï½kä½ä¸ºm&amp;cã€‚ 3ã€y=x ^ bâ€™ï¼Œyçš„åkä½ï¼Œç­‰äºxçš„åkä½ï¼Œä¹Ÿå°±æ˜¯mçš„åkä½ã€‚ 4ã€yçš„å2kï½kä½ï¼Œåœ¨shiftåŠ å¯†å½“ä¸­ï¼Œa &amp; cçš„å2kï½kä½ç­‰äºmçš„åkä½&amp;cï¼Œè®°ä½œm1 &amp; cã€‚ shiftä¸­çš„xï¼Œä¹Ÿå°±æ˜¯m ^ bï¼Œm ^(m1 &amp; c)ï¼Œåœ¨unshiftæœ€åçš„ä¸€æ­¥æ“ä½œä¸­ï¼Œy= m ^(m1 &amp; c) ^ bâ€™ã€‚ è¿™æ—¶æˆ‘ä»¬åªè€ƒè™‘yçš„å2kï½kä½ï¼Œy=m ^(m1 &amp; c)^(m1 &amp; c) = m æ‰€ä»¥è¿™æ—¶yçš„2kï½kä½ä¹Ÿç­‰äºmäº†ã€‚ Â¶æ€»ç»“ å› æ­¤ï¼Œæˆ‘ä»¬å‘ç°æ¯ç»è¿‡unshiftä¸€æ¬¡ï¼Œå°±æœ‰kä½è¢«è¿˜åŸï¼Œä½•æ—¶æ‰èƒ½è¢«å®Œå…¨è¿˜åŸï¼Ÿå³å¾ªç¯bits//kæ¬¡ã€‚ æ­¤æ¨ç†æ­£ç¡®ï¼Œå¯ä»¥åœ¨unshiftå‡½æ•°è¿è¡Œæ—¶è¾“å‡ºæ¯æ¬¡çš„tmpè§‚å¯Ÿå³å¯ã€‚ psï¼šè‡ªæˆ‘æ„Ÿè§‰è¿™ç§ä½è¿ç®—åº”è¯¥æ˜¯å±äºä¸€ç§æ€§è´¨æˆ–è€…å®šç†ï¼Œç½‘ä¸Šå¤§ä½¬ä»¬éƒ½æ˜¯è¯´â€œç®€å•å†™ä¸ªé€†â€ã€‚ã€‚ã€‚ Â¶expCBC &lt;!â€“codeï¿¼5â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"wp","slug":"wp","permalink":"https://sch01ar.github.io/tags/wp/"}]},{"title":"2022BUUCTFæ–°ç”Ÿèµ›-RSA","slug":"2022BUUCTFæ–°ç”Ÿèµ›-RSA","date":"2022-10-15T16:00:00.000Z","updated":"2022-12-08T07:35:16.441Z","comments":true,"path":"2022/10/16/2022BUUCTFæ–°ç”Ÿèµ›-RSA/","link":"","permalink":"https://sch01ar.github.io/2022/10/16/2022BUUCTF%E6%96%B0%E7%94%9F%E8%B5%9B-RSA/","excerpt":"","text":"é¢˜ç›®æºç  &lt;!â€“codeï¿¼0â€“&gt; é¢˜ç›®åˆ†æ å‘ç°nå’Œphinéƒ½ä¸å¸¸è§„ï¼Œæ²¡å…¥æ‰‹ç‚¹ï¼Œå‘ç°hintï¼Œhint=pow(d,e,n)ï¼Œæœ‰è¶£ï¼Œç”¨dåšæ˜æ–‡ï¼Œå°è¯•æ¨ç†ä¸€ä¸‹ï¼š d = pow(hint,d,n) d = pow((d ** e % n),d,n) d = (d ** e % n) ** d % n d = d ** (e*d) % n d = pow(d ** e,d,n) æŠŠd ** eå†æ¬¡çœ‹åšå¯†æ–‡ï¼Œå¯å¾— d ** e = pow(d,e,n) å› ä¸ºhint = pow(d,e,n) å¯å¾—hint = d ** e d ** e * e ** e-&gt;(ed) ** e-&gt;(ed) ** e == 1 mod phin å› æ­¤æ ¹æ®eå’Œhintå³å¯æ±‚å¾—phin ä»è€Œå¾—åˆ°phinå’Œnçš„æœ€å¤§å…¬çº¦æ•°p è„šæœ¬å¦‚ä¸‹ &lt;!â€“codeï¿¼1â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"wp","slug":"wp","permalink":"https://sch01ar.github.io/tags/wp/"}]},{"title":"æ¢¦å¼€å§‹çš„åœ°æ–¹","slug":"æ¢¦å¼€å§‹çš„åœ°æ–¹","date":"2022-10-15T07:59:58.000Z","updated":"2022-12-01T05:15:04.679Z","comments":true,"path":"2022/10/15/æ¢¦å¼€å§‹çš„åœ°æ–¹/","link":"","permalink":"https://sch01ar.github.io/2022/10/15/%E6%A2%A6%E5%BC%80%E5%A7%8B%E7%9A%84%E5%9C%B0%E6%96%B9/","excerpt":"","text":"Â¶Macä¸‹åˆ©ç”¨Hexoå’Œgithub pagesæ­å»ºä¸ªäººåšå®¢ Â¶ç¯å¢ƒé…ç½® Â¶1.Node.jså®‰è£… ä¸‹è½½åœ°å€ï¼šNode.js Â¶2.æ·˜å®é•œåƒå®‰è£… &lt;!â€“codeï¿¼0â€“&gt; Â¶3.å®‰è£…Hexo &lt;!â€“codeï¿¼1â€“&gt; Â¶åˆå§‹åŒ–Hexo Blog Â¶1.åˆå§‹åŒ–Hexo æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å¹¶è¿›å…¥ï¼Œä¾‹å¦‚blog &lt;!â€“codeï¿¼2â€“&gt; Â¶2.æœ¬åœ°å¯åŠ¨Hexo &lt;!â€“codeï¿¼3â€“&gt; æµè§ˆå™¨æ‰“å¼€ç½‘ç«™ï¼Œå³å¯çœ‹åˆ°æœ¬åœ°åšå®¢ Â¶åˆ›å»ºåšå®¢æ–‡ç«  Â¶1.åˆ›å»ºæ–‡ç«  &lt;!â€“codeï¿¼4â€“&gt; åœ¨blogæ–‡ä»¶å¤¹ä¸­çš„_posté‡Œå³å¯çœ‹åˆ°æ–°å»ºçš„mdæ–‡ä»¶ Â¶2.æ¸…ç†ç¼“å­˜é¡¹ç›® åœ¨æ–°å»ºåšå®¢æˆ–ä¿®æ”¹åšå®¢æ—¶ï¼Œéœ€è¦è¿›è¡Œè¯¥æ“ä½œ &lt;!â€“codeï¿¼5â€“&gt; Â¶3.é‡æ–°ç”Ÿæˆåšå®¢ &lt;!â€“codeï¿¼6â€“&gt; Â¶4.å¯åŠ¨åšå®¢ &lt;!â€“codeï¿¼7â€“&gt;","categories":[{"name":"å»ºç«™","slug":"å»ºç«™","permalink":"https://sch01ar.github.io/categories/%E5%BB%BA%E7%AB%99/"}],"tags":[{"name":"åšå®¢æ­å»º","slug":"åšå®¢æ­å»º","permalink":"https://sch01ar.github.io/tags/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"}]},{"title":"Hello World","slug":"hello-world","date":"2022-10-15T07:57:23.442Z","updated":"2022-12-01T05:15:29.274Z","comments":true,"path":"2022/10/15/hello-world/","link":"","permalink":"https://sch01ar.github.io/2022/10/15/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Â¶Quick Start Â¶Create a new post &lt;!â€“codeï¿¼0â€“&gt; More info: Writing Â¶Run server &lt;!â€“codeï¿¼1â€“&gt; More info: Server Â¶Generate static files &lt;!â€“codeï¿¼2â€“&gt; More info: Generating Â¶Deploy to remote sites &lt;!â€“codeï¿¼3â€“&gt; More info: Deployment","categories":[],"tags":[]}],"categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"},{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://sch01ar.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"},{"name":"å»ºç«™","slug":"å»ºç«™","permalink":"https://sch01ar.github.io/categories/%E5%BB%BA%E7%AB%99/"}],"tags":[{"name":"lattice","slug":"lattice","permalink":"https://sch01ar.github.io/tags/lattice/"},{"name":"wp","slug":"wp","permalink":"https://sch01ar.github.io/tags/wp/"},{"name":"éå¯¹ç§°åŠ å¯†","slug":"éå¯¹ç§°åŠ å¯†","permalink":"https://sch01ar.github.io/tags/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/"},{"name":"äºŒå‰æ ‘","slug":"äºŒå‰æ ‘","permalink":"https://sch01ar.github.io/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/"},{"name":"diary","slug":"diary","permalink":"https://sch01ar.github.io/tags/diary/"},{"name":"åšå®¢æ­å»º","slug":"åšå®¢æ­å»º","permalink":"https://sch01ar.github.io/tags/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"}]}