{"meta":{"title":"Y's blog","subtitle":"","description":"","author":"Roo1e","url":"https://sch01ar.github.io","root":"/"},"pages":[{"title":"å…³äº","date":"2022-12-10T07:36:44.999Z","updated":"2022-12-02T03:15:20.960Z","comments":false,"path":"about/index.html","permalink":"https://sch01ar.github.io/about/index.html","excerpt":"","text":"ğŸ­ğŸ­"},{"title":"Repositories","date":"2022-10-16T03:25:28.438Z","updated":"2022-10-15T08:09:45.464Z","comments":false,"path":"repository/index.html","permalink":"https://sch01ar.github.io/repository/index.html","excerpt":"","text":""},{"title":"åˆ†ç±»","date":"2022-10-16T02:33:21.117Z","updated":"2022-10-15T08:09:45.464Z","comments":false,"path":"categories/index.html","permalink":"https://sch01ar.github.io/categories/index.html","excerpt":"","text":""},{"title":"æ ‡ç­¾","date":"2022-10-16T02:41:49.050Z","updated":"2022-10-15T08:09:45.464Z","comments":false,"path":"tags/index.html","permalink":"https://sch01ar.github.io/tags/index.html","excerpt":"","text":""},{"title":"ä¹¦å•","date":"2022-10-16T02:30:27.247Z","updated":"2022-10-15T08:09:45.464Z","comments":false,"path":"books/index.html","permalink":"https://sch01ar.github.io/books/index.html","excerpt":"","text":""},{"title":"å‹æƒ…é“¾æ¥","date":"2022-10-17T01:02:57.129Z","updated":"2022-10-15T08:09:45.464Z","comments":false,"path":"links/index.html","permalink":"https://sch01ar.github.io/links/index.html","excerpt":"","text":""}],"posts":[{"title":"NKCTF2023","slug":"2023NKCTF","date":"2023-04-03T02:05:45.000Z","updated":"2023-04-03T11:34:15.402Z","comments":true,"path":"2023/04/03/2023NKCTF/","link":"","permalink":"https://sch01ar.github.io/2023/04/03/2023NKCTF/","excerpt":"","text":"æ•°å­—ä¸­å›½ Babysecret &lt;!â€“codeï¿¼0â€“&gt; NKCTF2023 Â¶babyRSA é¢˜ç›® &lt;!â€“codeï¿¼1â€“&gt; Â¶é¢˜ç›®åˆ†æ é¢˜ç›®ååŠéƒ¨åˆ†æ˜¯ dp æ³„éœ²ï¼Œé€šè¿‡ Nã€eã€dP å¯æ±‚å‡º Pã€Q &lt;!â€“codeï¿¼2â€“&gt; Â¶æ³•ä¸€ ä¹‹åè¦é€šè¿‡$P = mp;mod;n$ä¸$Q=mq; mod ;n$æ¥æ±‚è§£ mï¼Œä¸‹é¢è¿›è¡Œä¸€äº›æ•°å­¦æ¨å¯¼ $$ c_1q=m{pq};mod;n\\\\ c_1{pq}=c_2{p2};mod;n\\\\\\ c_1{pq}=c_2{p2};mod;p\\\\ $$ æ ¹æ®è´¹é©¬å°å®šç†è½¬æ¢å¯å¾— $$ c_1n=c_2p;mod;p\\\\ gcd(c_1^n-c_2,n);=;p\\\\ $$ æ±‚å‡º p å’Œ q åï¼Œä½¿ç”¨ crt å³å¯æ±‚å¾— m &lt;!â€“codeï¿¼3â€“&gt; Â¶æ³•äºŒ é€šè¿‡æ¨å¯¼å°†åŸå¼è½¬æ¢ä¸º $$ PQ=(k_1p+m)(k_2q+m)\\\\ m(P+Q)=2m^2+(k_1p+k_2q)m\\\\ PQ-m(P+Q)+m^2=k_1k_2n\\\\ PQ-m(c_1+c_2)+m^2=0;mod;n $$ &lt;!â€“codeï¿¼4â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"DUTCTF2023","slug":"DUTCTF2023","date":"2023-03-28T02:05:45.000Z","updated":"2023-03-28T09:29:06.114Z","comments":true,"path":"2023/03/28/DUTCTF2023/","link":"","permalink":"https://sch01ar.github.io/2023/03/28/DUTCTF2023/","excerpt":"","text":"DUTCTF2023wp Â¶å†™åœ¨å‰é¢ ä»”ç»†ä¸€æƒ³è‡ªå·±å­¦ CTF ä¹Ÿä¸€å¹´äº†ï¼Œçºªå¿µä¸€ä¸‹æœ€åä¸€æ¬¡å‚åŠ æ ¡èµ› ğŸ¥¹ï¼Œæ˜å¹´å¯å°±æ˜¯å‡ºé¢˜äººäº† ğŸ¤“ã€‚ä½†æ˜¯æ„Ÿè§‰ä¸€å¹´ä»¥æ¥è’åºŸäº†å¾ˆå¤šæ—¶é—´ï¼Œåœ¨å¾ˆå¤šæ–¹é¢å¯¹é¢˜ç›®ä¸ç†Ÿæ‚‰ï¼Œæ€»è·‘åï¼Œç”šè‡³æ˜¯è‡ªå·±å¤ç°è¿‡çš„ä¸€äº›æ–¹æ³•éƒ½æ²¡æ„è¯†åˆ°ï¼ˆhint å¤ªåˆ°ä½äº† ğŸ˜­ï¼‰ã€‚ Â¶Crypto ç¬¬ä¸€æ¬¡ akï¼Œå¥½çˆ½ ğŸ˜­ Â¶*è€æ»šäº” ç™¾åº¦æœé¾™è¯­ï¼Œè€å¿ƒå¯¹ç€æ‰¾å°±å‡ºäº†DUTCTF&#123;YOU_ARE_A_REAL_DRAGONBORN&#125; Â¶*ç¥å¥‡çš„çŸ­ä¿¡ è¯ºåŸºäºšæ‰‹æœºï¼Œ9 é”®ï¼Œç¬¬ä¸€ä½ä»£è¡¨å“ªä¸ªé”®ï¼Œç¬¬äºŒä¸ªä»£è¡¨ç¬¬å‡ ä¸ªå­—æ¯ï¼ŒDUTCTF&#123;SCREW&#125; Â¶éšæœºæ•°çš„åŠ›é‡ å¯å…ˆäº†è§£ä¸€ä¸‹ MT19937 ä¼ªéšæœºæ•°åŸç†ï¼Œç„¶åçœ‹ä¸€ä¸‹ç ´è§£æ–¹æ³•ï¼Œå¯¹äºæ¢…æ£®æ—‹è½¬ç®—æ³•ä¹‹å‰åšå®¢ä¹Ÿè¯¦ç»†æ¨å¯¼è¿‡ã€‚è¿™é‡Œé’ˆå¯¹é¢˜ç›®åˆ†æä¸€ä¸‹ï¼Œé¦–å…ˆ ban æ‰äº† 32 ä½çš„é¢„æµ‹æ–¹æ³•ï¼Œé€šè¿‡äº†è§£åˆ°ï¼Œrandcrackåº“å®é™…ä¸Šæ˜¯é€šè¿‡æ”¶å–ç‰¹å®šä½æ•°æ¥å®ç°é¢„æµ‹ï¼Œä¾‹å¦‚ 32 ä½æ•°ï¼Œå°±éœ€è¦ 624 ä¸ªï¼Œé‚£ä¹ˆå¦‚æœä½¿ç”¨ 64 ä½æ•°ï¼Œåº”è¯¥å°±éœ€è¦ 312 ä¸ªã€‚åç»­åªè¦å¯¹æ”¶å–çš„æ•°å­—è¿›è¡Œä¸€ä¸‹å¤„ç†ï¼Œè½¬æˆ 624 ä¸ª 32 ä½æ•°å³å¯ã€‚ è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªç–‘é—®å°±æ˜¯ï¼Œæœ€å¤§çš„ 64 ä½æ•°æ˜¯$2{64}-1$ï¼Œä½†æ˜¯å¦‚æœä¼ $name=2{64}-1$å°±æ— æ³•é¢„æµ‹ï¼Œè€Œæ”¹æˆå…¶ä½™ç•¥å°ä¸€ç‚¹çš„ 64 ä½æ•°å³å¯ã€‚ Â¶exp &lt;!â€“codeï¿¼0â€“&gt; Â¶shamir ç›´æ¥æ‰¾è„šæœ¬è·‘ï¼Œå…·ä½“å¦‚ä½•æ¢å¤ a0 ç³»æ•°å°±ä¸ç»†è¯´äº†ã€‚ä¹‹å‰ hitcon æœ‰ä¸ªä¹Ÿæ˜¯ shamir çš„é¢˜ï¼Œä¹ŸæŒºæœ‰æ„æ€çš„ã€‚babysss &lt;!â€“codeï¿¼1â€“&gt; Â¶ECC1 å‘ç°æ˜¯ ECDSA ç±»å‹ï¼Œäºæ˜¯ç°å­¦ã€‚ã€‚ã€‚ä¸‹é¢å†™ä¸€ä¸‹ ECDSA çš„ç­¾åä¸éªŒè¯è¿‡ç¨‹ã€‚ Â¶åœºæ™¯ Alice æƒ³è¦ä½¿ç”¨å¥¹çš„ç§é’¥$d_A$æ¥ç­¾åï¼ŒBob æƒ³ç”¨ Alice çš„å…¬é’¥ $H_A$è¦éªŒè¯ç­¾å$H_A=d_AG$ã€‚ åªæœ‰ Alice æ‰èƒ½æä¾›æ­£ç¡®çš„ç­¾åï¼Œè€Œæ¯ä¸ªäººéƒ½å¯ä»¥éªŒè¯ç­¾åã€‚ Â¶ç­¾å 1.é€‰å®šä¸€æ¡æ¤­åœ†æ›²çº¿$E_p(a,b)$ã€‚ 2.é€‰å–ä¸€ä¸ªéšæœºæ•°$k,1&lt;k&lt;n-1$ï¼Œ$n$ä¸ºæ¤­åœ†æ›²çº¿çš„é˜¶ã€‚ 3.é€‰å–æ¤­åœ†æ›²çº¿çš„åŸºç‚¹$G(a,b)$,è®¡ç®— $K=k * G(a,b)$ï¼Œä»¤$r=K[0]\\mod n$ï¼Œå³ r æ˜¯ K ç‚¹çš„æ¨ªåæ ‡ï¼ˆè‹¥ r ä¸º 0ï¼Œé‡æ–°é€‰ k è¿›è¡Œè®¡ç®—ï¼‰ã€‚ 4.è®¡ç®—æ˜æ–‡ M çš„å“ˆå¸Œï¼Œä»¤$e=hash(M)$ï¼Œè®¡ç®—$s=k^{-1}(z+rd_A)\\mod n$ã€‚ 5.ç»™å‡ºç­¾å$(r,s)$ Â¶éªŒè¯ 1.è®¡ç®— $u_1=s^{-1}z\\mod n$ 2.è®¡ç®— $u_2=s^{-1}r\\mod n$ 3.è®¡ç®—ç‚¹$P=u_1G+u_2H_A$ å½“$r=x_P\\mod n$æ—¶ï¼Œç­¾åéªŒè¯æˆåŠŸã€‚ Â¶è§£é¢˜è¿‡ç¨‹ é€šè¿‡å¯¹é¢˜ç›®çš„åˆæ­¥é˜…è¯»ï¼Œå‘ç°å…³é”®æ˜¯æ±‚å‡ºç§é’¥d=privkeyï¼Œè€Œæƒ³è¦æ±‚å‡º$d$å°±è¦æ±‚å‡º$k$ï¼Œè™½ç„¶$k$ æ˜¯ä»¥éšæœºæ•°çš„å½¢å¼å‡ºç°ï¼Œä½†å‘ç°æœ¬é¢˜ä¸­æ¯æ¬¡ç­¾åè¿‡ç¨‹çš„ k å¹¶ä¸æ˜¯å®Œå…¨éšæœºï¼Œè€Œæ˜¯çº¿æ€§ä¼ªéšæœº$k = (a * k + b)\\mod n$ã€‚è¿™é‡Œæˆ‘å¾ˆæƒ³æŠŠ$k$æ±‚å‡ºæ¥ï¼Œç„¶åå†å»æ±‚ç§é’¥$d$ã€‚æ‰€ä»¥æœ‰æ²¡æœ‰ä¸€ç§å¯èƒ½ï¼Œä¸ç”¨æ±‚$k$ï¼Œå¦‚æœæŠŠ$k$æ¶ˆæ‰ï¼Œæ–¹ç¨‹é‡Œåªå‰©ä¸€ä¸ªæœªçŸ¥æ•°$d$ï¼Œå³å¯ã€‚ç»†å¿ƒä¸€ç‚¹è¿›è¡Œæ•°å­¦æ¨å¯¼ï¼Œå°±ä¼šå‘ç°ç­”æ¡ˆã€‚ $$k_1s_1=e+r_1d\\mod n$$ $$k_2s_2=e+r_2d\\mod n$$ $$k_2=ak_1+b\\mod n$$ $$k_2=ak_1+b+xn$$ $$s_1s_2k_2=s_1s_2ak_1+s_1s_2b+s_1s_2xn$$ $$s_1(e+r_2d)=s_2a(e+r_1d)+s_1s_2b \\mod n$$ $$d=(s_1r_2-s_2ar_1)^{-1}(s_2ae-s_1e+s_1s_2b)\\mod n$$ è¿™é‡Œä¸¤æ¬¡çš„ä½¿ç”¨çš„$e$ä¸€æ ·ï¼Œæ˜¯å› ä¸ºä¼ çš„æ˜æ–‡ä¸€æ ·ï¼Œ$n$å¯¹åº”çš„æ˜¯é¢˜ç›®é‡Œç»™çš„$order$ã€‚è¿™é‡Œè¿˜æƒ³è¯´ä¸€ä¸‹è‡ªå·±å› ä¸ºä¸ç»†è‡´èµ°è¿‡çš„å¼¯è·¯ï¼Œé¢˜ç›®é‡Œé€šè¿‡$p$å®šä¹‰çš„æ›²çº¿ï¼Œæ‰€ä»¥è¯¯ä»¥ä¸º$curve.order$æ˜¯$p$ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´å‰ä¸¤ä¸ªå¼å­å’Œç¬¬ä¸‰ä¸ªç®—å¼çš„æ¨¡æ•°ä¸åŒã€‚æœ‰è¶£çš„æ˜¯ï¼Œæ‰¾åˆ°äº†ä¸€ç¯‡è®ºæ–‡å’Œæ–‡ç« è¿›è¡Œäº†å®ç°ã€‚ è®ºæ–‡ ä½†å…¶å®$curve.order=order$æ‰€ä»¥ä¸Šè¿°æ‰€æœ‰éƒ½æ˜¯åœ¨æ¨¡$orderçš„æ¡ä»¶ä¸‹$ï¼Œæ‰€ä»¥è¿›è¡Œä¸€ä¸‹æ¨å¯¼å°±å‡ºäº†ã€‚ Â¶exp &lt;!â€“codeï¿¼2â€“&gt; Â¶ECC2 hint:äºŒå…ƒ copper çœ‹åˆ° hint ç¬é—´çŸ¥é“æ€ä¹ˆåšäº†ï¼Œå‰æ®µæ—¶é—´åˆšå­¦äº†ä¸€ä¸‹å¤šå…ƒ copperï¼Œæ„Ÿæ…¨ä¸€ä¸‹è¿˜æ˜¯è¿ç”¨ä¸ç†Ÿç»ƒï¼Œæ²¡æœ‰ä¸€çœ¼å‘ç°ã€‚ Â¶è§£é¢˜æ€è·¯ åŒæ ·æ˜¯ ECDSAï¼Œç›¸æ¯”äºä¸Šé¢˜æ¥è¯´ï¼Œk æ˜¯éšæœºçš„ï¼Œä½†æ˜¯æ¯æ¬¡ç­¾åçš„æ—¶å€™ä¼šæ³„éœ² k çš„é«˜ä½ã€‚æ­¤é¢˜å¦å¤–ä¸€ä¸ªå…³é”®æ˜¯ï¼Œ$r$æ˜¯ç”±ç§é’¥$d$ç”Ÿæˆçš„ï¼Œæ‰€ä»¥ä¸ç®¡ä¼ ä»€ä¹ˆæ˜æ–‡ï¼Œæ‰€å¾—åˆ°çš„$r$æ˜¯ä¸€æ ·çš„ï¼Œåˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªäºŒå…ƒæ–¹ç¨‹ã€‚ $$s_1k_1=z_1+dr \\mod n$$ $$s_2k_2=z_2+dr \\mod n$$ $$k=kh+kl$$ $$s_1(k_1h+k_1l)-z_1=s_2(k_2h+k_2l)-z_2 \\mod n$$ $$f(k_1l,k_2l)=s_1(k_1h+k_1l)-z_1-s_2(k_2h+k_2l)+z_2$$ éšåä½¿ç”¨å¤šå…ƒ copper è¿›è¡Œæ±‚è§£ã€‚å…·ä½“å¯çœ‹ä¸Šç¯‡åšå®¢ã€‚ &lt;!â€“codeï¿¼3â€“&gt; Â¶ez_RSA hint 1:è®ºæ–‡ hint 2: &lt;!â€“codeï¿¼4â€“&gt; Â¶è§£é¢˜æ€è·¯ é€šè¿‡è®ºæ–‡ï¼Œå‰åŠéƒ¨åˆ†ç™½ç»™ï¼ŒæŒ‰ç…§è®ºæ–‡é€ æ ¼ï¼Œå³å¯è§„çº¦å‡º$_P$ã€‚ æ¥ä¸‹æ¥çš„é—®é¢˜å°±æ˜¯å¦‚ä½•æ±‚$_E$ $$c=rh+m \\mod p$$ $$h=f^{-1}g \\mod p$$ å°†ä¸€å¼å¸¦å…¥äºŒå¼ $$c=r(f^{-1}g)+m \\mod p$$ $$cf=rg+mf \\mod p$$ å› ä¸º r æ˜¯ 1024 ä½ï¼Œg æ˜¯ 768 ä½ï¼Œf æ˜¯ 1024 ä½ï¼Œm æ˜¯ 128 ä½ï¼Œp æ˜¯ 2048 ä½ï¼Œæ‰€ä»¥ $$rg+mf \\mod p=rg+mf$$ $$cf \\mod p=rg+mf$$ ä¸¤è¾¹åŒæ—¶å¯¹$g$å–æ¨¡ï¼Œå³å¯æ¶ˆå»æœªçŸ¥æ•°$r$ï¼Œå¾—åˆ° $$m=(f*c \\mod p)*f^{-1} \\mod g$$ Â¶exp &lt;!â€“codeï¿¼5â€“&gt; Â¶misc Â¶*ç­¾åˆ° b ç«™ 21 çº§ pwn ä¾‹ä¼šè¯„è®ºåŒº Â¶æˆ‘åœ¨å“ª æ”¾å¤§å›¾ç‰‡çœ‹åˆ°åå…«ä¸­ï¼Œæœç´¢ä¸´æ±Ÿåå…«ä¸­ï¼Œå‘ç°æ˜¯é‡åº†åå…«ä¸­ï¼Œåœ°å›¾ä¸Šæœä¸€ä¸‹é™„è¿‘åœ°é“ç«™ï¼ŒæŒ¨ç€æ¡¥çš„å°±æ˜¯ï¼Œæ›¾å®¶å²©ã€‚ Â¶ä¸è¦æ›´æ–° æµé‡åˆ†æé¢˜ï¼Œwireshark é‡Œè¿‡æ»¤ä¸€ä¸‹ httpï¼Œæ‰¾åˆ° github ç½‘é¡µ æ ¹æ® hint æŸ¥çœ‹å†å²æäº¤è®°å½•ï¼Œå‘ç°å‡ flagï¼Œå¯¹äºå¯†ç æ‰‹æ¥è¯´ä¸€çœ¼å‡¯æ’’ï¼Œç§»ä½ 13ã€‚ Â¶web Â¶*Trenja F12 æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œæœç´¢ flag å­—æ®µå³å¯ã€‚ Â¶pwn Â¶*ä¸­é—´äºº å¤ªå¥½ç©äº†ï¼ŒåŸç†æ˜¯æ±½è½¦æ»šåŠ¨ç ã€‚bob æ¥å¼€è½¦é—¨ï¼Œæˆªæ–­ï¼Œå¼€é—¨å¤±è´¥ã€‚bob å†å¼€è½¦é—¨ï¼Œæˆªæ–­ï¼Œå‘é€ç¬¬ä¸€æ¬¡æˆªæ–­ä¿¡å·ï¼Œbob å¼€é—¨æˆåŠŸã€‚bob ç¦»å¼€ï¼Œæˆ‘ä»¬å‘é€ç¬¬äºŒæ¬¡æˆªæ–­çš„ä¿¡å·ï¼Œæ‰“å¼€è½¦é—¨ï¼ Â¶reverse Â¶*è´ªåƒè›‡ æ‹–å…¥ IDAï¼Œalt+t æœç´¢ DUT å³å¯ Â¶*GAME ä¸‹æ£‹èµ¢äº†å°±å‡ºäº†","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"Coppersmithç›¸å…³æ”»å‡»","slug":"Coppersmithæ”»å‡»","date":"2023-03-07T02:05:45.000Z","updated":"2023-03-23T07:22:43.941Z","comments":true,"path":"2023/03/07/Coppersmithæ”»å‡»/","link":"","permalink":"https://sch01ar.github.io/2023/03/07/Coppersmith%E6%94%BB%E5%87%BB/","excerpt":"","text":"åŸç† Coppersmith å®šç†æ˜¯åœ¨ä¸€ä¸ª e é˜¶æ¨¡ n çš„å¤šé¡¹å¼$f(x)$ä¸­ï¼Œè‹¥æœ‰æ ¹å°äº$n^{\\frac{1}{e}}$ï¼Œåˆ™å¯ä»¥ç”¨ O(log n)çš„ç®—æ³•æ±‚å‡ºæ ¹ã€‚ ç›´æ¥æ±‚è§£$f(x)$çš„æ ¹å¯èƒ½æ¯”è¾ƒå›°éš¾ï¼Œåœ¨æ­¤åˆ©ç”¨LLLç®—æ³•æ±‚å¾—å¤šé¡¹å¼$g(x)$ï¼Œæ±‚å¾—çš„å¤šé¡¹å¼ä¸$f(x)$å…·æœ‰ç›¸åŒçš„æ ¹$x_0$ï¼Œ$g(x)$å…·æœ‰æ›´å°çš„ç³»æ•°ï¼Œä¸”å®šä¹‰åŸŸä¸ºæ•´æ•°åŸŸã€‚ æœ¬è´¨æ€æƒ³å°±æ˜¯æŠŠæœ‰é™åŸŸä¸Šçš„æ–¹ç¨‹è½¬åŒ–åˆ°æ•´æ•°åŸŸã€‚ ç†è®ºåŸºç¡€ $$f(x,y) = \\sum_{i=0}{d}\\sum_{j=0}{e} a_{i,j}xiyj$$ Â¶Howgrave-Graham éœ€è¦æ„é€ ä¸€ä¸ªç³»æ•°æ›´å°çš„å¤šé¡¹å¼ï¼Œ$||g(x)||$ä»£è¡¨èŒƒæ•°ï¼Œå³æœ€å¤§çš„ç³»æ•°ã€‚æ„é€ æ–¹æ³•å¦‚ä¸‹ Â¶LLL ç®—æ³• æ ¼åŸºçº¦åŒ–ç®—æ³•ï¼Œé€šè¿‡å¯¹æ„é€ å‡ºçš„æ ¼ï¼Œä»è€Œçº¦åŒ–äº§ç”Ÿç¬¦åˆçº¦æŸçš„å¤šé¡¹å¼ã€‚ Â¶p é«˜ä½æ”»å‡» &lt;!â€“codeï¿¼0â€“&gt; Â¶dp é«˜ä½æ”»å‡» ç»™å®š$e,n,c,dp_0,k,;dp_0=dp&gt;&gt;k$ $$ edp\\equiv ed\\equiv 1;mod;(p-1)\\ edp=k(p-1)+1\\ edp+k-1=kp\\ edp+k-1 \\equiv 0; mod; p\\ \\because dp&lt; p-1\\ \\because edp=k(p-1)+1\\ \\therefore e&gt;k\\ \\therefore e(dp_0 &lt;&lt; k+x)+k-1 \\equiv 0;mod;p $$ &lt;!â€“codeï¿¼1â€“&gt; Â¶EXP &lt;!â€“codeï¿¼2â€“&gt; Â¶å¤šå…ƒ coppersmith åŸç†å­¦ä¹  è®ºæ–‡å­¦ä¹  1ã€ è®ºæ–‡å­¦ä¹  2 è„šæœ¬æ¥æº &lt;!â€“codeï¿¼3â€“&gt; å…·ä½“å‚æ•°è¯´æ˜ï¼Œä¾‹å¦‚ &lt;!â€“codeï¿¼4â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"DLPä¸­å¸¸ç”¨ç®—æ³•","slug":"DLPä¸­å¸¸ç”¨ç®—æ³•","date":"2023-02-24T10:05:45.000Z","updated":"2023-03-04T06:03:05.157Z","comments":true,"path":"2023/02/24/DLPä¸­å¸¸ç”¨ç®—æ³•/","link":"","permalink":"https://sch01ar.github.io/2023/02/24/DLP%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95/","excerpt":"","text":"Pohlig-Hellman ç®—æ³•ï¼ˆå…‰æ»‘é˜¶ï¼‰ ç»™å®š a,b,pï¼Œp æ˜¯ç´ æ•°ï¼Œæ±‚ xï¼Œ$a^x \\equiv b (mod;p)$ åœ¨æ¨¡ p ä¸‹ï¼Œè®¾è¯¥ç¾¤çš„ç”Ÿæˆå…ƒä¸º gï¼Œåˆ™æœ‰ $$ a \\equiv g^{a1} (mod;p) \\newline b \\equiv g^{b1} (mod;p) $$ è”ç«‹æ¡ä»¶æœ‰ $$ g^{a1x} \\equiv g^{b1} (mod;p) $$ ç”±æ¬§æ‹‰å®šç†å¾—$\\phiÂ§;=;p-1$ï¼Œåˆ™æœ‰$a1x;=b1;(mod;(p-1))$ 1.å°† p-1 åˆ†è§£ï¼Œå³ $p-1=p_1{k_1}p_2{k_2}\\cdots p_m^{k_m}$ 2.å°† x è¡¨ç¤ºæˆ$p_i$ è¿›åˆ¶, åˆ—å‡ºæ–¹ç¨‹ $$x;=p_i^0a_0 + p_i1a_1+â€¦+p_i{k_i-1}a*{k_i-1}$$ 3.ä»¤ r=1ï¼Œæ±‚$(ax){\\frac{p-1}{p_i^r}}; \\equiv b{\\frac{p-1}{p_ir}}(mod; p)$ 4.å°† 2 ä¸­çš„å…¬å¼ä»£å…¥åˆ° 3ï¼Œå±•å¼€å¾—åˆ° $$a^{a0*\\frac{p-1}{p_i}}* a^{(p-1)a1} * a{(p-1)p_ia_2}â€¦a{(p-1)p_i^{k_i-2}a_{k_i-1}} \\equiv b^{\\frac{p-1}{p_i}}(mod;p)$$ 5.ä»ç¬¬äºŒé¡¹å¼€å§‹ï¼Œåé¢æ¯é¡¹éƒ½æ˜¯ 1ï¼Œæ¬§æ‹‰å®šç†:$a^{(p-1)} \\equiv 1(mod;p)$ï¼ŒåŒ–ç®€å¾—åˆ°çš„å¼å­ä¸º $$\\newline a^{a0*\\frac{p-1}{p_i}} \\equiv b^{\\frac{p-1}{p_i}}(mod ;p)\\newline$$ å› ä¸ºè¯¥æ–¹ç¨‹åªæœ‰ a0 æœªçŸ¥ï¼Œæ‰€ä»¥å¯åœ¨[0,pi-1]èŒƒå›´å†…çˆ†ç ´å‡º a0 6.å†ä»¤ r = 2,3,4â€¦kiï¼Œé‡å¤æ­¥éª¤ 3ï¼Œå³å¯æ±‚å‡ºæ‰€æœ‰çš„$a_2,a_3â€¦a_{k_i-1}$ï¼Œä»è€Œå¾—åˆ° m ä¸ªå…³äº x çš„æ–¹ç¨‹ï¼Œæœ€åä½¿ç”¨ CRT è¿›è¡Œæ±‚è§£å³å¯ã€‚ æ€»ç»“:å°† p-1 çš„ m ä¸ªè´¨å› å­ï¼Œåˆ†åˆ«æ±‚å‡ºå…¶æ–¹ç¨‹å†…çš„æ‰€æœ‰ç³»æ•° aï¼Œä»è€Œæ„é€ äº† m ä¸ªå…³äº x çš„æ–¹ç¨‹ï¼Œæœ€ç»ˆåˆ©ç”¨ CRT æ±‚è§£ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"è¿‘æœŸ","slug":"è¿‘æœŸ","date":"2023-02-20T06:05:45.000Z","updated":"2023-03-04T06:00:15.740Z","comments":true,"path":"2023/02/20/è¿‘æœŸ/","link":"","permalink":"https://sch01ar.github.io/2023/02/20/%E8%BF%91%E6%9C%9F/","excerpt":"","text":"ECC å¸¸ç”¨æ–¹ç¨‹ï¼ˆç»´å°”æ–¯ç‰¹æ‹‰æ–¯æ ‡å‡†å½¢å¼ï¼‰ $y2;=x3+ax+b$ï¼Œåˆ¤åˆ«å¼$\\Delta=-16(4a3+27b2);mod;p=0$ Â¶sage ç¯å¢ƒ è¿›è¡Œç®€å•è¿ç®— &lt;!â€“codeï¿¼0â€“&gt; Â¶ECDLP ç»™å®šæ¤­åœ†æ›²çº¿ Eï¼Œå·²çŸ¥ Pã€Q ä»¥åŠ$Q=kP$ï¼Œæ±‚ kã€‚ &lt;!â€“codeï¿¼1â€“&gt; Â¶crypto-sign-in-1(VNCTF2023) ä¸€é“ ECDLP é¢˜ç›®ï¼Œå½“æ—¶æƒ³åˆ°ä½¿ç”¨Pohlig-Hellmanç®—æ³•ï¼Œä½†æ˜¯ä¸€ç›´æ²¡èƒ½æ‰¾åˆ°åˆé€‚çš„ Aã€B æ¥ç¡®å®š G çš„é˜¶ nï¼Œèµ›åçœ‹å¤§ä½¬ wpï¼Œæœç„¶æ˜¯ç”¨ pwntools è¿œç¨‹å¤šè¯•å‡ ç»„ y1ã€y2ï¼Œæ‰¾åˆ°å…‰æ»‘çš„é˜¶ï¼Œä»è€Œè§£å¯†æˆåŠŸã€‚ &lt;!â€“codeï¿¼2â€“&gt; Â¶EXP &lt;!â€“codeï¿¼3â€“&gt; Â¶singular attack åˆ©ç”¨æ›²çº¿ä¸Šçš„å¥‡å¼‚ç‚¹è¿›è¡Œæ”»å‡»ï¼Œå¥‡ç‚¹å°±æ˜¯è¯¥ç‚¹å¯¼æ•°ä¸å­˜åœ¨ï¼Œæˆ–è€…å¯¼æ•°ä¸º 0 ä½†ä¸æ˜¯æå€¼ç‚¹ã€‚ è‹¥æ¤­åœ†æ›²çº¿çš„åˆ¤åˆ«å¼$\\Delta=-16(4a3+27b2);mod;p=0$ï¼Œè¯´æ˜è¯¥æ›²çº¿æœ‰å¥‡ç‚¹ã€‚ Â¶RWCTF2023 ä½“éªŒèµ› &lt;!â€“codeï¿¼4â€“&gt; æ ¹æ®é¢˜ç›®ï¼Œå¯å¾—åˆ°æ›²çº¿å…³äº x çš„å¯¼æ•°ï¼Œ$3x2+4x+1$ï¼Œæ‰€ä»¥å¯å¾—åˆ°æ–¹ç¨‹ä¸º$y2=x3+2x2+x+C$ é¢˜ç›®å·²çŸ¥ç‚¹(4,10)åœ¨æ›²çº¿ä¸Šï¼Œä»£å…¥å¾—åˆ° 100 = 64 + 32 + 4 + Cï¼Œå³ C = 0ï¼Œæ‰€ä»¥æ–¹ç¨‹ç¡®å®š$y2=x3+2x^2+x$ æ–¹ç¨‹å·¦å³æ±‚å¯¼å¾—åˆ°$2y \\frac{dy}{dx}=3x^2+4x+1$ï¼Œæ‰€ä»¥å½“ y=0 æ—¶å¯¼æ•°ä¸å­˜åœ¨ï¼Œå†æŠŠ y=0 ä»£å…¥æ–¹ç¨‹ï¼Œæ±‚å¾— x=-1ï¼Œæ‰€ä»¥æ‰¾åˆ°è¯¥æ›²çº¿çš„å¥‡ç‚¹ä¸º(-1,0)ã€‚ ä¸‹ä¸€æ­¥æˆ‘ä»¬æŠŠæ›²çº¿å¹³ç§»ï¼Œä½¿å¾—æ›²çº¿ä»¥(0,0)ä¸ºå¥‡ç‚¹ï¼Œå¾—åˆ°y^2 = x^3 + 193387944202565886198256260591909756040*x^2ï¼Œæ”¹å†™ä¸ºy^2 = (x + 193387944202565886198256260591909756040) * x^2 å› ä¸º193387944202565886198256260591909756040 = pow(89654903351345918131227153390056628523,2,p) æˆ‘ä»¬å°±å¯æŠŠ Pã€Q ç‚¹æ˜ å°„åˆ°ä¹˜æ³•ç¾¤ä¸Šï¼Œä»è€Œè¿›è¡Œç®€å•çš„å¯¹æ•°è®¡ç®—ã€‚ æ˜ å°„æ³•åˆ™å¦‚ä¸‹: $$(x,y)\\rightarrow\\frac{y+tx}{y-tx}$$ Â¶EXP &lt;!â€“codeï¿¼5â€“&gt; RSA Â¶DLP Â¶magic(hitcon2021) &lt;!â€“codeï¿¼6â€“&gt; Â¶EXP Â¶rabin é€‚ç”¨äº RSA ä¸­ e=2 çš„æƒ…å†µ Â¶pqpq(seccon2022) &lt;!â€“codeï¿¼7â€“&gt; Â¶å¤§è‡´æ€è·¯ æ ¹æ®é¢˜ç›®ï¼Œå¯å…ˆé€šè¿‡è®¡ç®— c1ã€c2 è¡¨è¾¾å¼ï¼Œåˆå¹¶æ‰¾å‡ºå…¬å› å­ï¼Œå³å¯æ±‚å‡º pã€qï¼Œä»è€Œ r ä¹Ÿå¯æ±‚å¾—ã€‚ å‘ç° e=65537 * 2ï¼Œå› æ­¤æ˜¯æ— é€†å…ƒå­˜åœ¨çš„ï¼Œç´¢æ€§å°±å°† e æ‹†åˆ†ä¸º 65537 ä¸ 2ï¼Œe2=2 æ—¶ä¾¿å¯é€šè¿‡ Rabin ç®—æ³•è§£å¯†ã€‚ Â¶æ±‚ pã€qã€r $c2 = (p - q)^e \\mod n \\$ å·¦å³åŒä¹˜ r $c2 * r = rp^e + rq^e + X*pqr = rp^e + rq^e \\mod n\\$ $c2 = p^e + q^e \\mod n\\$ åŒç†å¾—åˆ°$c1 = p^e - q^e \\mod n \\$ ä»è€Œæ±‚å¾— pã€q $p=gcd(c1+c2,n)\\$ $q=gcd(c1-c2,n)\\$ Â¶æ±‚è§£ m^2 $\\phi(n)=(p-1)(q-1)(r-1)\\$ é€šè¿‡ e1(e/2)å’Œ$\\phi(n)$æ±‚å‡º dï¼Œå¾—åˆ°$cmd=m{2e1d}=m^2 \\mod n$ Â¶Rabin è§£å¯† æ¥ä¸‹æ¥å°±æ˜¯ä¼ ç»Ÿ Rabin è§£å¯†ï¼Œæ‰¾äº†ä¸¤ç§è„šæœ¬ï¼Œexp ä¸­çš„sqrtPrime(n,p)å’ŒTonelli_Shanks(n,p)ä»»é€‰å…¶ä¸€å³å¯ï¼Œéƒ½æ˜¯åŸºäºäºŒæ¬¡å‰©ä½™å®šç†æ‰€å®ç°çš„è§£å¯†ç®—æ³• &lt;!â€“codeï¿¼8â€“&gt; Â¶parity","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"RSAè¡¥å……","slug":"RSAè¡¥å……","date":"2022-12-07T13:05:45.000Z","updated":"2023-02-09T09:15:46.189Z","comments":true,"path":"2022/12/07/RSAè¡¥å……/","link":"","permalink":"https://sch01ar.github.io/2022/12/07/RSA%E8%A1%A5%E5%85%85/","excerpt":"","text":"å›é¡¾ RSA ä¸­åŠ ã€è§£å¯†ï¼š åŠ å¯†$c = m^e\\quad mod\\quad n$ è§£å¯†$m = c^d\\quad mod\\quad n$ æ¥ä¸‹æ¥è¯æ˜ä¸€ä¸‹è§£å¯†è¿‡ç¨‹ï¼Œå…ˆå¼•å…¥æ¬§æ‹‰å®šç†ã€‚ Â¶æ¬§æ‹‰å®šç† å¯¹äºäº’ä¸ºè´¨æ•°çš„ mã€n ä¸¤ä¸ªæ•°ï¼Œæœ‰$m^{\\phi(n)} = 1\\quad mod\\quad n$ï¼Œå…¶ä¸­$\\phi(n)$è¡¨ç¤ºå°äº n çš„è´¨æ•°çš„ä¸ªæ•°ã€‚ Â¶è§£å¯†åŸç† é€šè¿‡$c = m^e\\quad mod\\quad n$ä¸æ¬§æ‹‰å®šç†$m^{\\phi(n)} = 1\\quad mod\\quad n$ï¼Œæˆ‘ä»¬ä¾¿å¯è¿›è¡Œæ¨å¯¼ã€‚ å¯¹æ¬§æ‹‰å®šç†è¿›è¡Œå˜å½¢ï¼Œå¾—åˆ°$m^{k\\phi(n)+1} = m\\quad mod\\quad n$ å› ä¸ºæˆ‘ä»¬å·²ç»çŸ¥é“$c = m^e\\quad mod\\quad n$ï¼Œæ‰€ä»¥å¯»æ‰¾ä¸€ä¸ª dï¼Œä½¿å¾—$ed = k\\phi(n)+1$,åˆ™å¯ä»¥å¾—åˆ°$m^{ed}=m\\quad mod \\quad n$ åˆ™å¾—åˆ°äº†$c^d =m\\quad mod\\quad n$ å…±æ¨¡æ”»å‡» æ‰€è°“å…±æ¨¡ï¼Œå°±æ˜¯ n ç›¸åŒï¼Œä¼šå¯¹åº”å¤šç»„ cï¼Œeã€‚ ä¾‹ï¼šç»™å®š nã€c1ã€c2ã€e1ã€e2 m = c1e1 mod n m = c2e2 mod n Â¶æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³• ç»™å®šä¸¤ä¸ªæ•´æ•° aã€bï¼Œå¿…å®šå­˜åœ¨ xã€yï¼Œä½¿å¾— gcd(a,b)=ax+by è¿ç”¨è¯¥ç®—æ³•æ¨å¯¼è¿‡ç¨‹ m = m % n m = ms1e1+s2e2 % n m = (me1s1 * me2s2)% n m = (me1s1 % n) * (me2s2 % n) % n m = (c1s1 % n) * (c2s2 % n) % n Â¶EXP &lt;!â€“codeï¿¼0â€“&gt; ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡» ç‰¹ç‚¹æ˜¯ e å°ï¼Œæœ‰å¤šç»„ nï¼Œå¯¹åº”äº†å¤šç»„ c me = c1 mod n1 me = c2 mod n2 me = c3 mod n3 Â¶ä¸­å›½å‰©ä½™å®šç†(CRT) å®šç†å†…å®¹å¦‚ä¸‹ é’ˆå¯¹ä¸Šè¿°æ–¹ç¨‹ç»„ï¼Œè‹¥ n1ã€n2ã€n3 äº’è´¨ï¼Œå¯¹äºä»»æ„çš„ c1ã€c2ã€c3ï¼Œæ–¹ç¨‹ç»„éƒ½æœ‰è§£ mã€‚ ä½¿ç”¨æ¡ä»¶æ˜¯ m^e &lt; n1ã€n2ã€n3ã€‚é€šè§£æ¨å¯¼å¦‚ä¸‹ï¼š è®¾$N=n_1 \\times n_2 \\times n_3, N_1=N/n_1, N_2=N/n_2, N_3=N/n_3$ è®¾$t_i=N_i^{-1}$,è¿™é‡Œè¡¨ç¤º$t_i$æ˜¯$N_i$åœ¨æ¨¡$n_i$çš„é€†å…ƒã€‚ æœ‰äº†ä»¥ä¸Šå‡ ä¸ªæ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å‡ºé€šè§£å½¢å¼ï¼š $$m=c_1t_1N_1+c_2t_2N_2+c_3t_3N_3+kN=kN+\\sum_{i=1}^3c_it_iN_i$$ åœ¨æ¨¡ N åï¼Œåªå‰©å”¯ä¸€è§£$m=\\sum_{i=1}^3c_it_iN_i$ Â¶EXP &lt;!â€“codeï¿¼1â€“&gt; dpã€dq ç›¸å…³ Â¶ç»™å®š dpã€dq ç±»å‹ dp â‰¡ d mod (p-1) dq â‰¡ d mod (q-1) m â‰¡ cd mod n m = cd + k * n m = cd +k _ p _ q å¯¹ä¸Šå¼ä¸¤ç«¯åŒæ—¶å¯¹ pã€q åˆ†åˆ«å–ä½™ï¼Œå¾—ï¼šï¼ˆä¸­å›½å‰©ä½™å®šç†ï¼‰ m1 â‰¡ cd mod p m2 â‰¡ cd mod q åŒç†ï¼Œå¯å¾—åˆ° cd = m1 +k * p ä»£å…¥åˆ° m2 â‰¡ cd mod q ä¸­ï¼š m2 â‰¡ (m1 + k * p)mod q ï¼Œä¸¤ç«¯å‡å» m1 å¾— m2 - m1 â‰¡ k * p mod q ï¼Œä¸¤ç«¯ä¹˜ p çš„é€†å…ƒå¾— (m2 - m1)p-1 â‰¡ k mod q å°† k ä»£å…¥åˆ° cd = m1 +k * p ä¸­å¾—ï¼š cd = m1 + ((m2 - m1)p-1 mod q) * p m=cd mod n å¾—åˆ° m â‰¡ (((m2 - m1) _ p-1 mod q) _ p + m1) mod n æ¥ä¸‹æ¥å°±æ˜¯æ±‚è§£ m1ï¼Œm2 m1 â‰¡ cdp+k(p-1) mod p m2 â‰¡ cdq+k(q-1) mod q æ ¹æ®è´¹é©¬å°å®šç† è‹¥ p æ˜¯ç´ æ•°ï¼Œåˆ™ a(p-1) â‰¡ 1 mod p å› æ­¤ m1 â‰¡ cdp mod pï¼Œm2 â‰¡ cdq mod q æœ€ç»ˆå¯æ±‚å¾— m Â¶EXP &lt;!â€“codeï¿¼2â€“&gt; Â¶åªç»™å®š dp dp â‰¡ d mod (p-1) ed â‰¡ 1 mod (p-1) * (q-1) ed = 1 + k2(p-1)(q-1) å¯¹ 1 å¼ä¸¤ç«¯åŒä¹˜ eï¼Œå¾— e * dp â‰¡ ed mod (p-1) e * dp = k1(p-1) + ed ä»£å…¥ ed å¾— e * dp = k1(p-1) + 1 + k2(p-1)(q-1) ç”±äºä¸¤ä¸ªæœªçŸ¥æ•°ç•¥æ˜¾éº»çƒ¦ï¼Œå‘ç°å…¬å› å­(p-1)ï¼Œç­‰å¼ä¸¤è¾¹åŒæ—¶å–ä½™ p-1ï¼Œå³å¯æ¶ˆæ‰ n e * dp â‰¡ 1 mod (p-1) e * dp =k(p-1) + 1 å¾—åˆ°è¿™ä¸ªå¼å­åï¼Œå…¶å®çœŸæ­£æ„ä¹‰ä¸Šçš„æœªçŸ¥æ•°åªæœ‰æˆ‘ä»¬è¦æ±‚çš„ pï¼Œä½†æ˜¯è¿˜å­˜åœ¨ä¸€ä¸ª kã€‚ é’ˆå¯¹ kï¼Œæˆ‘ä»¬åˆ¤æ–­ä¸€ä¸‹ä»–çš„èŒƒå›´ï¼Œçœ‹çœ‹èƒ½å¦é‡‡ç”¨çˆ†ç ´çš„æ–¹å¼ã€‚ k = (e * dp - 1)/(p-1) å› ä¸º dp &lt; p-1 æ‰€ä»¥ k &lt; e é€šè¿‡éå† k ç„¶åæ‰¾åˆ°(e * dp - 1)å¯ä»¥æ•´é™¤ k çš„æƒ…å†µå³å¯ã€‚ (è·‘äº†ä¸€ä¸‹å‘ç°é™åˆ¶æ¡ä»¶è¿˜ä¸å¤Ÿ) å› æ­¤å†åŠ ä¸€ä¸ª n èƒ½å¦æ•´é™¤ p å³å¯ã€‚ Â¶EXP &lt;!â€“codeï¿¼3â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[]},{"title":"2022DASCTF_NOV-lllcccggg-wp","slug":"2022DASCTF_NOV-lllcccgggwp","date":"2022-11-30T02:05:45.000Z","updated":"2022-12-01T09:42:22.869Z","comments":true,"path":"2022/11/30/2022DASCTF_NOV-lllcccgggwp/","link":"","permalink":"https://sch01ar.github.io/2022/11/30/2022DASCTF_NOV-lllcccgggwp/","excerpt":"","text":"é¢˜ç›®æè¿° å¦‚é¢˜ç›®åå­—ä¸€æ ·ï¼Œæœ‰å¥½å¤šä¸ªlcgï¼Œå½“æ—¶çœ‹æ™•äº† &lt;!â€“codeï¿¼0â€“&gt; é¢˜ç›®åˆ†æ 1.keyæ˜¯ä¸€ä¸ªèƒŒåŒ…é—®é¢˜ï¼Œå·²çŸ¥å…¬é’¥mï¼Œå’Œçš„è¯ç›®å‰ä¸çŸ¥é“ã€‚ 2.ä»¥1ä¸­çš„å’Œä¸ºseedï¼Œé€šè¿‡LCGäº§ç”Ÿäº†ä¸€ç»„åºåˆ—outputã€‚ è‡³æ­¤ï¼Œå·²ç»å¯ä»¥æ ¹æ®outputæ¥æ±‚å‡ºLCGä¸­çš„aã€bã€nï¼Œä»è€Œæ±‚å‡ºseedï¼Œä»è€Œé€šè¿‡èƒŒåŒ…å¯æ±‚å¾—keyã€‚ 3.ä»¥keyä¸ºseedï¼Œç§°ä½œstateï¼Œå†è¿›è¡ŒLCGï¼Œstate = (a * state + b) % cï¼Œå¹¶ä¸”aï¼Œbï¼Œcå·²çŸ¥ã€‚ ä½†æ˜¯æƒ³è¦ç›´æ¥æ­£å‘æ±‚è§£å‡ºæœ€åçš„stateï¼Œååˆ†å›°éš¾ï¼Œforå¾ªç¯äº†10^10000æ¬¡ï¼Œè¿™é‡Œæ¶‰åŠåˆ°äº†çŸ©é˜µå¿«é€Ÿå¹‚çš„ä½¿ç”¨ã€‚ é€šè¿‡æ„é€ çŸ©é˜µ $$ \\mathbf{A} = \\begin{bmatrix} state &amp; 1 \\end{bmatrix} $$ $$ \\mathbf{C} = \\begin{bmatrix} a &amp; 0\\ b &amp; 1\\ \\end{bmatrix} $$ é€šè¿‡è®¡ç®—$AC^{1010000}$å³å¯å¾—åˆ°çŸ©é˜µBï¼ŒB = [ state, 1] 4.æ±‚å‡ºstateåè¿›è¡Œå¼‚æˆ–è§£å¯†å³å¯ã€‚ EXP &lt;!â€“codeï¿¼1â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"wp","slug":"wp","permalink":"https://sch01ar.github.io/tags/wp/"}]},{"title":"èƒŒåŒ…åŠ å¯†ç®—æ³•","slug":"èƒŒåŒ…é—®é¢˜ç®—æ³•","date":"2022-11-28T16:00:00.000Z","updated":"2022-12-01T09:50:05.003Z","comments":true,"path":"2022/11/29/èƒŒåŒ…é—®é¢˜ç®—æ³•/","link":"","permalink":"https://sch01ar.github.io/2022/11/29/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98%E7%AE%97%E6%B3%95/","excerpt":"","text":"Â¶å‰è¨€ åœ¨ä¸€æ¬¡CTFæ¯”èµ›ä¸­é‡åˆ°äº†ï¼Œå†™äº†10ä¸ªforåµŒå¥—ç¡¬çˆ†å‡ºæ¥äº†ï¼Œå¤ç°çš„æ—¶å€™å‘ç°æ˜¯èƒŒåŒ…åŠ å¯†ã€‚ Â¶Merkleâ€“Hellman å…¬é’¥åŠ å¯†ç®—æ³• æ•´ä½“åŠ å¯†æµç¨‹ &lt;!â€“codeï¿¼0â€“&gt; å¯ä»¥å‘ç°ï¼ŒåŠ å¯†ååˆ†å®¹æ˜“ï¼Œä½†è§£å¯†ååˆ†å›°éš¾ï¼Œè¿™ä¹Ÿæ˜¯éå¯¹ç§°åŠ å¯†çš„ç‰¹ç‚¹ã€‚ Â¶åŠ å¯† Â¶ç”Ÿæˆç§é’¥ è¶…é€’å¢åºåˆ—ï¼Œä¹Ÿå°±æ˜¯aä¸­æ¯ä¸€ä½å…ƒç´ éœ€è¦å¤§äºå…¶ä¹‹å‰æ‰€æœ‰å…ƒç´ çš„å’Œã€‚ &lt;!â€“codeï¿¼1â€“&gt; Â¶ç”Ÿæˆå…¬é’¥ æ¨¡æ•°mè¦æ±‚ï¼šm &gt; sum(a) ä¹˜æ•°wè¦æ±‚ï¼šgcd(w,m) == 1 &lt;!â€“codeï¿¼2â€“&gt; bå’Œmä½œä¸ºå…¬é’¥ã€‚ åŠ å¯†ï¼šS = numpy.dot(x,b) Â¶è§£å¯† æ‹¿åˆ°å…¬é’¥$M=(m_1,m_2,\\ldots,m_n)$ï¼Œæ„é€ å¦‚ä¸‹çŸ©é˜µ $$ \\begin{bmatrix} 2 &amp; 0 &amp; \\ldots &amp; 0 &amp; m_1 \\ 0 &amp; 2 &amp; \\ldots &amp; 0 &amp; m_2 \\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots &amp; \\vdots \\ 0 &amp; 0 &amp; \\ldots &amp; 2 &amp; m_n \\ 1 &amp; 1 &amp; \\ldots &amp; 1 &amp; S \\ \\end{bmatrix} $$ è¿™ä¸ªçŸ©é˜µçš„æ‰€æœ‰è¡Œå‘é‡çš„çº¿æ€§ç»„åˆæ„æˆäº†ä¸€ä¸ªæ ¼ï¼Œæ¥ä¸‹æ¥å°†é€šè¿‡æ˜æ–‡çš„ç‰¹ç‚¹å’Œæ ¼ä¸Šçš„ç‰¹æ®Šè§£æ³•æ¥è¿›è¡Œè§£å¯†ã€‚ Â¶LLL å¯¹äºæ˜æ–‡$X=(x_1,x_2,\\ldots,x_n)$è¿™ä¸€ç»„æ•°æ¥è¯´ï¼Œæ„é€ ä¸€ä¸ªå‘é‡ $$ a=\\sum_{i=1}^nx_iv_i-v_{n+1}=(2x_1-1,2x_2-1,\\ldots,2x_n-1,0) $$ æ˜¾ç„¶ï¼Œaå‘é‡åœ¨æ ¼Lä¸Šã€‚å› ä¸ºXä¸­çš„æ‰€æœ‰xåªèƒ½å–å€¼0æˆ–1ï¼Œå› æ­¤aå‘é‡çš„é•¿åº¦å¾ˆå°ï¼Œçº¦ä¸º$\\sqrt{n}$ï¼Œå¯¹äºå¾ˆå¤§çš„æ ¼åŸºæ¥è¯´ï¼Œaå‘é‡æ— ç–‘æ˜¯æ ¼Lä¸Šçš„æœ€å°å‘é‡ï¼Œå› æ­¤æˆ‘ä»¬åˆ©ç”¨LLLç®—æ³•å³å¯æ±‚å‡ºaå‘é‡ã€‚ Â¶ä¾‹é¢˜ &lt;!â€“codeï¿¼3â€“&gt; è¿™é‡Œæ³¨æ„ä¸€ä¸‹ï¼Œç¬¬ä¸€è¡Œå‘é‡ä¸­æ˜¯æœ‰+1ä¸-1ï¼Œéœ€è¦è¿›è¡Œå–åï¼Œå³-1ä»£è¡¨1ï¼Œ1ä»£è¡¨0ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"éå¯¹ç§°åŠ å¯†","slug":"éå¯¹ç§°åŠ å¯†","permalink":"https://sch01ar.github.io/tags/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/"}]},{"title":"Hitcon 2022-ãŠ™ï¸BabySSS","slug":"hitcon2022-BabySSS","date":"2022-11-27T16:00:00.000Z","updated":"2022-12-01T09:37:56.735Z","comments":true,"path":"2022/11/28/hitcon2022-BabySSS/","link":"","permalink":"https://sch01ar.github.io/2022/11/28/hitcon2022-BabySSS/","excerpt":"","text":"I implemented a toy Shamirâ€™s Secret Sharing for fun. Can you help me check is there any issues with this? Shamirâ€™s Secret Sharingå¯†é’¥åˆ†äº«ç®—æ³• $$f(x)=a_0 + a_1x + a_2x^2 + â€¦â€¦ + a_{k-1} x^{k-1} mod p $$ é¢˜ç›®æºç  &lt;!â€“codeï¿¼0â€“&gt; é¢˜ç›®åˆ†æ é¢˜ç›®ç»™äº†8ç»„xï¼Œyçš„å€¼ï¼Œå¯é€šè¿‡CRTæ¨¡xæ±‚å‡ºa_0 ï¼Œé€šè¿‡æ¨¡x^2 å¯æ±‚å‡ºa_1 ï¼ŒåŒç†å¯æ±‚å‡ºæ‰€æœ‰ç³»æ•°ï¼Œæ¢å¤å‡ºpolyevalå‡½æ•°ï¼Œä»è€Œå¾—åˆ°æ­£ç¡®çš„secretã€‚ EXP &lt;!â€“codeï¿¼1â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"wp","slug":"wp","permalink":"https://sch01ar.github.io/tags/wp/"}]},{"title":"Gaussæ ¼åŸºçº¦ç®€ç®—æ³•","slug":"Gaussæ ¼åŸºçº¦ç®€ç®—æ³•","date":"2022-11-23T16:00:00.000Z","updated":"2022-12-07T09:39:00.075Z","comments":true,"path":"2022/11/24/Gaussæ ¼åŸºçº¦ç®€ç®—æ³•/","link":"","permalink":"https://sch01ar.github.io/2022/11/24/Gauss%E6%A0%BC%E5%9F%BA%E7%BA%A6%E7%AE%80%E7%AE%97%E6%B3%95/","excerpt":"","text":"ç”±Gaussæå‡ºçš„äºŒç»´æ ¼åŸºçº¦åŒ–ç®—æ³• ç®—æ³•ä¼ªä»£ç  å³å¯¹ç»™å®šçš„ä¸¤ä¸ªåŸºå‘é‡è¿›è¡Œä¸æ–­çš„ç›¸äº’çº¦åŒ–ï¼Œæœ€ç»ˆæ±‚å¾—æ ¼ä¸Šçš„æœ€å°å‘é‡ Loop (a) If ||v2|| &lt; ||v1||, swap v1, v2 (b) Compute m = âŒŠ v1âˆ™v2 / v1âˆ™v1 âŒ‰ Â© If m = 0, return v1, v2 (d) v2 = v2 - m*v1 Continue Loop ä»£ç å®ç° &lt;!â€“codeï¿¼0â€“&gt; ä¾‹é¢˜ &lt;!â€“codeï¿¼1â€“&gt; Â¶æ€è·¯ ç»™å®šå…¬é’¥qã€hï¼Œä»¥åŠæ˜æ–‡e è¦æ±‚ç§é’¥fã€g ä»–ä»¬ä¹‹é—´æœ‰å¦‚ä¸‹å…³ç³»ï¼š fh â‰¡ g mod q å³ kq + g =fh g = fh -kq æ ¹æ®è¿™ä¸€ç‰¹ç‚¹å³å¯æ„é€ æ ¼ï¼Œä¹Ÿå°±æ˜¯æ ¼å¯†ç ä¸­å¾ˆç»å…¸çš„ï¼Œé‡åˆ°ä¸€ä¸ªå‘é‡ä¹˜çŸ©é˜µï¼Œå³å¯è¿›è¡Œæ„é€  ç”±äºå­˜åœ¨ä¸€ç»„aã€bï¼Œä½¿å¾—aï¼ˆ1ï¼Œhï¼‰+ bï¼ˆ0ï¼Œqï¼‰=ï¼ˆfï¼Œgï¼‰$a(1,h) + b(0,q) = (f,g)$ a = fï¼Œb = k é€‰å–ä¸€ç»„åŸºåº•ä¸ºï¼ˆ1ï¼Œhï¼‰å’Œï¼ˆ0ï¼Œqï¼‰ï¼Œä¹Ÿå°±æ˜¯ä¸Šè¿°é«˜æ–¯çº¦ç®€ç®—æ³•å½“ä¸­çš„v1ä¸v2ï¼Œæ±‚å‡ºv1ä¸v2æ ¼ä¸Šæœ€å°çš„å‘é‡ï¼Œå³ä¸ºï¼ˆfï¼Œgï¼‰ Â¶EXP &lt;!â€“codeï¿¼2â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"lattice","slug":"lattice","permalink":"https://sch01ar.github.io/tags/lattice/"}]},{"title":"äºŒå‰æ ‘å»ºç«‹ä¸éå†","slug":"äºŒå‰æ ‘å»ºç«‹ä¸éå†","date":"2022-11-09T16:00:00.000Z","updated":"2022-12-01T05:15:01.487Z","comments":true,"path":"2022/11/10/äºŒå‰æ ‘å»ºç«‹ä¸éå†/","link":"","permalink":"https://sch01ar.github.io/2022/11/10/%E4%BA%8C%E5%8F%89%E6%A0%91%E5%BB%BA%E7%AB%8B%E4%B8%8E%E9%81%8D%E5%8E%86/","excerpt":"","text":"ç½‘ä¸Šå¾ˆå¤šç®—æ³•é€šè¿‡ç›´æ¥å°†äºŒå‰æ ‘ç»“ç‚¹è¿æ¥ï¼Œä»è€Œæ„æˆäºŒå‰æ ‘ï¼Œè¿™é‡Œæˆ‘æ„å»ºäº†ä¸€ä¸ªäºŒå‰æ ‘ç±»ï¼Œé€šè¿‡ç”¨æˆ·æ§åˆ¶è¾“å…¥æ¥å»ºç«‹äºŒå‰æ ‘ã€‚ æœ‰å±‚åºéå†ï¼Œé€’å½’ã€éé€’å½’çš„å‰åºéå†ã€ä¸­åºéå†ã€ååºéå†ç®—æ³•ã€‚ &lt;!â€“codeï¿¼0â€“&gt;","categories":[{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://sch01ar.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"}],"tags":[{"name":"äºŒå‰æ ‘","slug":"äºŒå‰æ ‘","permalink":"https://sch01ar.github.io/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/"}]},{"title":"2022ç¥¥äº‘æ¯wp-crypto","slug":"2022-10-30-2022ç¥¥äº‘æ¯wp-crypto","date":"2022-10-29T16:00:00.000Z","updated":"2022-12-07T09:43:16.370Z","comments":true,"path":"2022/10/30/2022-10-30-2022ç¥¥äº‘æ¯wp-crypto/","link":"","permalink":"https://sch01ar.github.io/2022/10/30/2022-10-30-2022%E7%A5%A5%E4%BA%91%E6%9D%AFwp-crypto/","excerpt":"","text":"little little fermat Â¶é¢˜ç›®æºç  &lt;!â€“codeï¿¼0â€“&gt; Â¶é¢˜ç›®åˆ†æ æ ¹æ®é¢˜ç›®åå­—æ¥çœ‹ï¼Œæ­¤é¢˜å’Œè´¹é©¬å°å®šç†çš„ä½¿ç”¨æœ‰å…³ï¼Œé¢˜ç›®ä¸­æœ‰ä¸€ä¸ª obfuscateå‡½æ•°ï¼Œè¿›è¡Œäº†å¯¹qçš„ç”Ÿæˆï¼Œq=p+Aï¼Œè¿™é‡Œå¯ä»¥çœ‹ä¸€ä¸‹Açš„èŒƒå›´ï¼Œæ˜¯åœ¨2[18,319]ä¹‹é—´ï¼Œå› æ­¤pã€qæ¥è¿‘ï¼Œå°è¯•ä¸€ä¸‹yafuåˆ†è§£ã€‚ é¢˜ç›®å¯¹må…ˆè¿›è¡Œäº†å¤„ç†ï¼Œå†è¿›è¡ŒRSAåŠ å¯†ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦çŸ¥é“xã€‚assert 114514 ** x % p == 1è¿ç”¨è´¹é©¬å°å®šç†ï¼Œè‹¥114514ä¸päº’ç´ ï¼Œåˆ™x=p-1ï¼Œå³å¯æ±‚è§£mã€‚ Â¶EXP &lt;!â€“codeï¿¼1â€“&gt; fill Â¶é¢˜ç›®æºç  &lt;!â€“codeï¿¼2â€“&gt; Â¶é¢˜ç›®åˆ†æ éšæœºäº§ç”Ÿ32ä½çš„æ•°ï¼Œsha256()åŠ å¯†åä½œä¸ºflagï¼Œå¹¶å°†å…¶2è¿›åˆ¶çš„æ¯ä¸€ä½å­˜åˆ°äº†f_listæ•°ç»„ä¸­ã€‚ åˆ åˆ›å»ºäº†ä¸€ä¸ªr_list32ä½æ•°ç»„ï¼Œé‡Œé¢å­˜ç€éšæœºæ•°ï¼Œå…ˆæš‚æ—¶ä¸ç®¡ã€‚ åŒ å¯¹r_listæ•°ç»„ä¸­çš„éšæœºæ•°åšäº†åŠ å¯†ï¼Œäº§ç”Ÿäº†Mæ•°ç»„ã€‚ å¯¹f_listå’ŒMæ•°ç»„è¿›è¡Œäº†numpy.dotè¿ç®—ï¼Œå³å‘é‡ä¹˜æ³•ï¼Œå¾—åˆ°å’Œä¸ºSã€‚ å’ åˆ›å»ºäº†ä¸€ä¸ªsæ•°ç»„ï¼Œè¿™ä¸ªå¾ˆæ˜æ˜¾ï¼Œç”¨LCGçº¿æ€§åŒä½™ç®—æ³•è¿›è¡Œäº†åŠ å¯†ã€‚ æœ€åå°†Mæ•°ç»„ä¸sæ•°ç»„ç›¸åŠ ã€‚ è¿™å°±æ˜¯è¿™é“é¢˜æ•´ä½“çš„æµç¨‹ï¼Œæ¯ä¸€æ­¥å¹¶ä¸éš¾ï¼Œåªæ˜¯æ­¥éª¤å¤šï¼Œç•¥æ˜¾å¤æ‚ã€‚ Â¶EXP Â¶0x01 å¯ä»¥å…ˆè¿›è¡Œä¸€ä¸‹LCGçš„æ±‚è§£ï¼ŒæŠŠsæ•°ç»„æ±‚è§£å‡ºæ¥ï¼Œä»è€Œæ±‚å‡ºMæ•°ç»„ã€‚ &lt;!â€“codeï¿¼3â€“&gt; Â¶0x02 æŒ‰ç†æ¥è¯´ï¼Œæ„Ÿè§‰åº”è¯¥æ ¹æ®æ±‚å‡ºæ¥çš„Mæ•°ç»„è¿›è¡Œé€†è¿ç®—ï¼Œæ±‚å‡ºr_listæ•°ç»„ï¼Œä½†æ˜¯æ±‚å‡ºæ¥r_listæœ‰ä»€ä¹ˆç”¨å‘¢ï¼Œæ‰€ä»¥ç›´æ¥å°è¯•æ±‚f_listã€‚å› ä¸ºf_listä¸­ä¸æ˜¯0å°±æ˜¯1ï¼Œä¸Måšå‘é‡ä¹˜æ³•ï¼Œå³ä¸ºMæ•°ç»„ä¸­è‹¥å¹²å…ƒç´ çš„å’Œã€‚æ ¹æ®é¢˜ç›®ç»™å®šå’ŒSï¼Œå…ˆå¤§æ¦‚çœ‹ä¸€ä¸‹éœ€è¦Mä¸­å¤šå°‘ä¸ªå…ƒç´ ç´¯åŠ ã€‚å‘ç°åœ¨Må‰21ä½å’Œ &lt; Sï¼Œå‰22ä½å’Œ &gt; Sï¼Œæ‰€ä»¥çŒœæƒ³åº”è¯¥æ˜¯Må½“ä¸­ï¼Œé™¤10ä¸ªå·¦å³å…ƒç´ ä¹‹å¤–çš„å’Œã€‚ è¿™é‡Œå°±éå†äº†ä¸€ä¸‹ï¼Œå¤æ‚åº¦å®åœ¨å¤ªé«˜äº†ï¼Œä¹Ÿæ²¡æƒ³ç€èƒ½å‡ºï¼Œç»“æœè¿˜çœŸç®—å‡ºæ¥äº†o.O &lt;!â€“codeï¿¼4â€“&gt; ä¹Ÿå°±è¯´æ˜ï¼Œf_listä¸­ä¸‹æ ‡ä¸ºè¿™äº›çš„ï¼Œå¯¹åº”å€¼æ˜¯0ï¼Œå…¶ä½™ä¸º1ï¼Œå³å¯å¾—åˆ°msgçš„2è¿›åˆ¶æ•°ï¼Œè½¬ä¸ºåè¿›åˆ¶åè¿›è¡Œsha256()åŠ å¯†å³å¯ã€‚ &lt;!â€“codeï¿¼5â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"wp","slug":"wp","permalink":"https://sch01ar.github.io/tags/wp/"}]},{"title":"2022NewStarCTF-flip_flop","slug":"2022NewStarCTF-flip_flop","date":"2022-10-26T16:00:00.000Z","updated":"2022-12-07T09:41:52.644Z","comments":true,"path":"2022/10/27/2022NewStarCTF-flip_flop/","link":"","permalink":"https://sch01ar.github.io/2022/10/27/2022NewStarCTF-flip_flop/","excerpt":"","text":"flip-flop AES-CBCåŠ å¯†æ¨¡å¼ Â¶é¢˜ç›® æºç å¦‚ä¸‹ï¼š &lt;!â€“codeï¿¼0â€“&gt; Â¶é¢˜ç›®åˆ†æ æ­¤é¢˜æ˜¯é€šè¿‡æ³¨å†Œå¾—åˆ°çš„ç”¨æˆ·è´¦æˆ·çš„å¯†æ–‡ï¼Œç„¶åè¾“å…¥ç®¡ç†å‘˜è´¦æˆ·å¯¹åº”çš„å¯†æ–‡ï¼Œæ‰èƒ½å¾—åˆ°flagã€‚ å¯¹ç”¨æˆ·è´¦æˆ·å’Œç®¡ç†å‘˜è´¦æˆ·çš„åŠ å¯†è§£å¯†å‡é‡‡ç”¨AES-CBCæ¨¡å¼ï¼Œä½†æ˜¯æœ¬é¢˜ä»…æœ‰ä¸€ç»„æ˜æ–‡ï¼Œivä»…ä½œä¸ºåç§»é‡ï¼Œä¹Ÿå°±æ˜¯æœ¬é¢˜ä¸­çš„user_keyã€‚ è¿™é‡Œå…ˆæ¥è¯´ä¸€ä¸‹æˆ‘æœ€ä¸€å¼€å§‹çš„æ€è·¯ï¼Œç”±äºuser_keyæ¯æ¬¡æ˜¯éšæœºäº§ç”Ÿçš„ï¼Œä½†æ˜¯ä¸€æ¬¡ç¨‹åºçš„è¿è¡Œå½“ä¸­æ˜¯ä¸å˜çš„ã€‚ç”±äºå¯†æ–‡ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œå‰åŠéƒ¨åˆ†ä¸ºuser_key.hex()ï¼ŒååŠéƒ¨åˆ†ä¸ºcode.hex()ï¼Œæ‰€ä»¥åªè¦æ„é€ å‡ºadminå¯¹åº”çš„codeå³å¯ï¼Œé‚£ä¹ˆå°±éœ€è¦AESåŠ å¯†å½“ä¸­çš„keyï¼Œæ‰€ä»¥å°±éœ€è¦æ„é€ ä¸€ä¸ªkeyæ¥äº§ç”Ÿå‡ºadminå¯¹åº”çš„codeã€‚æŸ¥è¯¢äº†å¾ˆå¤šèµ„æ–™å‘ç°éƒ½éš¾ä»¥å®ç°ã€‚äºæ˜¯â€¦â€¦ é‚£ä¸ºä»€ä¹ˆä¸æ¢ä¸€ä¸‹æ€è·¯ï¼Ÿä¸èƒ½æ„é€ codeï¼Œèƒ½ä¸èƒ½æ„é€ ivï¼Ÿ å…ˆæ¥çœ‹ä¸€ä¸‹åŠ å¯†æ–¹å¼ï¼š C = encrypt(M ^ iv) M = decryptÂ©^iv å¯¹åº”ä¸€ä¸‹æœ¬é¢˜å½“ä¸­çš„NewStarCTFerå’Œadminï¼š b'NewStarCTFer____' = decrypt(code) ^ iv1 b'AdminAdmin______' = decrypt(code) ^ iv2 å› æ­¤å¯æ±‚å‡ºadminå¯¹åº”çš„iv2ï¼Œéšåæ‹¼æ¥ä¸Šæ™®é€šç”¨æˆ·çš„ååŠæ®µcodeå³å¯ã€‚ Â¶EXP &lt;!â€“codeï¿¼1â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"wp","slug":"wp","permalink":"https://sch01ar.github.io/tags/wp/"}]},{"title":"BUUåˆ·é¢˜æ—¥è®°20221026","slug":"BUUåˆ·é¢˜æ—¥è®°20221026","date":"2022-10-25T16:00:00.000Z","updated":"2022-12-07T09:39:19.641Z","comments":true,"path":"2022/10/26/BUUåˆ·é¢˜æ—¥è®°20221026/","link":"","permalink":"https://sch01ar.github.io/2022/10/26/BUU%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B020221026/","excerpt":"","text":"RSA5 Â¶é¢˜ç›®åˆ†æ ç»™å®še=65537 ç»™äº†å¾ˆå¤šç»„nã€c ç”±äºeè¿‡å¤§ï¼Œæ‰€ä»¥ä¸è€ƒè™‘ä½¿ç”¨CRTï¼Œç”±äºmæ˜¯åŒä¸€ä¸ªï¼Œå› æ­¤éå†ä¸€ä¸‹ï¼Œæ±‚å‡ºä¸¤ä¸ªnçš„æœ€å¤§å…¬çº¦æ•°ï¼Œå³ä¸ºpï¼Œåç»­å°±ç®€å•äº†ã€‚ Â¶EXP &lt;!â€“codeï¿¼0â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"diary","slug":"diary","permalink":"https://sch01ar.github.io/tags/diary/"}]},{"title":"2022 DASCTF 10æœˆæŒ‘æˆ˜èµ›wp","slug":"2022DASCTF10æœˆæŒ‘æˆ˜èµ›wp","date":"2022-10-22T16:00:00.000Z","updated":"2022-12-07T09:42:51.960Z","comments":true,"path":"2022/10/23/2022DASCTF10æœˆæŒ‘æˆ˜èµ›wp/","link":"","permalink":"https://sch01ar.github.io/2022/10/23/2022DASCTF10%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9Bwp/","excerpt":"","text":"RSA Â¶é¢˜ç›®å¦‚ä¸‹ &lt;!â€“codeï¿¼0â€“&gt; Â¶é¢˜ç›®åˆ†æ è¯¥é¢˜çš„åŠ å¯†é¡ºåºæ˜¯ï¼š 1ã€åŠ å¯†flagï¼Œåˆ†ä¸ºä¸¤éƒ¨åˆ†m1ã€m2 2ã€åŠ å¯†m1 3ã€åŠ å¯†m2 åŒç†æˆ‘ä»¬è§£å¯†çš„é¡ºåºåº”è¯¥ä¹Ÿæ˜¯ 1ã€è§£å‡ºm1ã€m2 2ã€è§£å‡ºflag Â¶æ±‚m2 å…ˆè§‚å¯Ÿä¸€ä¸‹encrypt4å‡½æ•° è™½ç„¶è¯´e_2=3ï¼ŒæŒ‰ç†æ¥è¯´ä½¿ç”¨ä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼Œä½†å¹¶ä¸å¯è¡Œã€‚ åˆå› ä¸ºm = m % k å¯é€šè¿‡è¿™ç‚¹å’Œc_3 = pow(m, e_2, n_3)åšéå†æ±‚å‡ºm æœ€åå‘ç°må³ä¸ºm2ï¼Œm2 &lt; k Â¶æ±‚m1 å‘ç°m1åŠ å¯†æ–¹å¼é‡‡ç”¨RSAï¼Œä½†æ˜¯n_1æœªçŸ¥ n_1åˆé€šè¿‡ä¸€æ¬¡RSAåŠ å¯†ï¼Œå·²çŸ¥n_1å¯¹åº”çš„å¯†æ–‡ åˆ©ç”¨ä½åŠ å¯†æŒ‡æ•°æ”»å‡»è§£å‡ºn1 å‘ç°n1å¯åˆ†è§£ä¸º3ä¸ªç´ æ•°ä¹˜ç§¯ æ•…phiå¯æ±‚ï¼Œå³æ±‚å‡ºm1 Â¶æ±‚flag è§‚å¯Ÿencryt1 m1æ˜¯flagå³ç§»200ä½ä¹‹åè½¬ä¸ºå­—èŠ‚ m2æ˜¯flagçš„20ä½ä¹‹åè½¬æˆå­—èŠ‚ æ‰€ä»¥æ¥è¯´m2æ˜¯æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä¸»è¦æ‰¾åˆ°flagçš„å‰20ä½ï¼Œå†æŠŠm2æ‹¼åˆ°åé¢å³å¯ã€‚ ç”±äºm1æ˜¯flagå³ç§»200ä½ï¼Œå› æ­¤flagçš„ä½ä½ç¼ºå¤±ï¼Œä½†é«˜ä½è¿˜åœ¨ï¼Œç”±äºä¸çŸ¥é“flagæ€»é•¿åº¦ï¼ŒæŠ±ç€è¯•ä¸€è¯•çš„å¿ƒæ€ï¼ŒçŒœæµ‹ä¸€ä¸‹å®ƒçš„é«˜ä½å‰20ä½æ²¡æœ‰ç¼ºå¤± æˆ‘ä»¬å°†m1å’Œm2è½¬ä¸ºå­—èŠ‚å‘ç° m1:bâ€™0x666c61677b3230366538353964â€™ m2:bâ€™383539643865383534633466363030636231323735376262663966357dâ€™ å‘ç°m1å’Œm2æœ‰é‡å éƒ¨åˆ†ï¼Œå³38353å¼€å§‹ å¯ä»¥è¯å®m1å‰20ä½ç¡®å®æ²¡æœ‰ç¼ºå¤± å› æ­¤å–m1å‰20ä½ï¼ŒåŠ m2ï¼Œå³å¯è§£å‡ºflag Â¶EXP &lt;!â€“codeï¿¼1â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"wp","slug":"wp","permalink":"https://sch01ar.github.io/tags/wp/"}]},{"title":"BUUåˆ·é¢˜æ—¥è®°20221022","slug":"BUUåˆ·é¢˜æ—¥è®°20221022","date":"2022-10-21T16:00:00.000Z","updated":"2022-12-07T09:40:10.592Z","comments":true,"path":"2022/10/22/BUUåˆ·é¢˜æ—¥è®°20221022/","link":"","permalink":"https://sch01ar.github.io/2022/10/22/BUU%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B020221022/","excerpt":"","text":"RSA4 é¢˜ç›®åªç»™äº†ä¸‰ç»„nã€cï¼Œé‡‡ç”¨ä¸­å›½å‰©ä½™å®šç†ï¼Œå…·ä½“æ¨å¯¼å¦‚ä¸‹ Â¶æ¨å¯¼è¿‡ç¨‹ me â‰¡ c1 mod n1 me â‰¡ c2 mod n2 me â‰¡ c3 mod n3 Â¶ä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰ ä¸­å›½å‰©ä½™å®šç†çš„å†…å®¹æ˜¯ï¼š é’ˆå¯¹ä¸Šè¿°æ–¹ç¨‹ç»„ï¼Œè‹¥n1ã€n2ã€n3äº’è´¨ï¼Œå¯¹äºä»»æ„çš„c1ã€c2ã€c3ï¼Œæ–¹ç¨‹ç»„éƒ½æœ‰è§£ï¼Œä½¿ç”¨æ¡ä»¶æ˜¯m^e &lt; n1ã€n2ã€n3ã€‚é€šè§£å½¢å¼å¦‚ä¸‹ï¼š ä»¤N = n1 * n2 * n3ï¼ŒN1 = N/n1ï¼ŒN2ã€N3åŒç† ä»¤t1 = N1(-1)ï¼Œå³å…¶å¯¹åº”çš„æ¨¡n1è¿ç®—çš„é€†å…ƒï¼Œt2ï¼Œt3åŒç†ï¼Œå¯ç”¨t1=gmpy2.invert(N1,n1)è¡¨ç¤ºã€‚ æœ‰äº†Niå’Œtiçš„å®šä¹‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»™å‡ºé€šè§£å½¢å¼ï¼š x = c1 * N1 * t1 â€¦â€¦ æœ‰äº†é€šè§£å…¬å¼æˆ‘ä»¬å°±å¯ä»¥æ±‚å‡ºm^eï¼Œå¯¹eè¿›è¡Œä¸€ä¸‹éå†å³å¯ï¼Œmå¼€æ–¹æˆåŠŸå³å¯ã€‚ Â¶EXP &lt;!â€“codeï¿¼0â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"diary","slug":"diary","permalink":"https://sch01ar.github.io/tags/diary/"}]},{"title":"BUUåˆ·é¢˜æ—¥è®°20221021","slug":"BUUåˆ·é¢˜æ—¥è®°20221021","date":"2022-10-20T16:00:00.000Z","updated":"2022-12-08T05:42:21.849Z","comments":true,"path":"2022/10/21/BUUåˆ·é¢˜æ—¥è®°20221021/","link":"","permalink":"https://sch01ar.github.io/2022/10/21/BUU%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B020221021/","excerpt":"","text":"RSA2 é¢˜ç›®ç»™å®šnã€eã€dpã€c éé¢„æœŸè§£ï¼šç›´æ¥åˆ†è§£n ä¸‹é¢è€ƒè™‘nä¸èƒ½åˆ†è§£çš„æƒ…å†µ Â¶æ¨å¯¼è¿‡ç¨‹ dp â‰¡ d mod (p-1) ed â‰¡ 1 mod (p-1) * (q-1) ed = 1 + k2(p-1)(q-1) å¯¹1å¼ä¸¤ç«¯åŒä¹˜eï¼Œå¾— e * dp â‰¡ ed mod (p-1) e * dp = k1(p-1) + ed ä»£å…¥edå¾— e * dp = k1(p-1) + 1 + k2(p-1)(q-1) ç”±äºä¸¤ä¸ªæœªçŸ¥æ•°ç•¥æ˜¾éº»çƒ¦ï¼Œå‘ç°å…¬å› å­(p-1)ï¼Œç­‰å¼ä¸¤è¾¹åŒæ—¶å–ä½™p-1ï¼Œå³å¯æ¶ˆæ‰n e * dp â‰¡ 1 mod (p-1) e * dp =k(p-1) + 1 å¾—åˆ°è¿™ä¸ªå¼å­åï¼Œå…¶å®çœŸæ­£æ„ä¹‰ä¸Šçš„æœªçŸ¥æ•°åªæœ‰æˆ‘ä»¬è¦æ±‚çš„pï¼Œä½†æ˜¯è¿˜å­˜åœ¨ä¸€ä¸ªkã€‚ é’ˆå¯¹kï¼Œæˆ‘ä»¬åˆ¤æ–­ä¸€ä¸‹ä»–çš„èŒƒå›´ï¼Œçœ‹çœ‹èƒ½å¦é‡‡ç”¨çˆ†ç ´çš„æ–¹å¼ã€‚ k = (e * dp - 1)/(p-1) å› ä¸ºdp &lt; p-1 æ‰€ä»¥k &lt; e é€šè¿‡éå†kç„¶åæ‰¾åˆ°(e * dp - 1)å¯ä»¥æ•´é™¤kçš„æƒ…å†µå³å¯ã€‚ (è·‘äº†ä¸€ä¸‹å‘ç°é™åˆ¶æ¡ä»¶è¿˜ä¸å¤Ÿ) å› æ­¤å†åŠ ä¸€ä¸ªnèƒ½å¦æ•´é™¤på³å¯ã€‚ Â¶EXP &lt;!â€“codeï¿¼0â€“&gt; RSA3 ç»™å®šnã€e1ã€c1ã€e2ã€c2ã€‚ m â‰¡ c1^e1 mod n m â‰¡ c2^e2 mod n è¿™é‡Œé‡‡ç”¨å…±æ¨¡æ”»å‡»ï¼Œè¯¦ç»†åŸç†å¦‚ä¸‹ï¼š æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼šç»™å®šä¸¤ä¸ªæ•´æ•°aã€bï¼Œå¿…å®šå­˜åœ¨xã€yï¼Œä½¿å¾—gcd(a,b)=ax+by å¯¹åº”åˆ°æœ¬é¢˜å½“ä¸­ï¼Œç”±äºe1ã€e2äº’ä¸ºç´ æ•°ï¼Œå› æ­¤gcd(e1,e2)=1ï¼Œä»è€Œå­˜åœ¨s1ã€s2ä½¿å¾—: s1 * e1 + s2 * e2 = 1 Â¶æ¨å¯¼è¿‡ç¨‹ m = m % n m = m^(s1 * e1 + s2 * e2)^ % n m = m^(e1 * s1)^ * m^(e2 * s2)^ % n m = (m^(e1 * s1)^ % n) * (m^(e2 * s2)^ % n) % n m = (c1s1 % n) * (c2s2 % n) % n Â¶EXP &lt;!â€“codeï¿¼1â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"diary","slug":"diary","permalink":"https://sch01ar.github.io/tags/diary/"}]},{"title":"BUUåˆ·é¢˜æ—¥è®°20221020","slug":"BUUåˆ·é¢˜æ—¥è®°20221020","date":"2022-10-19T16:00:00.000Z","updated":"2022-12-06T07:25:59.850Z","comments":true,"path":"2022/10/20/BUUåˆ·é¢˜æ—¥è®°20221020/","link":"","permalink":"https://sch01ar.github.io/2022/10/20/BUU%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B020221020/","excerpt":"","text":"RSA1 ç»™å®šdpã€dqç±»å‹ dp â‰¡ d mod (p-1) dq â‰¡ d mod (q-1) m â‰¡ cd mod n m = cd + k * n m = cd +k * p * q å¯¹ä¸Šå¼ä¸¤ç«¯åŒæ—¶å¯¹pã€qåˆ†åˆ«å–ä½™ï¼Œå¾—ï¼šï¼ˆä¸­å›½å‰©ä½™å®šç†ï¼‰ m1 â‰¡ cd mod p m2 â‰¡ cd mod q åŒç†ï¼Œå¯å¾—åˆ° cd = m1 +k * p ä»£å…¥åˆ° m2 â‰¡ cd mod q ä¸­ï¼š m2 â‰¡ (m1 + k * p)mod q ï¼Œä¸¤ç«¯å‡å»m1å¾— m2 - m1 â‰¡ k * p mod q ï¼Œä¸¤ç«¯ä¹˜pçš„é€†å…ƒå¾— (m2 - m1)p-1 â‰¡ k mod q å°†kä»£å…¥åˆ° cd = m1 +k * p ä¸­å¾—ï¼š cd = m1 + ((m2 - m1)p-1 mod q) * p m=cd mod n å¾—åˆ° m â‰¡ (((m2 - m1) * p-1 mod q) * p + m1) mod n æ¥ä¸‹æ¥å°±æ˜¯æ±‚è§£m1ï¼Œm2 m1 â‰¡ cdp+k(p-1) mod p m2 â‰¡ cdq+k(q-1) mod q æ ¹æ®è´¹é©¬å°å®šç† è‹¥pæ˜¯ç´ æ•°ï¼Œåˆ™a(p-1) â‰¡ 1 mod p å› æ­¤ m1 â‰¡ cdp mod pï¼Œm2 â‰¡ cdq mod q æœ€ç»ˆå¯æ±‚å¾—m Â¶exp &lt;!â€“codeï¿¼0â€“&gt; RSAROLL &lt;!â€“codeï¿¼1â€“&gt; ç»™äº†ä¸€ä¸ªdata.txtæ–‡ä»¶ï¼Œæ‰“å¼€ç›²çŒœä¸€ä¸‹ç¬¬ä¸€è¡Œæ˜¯nï¼Œeï¼Œåé¢æ˜¯c &lt;!â€“codeï¿¼2â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"diary","slug":"diary","permalink":"https://sch01ar.github.io/tags/diary/"}]},{"title":"2021ByteCTF-easyxor","slug":"2021ByteCTF-easyxor","date":"2022-10-15T16:00:00.000Z","updated":"2022-12-07T09:34:59.756Z","comments":true,"path":"2022/10/16/2021ByteCTF-easyxor/","link":"","permalink":"https://sch01ar.github.io/2022/10/16/2021ByteCTF-easyxor/","excerpt":"","text":"é¢˜ç›®æºç å¦‚ä¸‹ &lt;!â€“codeï¿¼0â€“&gt; é¢˜ç›®åˆ†æ å°†flagåˆ†ä¸ºä¸¤æ®µï¼Œå‰åŠæ®µé‡‡ç”¨OFBåŠ å¯†ï¼ŒååŠæ®µé‡‡ç”¨CBCåŠ å¯† Â¶OFBè§£å¯† å°†å‰åŠæ®µflagåˆè¿›è¡Œåˆ‡åˆ†ï¼Œå°†å…¶8ä½åˆ†ä¸ºä¸€ç»„ï¼Œå­˜åˆ°groupæ•°ç»„ä¸­ã€‚ &lt;!â€“codeï¿¼1â€“&gt; é’ˆå¯¹ä¸€ä¸ªéšæœºç”Ÿæˆçš„64ä½çš„lastï¼Œä¸keysè¿›è¡ŒconvertåŠ å¯†ï¼Œå†ä¸groupä¸­çš„æ•°è¿›è¡Œå¼‚æˆ–ã€‚ keysæ˜¯å››ä¸ª-32ï½32çš„æ•°ï¼Œå¯çˆ†ç ´ã€‚ å¯¹äºOFBè§£å¯†ååˆ†ç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬å·²çŸ¥ç¬¬ä¸€ç»„æ˜æ–‡ï¼Œæ°å¥½æ˜¯8ä½çš„â€™ByteCTF{'ï¼Œç”±äºåˆ†ç»„å¯†ç çš„æ€§è´¨ï¼Œæ‰€ä»¥åé¢çš„ä¹Ÿå°±è¿åˆƒè€Œè§£ï¼Œé€šè¿‡group[ 0]^cipher[ 0] å³å¯å¾—åˆ°cur_cï¼Œä»è€Œæ±‚å¾—ä¸‹ä¸€æ¬¡çš„cur_cï¼Œä»¥æ­¤ç±»æ¨ã€‚ Â¶expOFB &lt;!â€“codeï¿¼2â€“&gt; Â¶CBCè§£å¯† é’ˆå¯¹ååŠéƒ¨åˆ†ï¼Œæˆ‘ä»¬éœ€è¦é€†å‘è§£å‡ºconvertå‡½æ•°ï¼Œå› æ­¤å°±æ˜¯å¯¹shiftå‡½æ•°ä¸­çš„åŠ å¯†è¿ç®—è¿›è¡Œè§£å¯†ã€‚ ä¹‹å‰ä¸Šç½‘æœçš„wpéƒ½ä¸€ç¬”å¸¦è¿‡ï¼Œæ²¡è§£é‡Šunshifté€†å‡½æ•°æ€ä¹ˆå†™çš„ã€‚â€œéš¾é“æœ‰ä»€ä¹ˆå®šç†ï¼Ÿï¼Ÿâ€ è¿™é‡Œç®€å•å†™ä¸€ä¸‹æˆ‘çš„ç†è§£ã€‚ Â¶åˆ†æshift &lt;!â€“codeï¿¼3â€“&gt; Â¶æ¨ç†è¿‡ç¨‹ è¿™é‡Œæˆ‘ä»¬ä¸¾ä¾‹k&gt;0æ—¶çš„æƒ…å†µã€‚ï¼ˆk&lt;0åŒç†ï¼‰ må’Œcéƒ½æ˜¯64ä½,kæ˜¯-32ï½32çš„10è¿›åˆ¶æ•°ã€‚ 1ã€m &lt;&lt; kç›¸å½“äºåœ¨måè¡¥kä½0ï¼Œå¾—åˆ°çš„æ–°æ•°æˆ‘ä»¬ç§°ä¸ºaï¼Œa=m &lt;&lt; kã€‚ 2ã€ä»¤b = a &amp; cï¼Œç”±äºaæ˜¯64+kä½ï¼Œcæ˜¯64ä½ï¼Œæ‰€ä»¥bæ˜¯64ä½ï¼Œå¹¶ä¸”bçš„åkä½éƒ½æ˜¯0ã€‚ 3ã€ä»¤x = m ^ bï¼Œxåˆ™æ˜¯shiftåŠ å¯†ä¹‹åçš„å€¼ï¼Œxä¹Ÿæ˜¯64ä½ï¼Œå¹¶ä¸”xçš„åkä½æ˜¯ä¸mçš„åkä½ç›¸åŒçš„ï¼Œä¸0å¼‚æˆ–å¾—æœ¬èº«ã€‚ æˆ‘ä»¬èµ°å®Œäº†ä¸€éshiftåŠ å¯†ï¼Œå¾—åˆ°çš„ç»“è®ºæ˜¯ï¼Œå¯†æ–‡çš„ä½æ•°åŒæ ·æ˜¯64ï¼Œå¹¶ä¸”å¯†æ–‡çš„åkä½ä¸æ˜æ–‡ç›¸åŒã€‚ Â¶åˆ†æunshift &lt;!â€“codeï¿¼4â€“&gt; Â¶æ¨ç†è¿‡ç¨‹ åŒæ ·æˆ‘ä»¬ä¸¾ä¾‹k&gt;0çš„æƒ…å†µã€‚ ä¹‹å‰æˆ‘ä»¬å¾—åˆ°çš„å¯†æ–‡xï¼Œç›¸å½“äºtmpã€‚ 1ã€aâ€™=tmp &lt;&lt; kï¼Œtmpåkä½ä¸º0ï¼Œtmpå2kï½kä½ç­‰äºmçš„åkä½ã€‚ 2ã€bâ€™=aâ€™ &amp; cï¼Œbâ€™åkä½ä¸º0ï¼Œå2kï½kä½ä¸ºm&amp;cã€‚ 3ã€y=x ^ bâ€™ï¼Œyçš„åkä½ï¼Œç­‰äºxçš„åkä½ï¼Œä¹Ÿå°±æ˜¯mçš„åkä½ã€‚ 4ã€yçš„å2kï½kä½ï¼Œåœ¨shiftåŠ å¯†å½“ä¸­ï¼Œa &amp; cçš„å2kï½kä½ç­‰äºmçš„åkä½&amp;cï¼Œè®°ä½œm1 &amp; cã€‚ shiftä¸­çš„xï¼Œä¹Ÿå°±æ˜¯m ^ bï¼Œm ^(m1 &amp; c)ï¼Œåœ¨unshiftæœ€åçš„ä¸€æ­¥æ“ä½œä¸­ï¼Œy= m ^(m1 &amp; c) ^ bâ€™ã€‚ è¿™æ—¶æˆ‘ä»¬åªè€ƒè™‘yçš„å2kï½kä½ï¼Œy=m ^(m1 &amp; c)^(m1 &amp; c) = m æ‰€ä»¥è¿™æ—¶yçš„2kï½kä½ä¹Ÿç­‰äºmäº†ã€‚ Â¶æ€»ç»“ å› æ­¤ï¼Œæˆ‘ä»¬å‘ç°æ¯ç»è¿‡unshiftä¸€æ¬¡ï¼Œå°±æœ‰kä½è¢«è¿˜åŸï¼Œä½•æ—¶æ‰èƒ½è¢«å®Œå…¨è¿˜åŸï¼Ÿå³å¾ªç¯bits//kæ¬¡ã€‚ æ­¤æ¨ç†æ­£ç¡®ï¼Œå¯ä»¥åœ¨unshiftå‡½æ•°è¿è¡Œæ—¶è¾“å‡ºæ¯æ¬¡çš„tmpè§‚å¯Ÿå³å¯ã€‚ psï¼šè‡ªæˆ‘æ„Ÿè§‰è¿™ç§ä½è¿ç®—åº”è¯¥æ˜¯å±äºä¸€ç§æ€§è´¨æˆ–è€…å®šç†ï¼Œç½‘ä¸Šå¤§ä½¬ä»¬éƒ½æ˜¯è¯´â€œç®€å•å†™ä¸ªé€†â€ã€‚ã€‚ã€‚ Â¶expCBC &lt;!â€“codeï¿¼5â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"wp","slug":"wp","permalink":"https://sch01ar.github.io/tags/wp/"}]},{"title":"2022BUUCTFæ–°ç”Ÿèµ›-RSA","slug":"2022BUUCTFæ–°ç”Ÿèµ›-RSA","date":"2022-10-15T16:00:00.000Z","updated":"2022-12-08T07:35:16.441Z","comments":true,"path":"2022/10/16/2022BUUCTFæ–°ç”Ÿèµ›-RSA/","link":"","permalink":"https://sch01ar.github.io/2022/10/16/2022BUUCTF%E6%96%B0%E7%94%9F%E8%B5%9B-RSA/","excerpt":"","text":"é¢˜ç›®æºç  &lt;!â€“codeï¿¼0â€“&gt; é¢˜ç›®åˆ†æ å‘ç°nå’Œphinéƒ½ä¸å¸¸è§„ï¼Œæ²¡å…¥æ‰‹ç‚¹ï¼Œå‘ç°hintï¼Œhint=pow(d,e,n)ï¼Œæœ‰è¶£ï¼Œç”¨dåšæ˜æ–‡ï¼Œå°è¯•æ¨ç†ä¸€ä¸‹ï¼š d = pow(hint,d,n) d = pow((d ** e % n),d,n) d = (d ** e % n) ** d % n d = d ** (e*d) % n d = pow(d ** e,d,n) æŠŠd ** eå†æ¬¡çœ‹åšå¯†æ–‡ï¼Œå¯å¾— d ** e = pow(d,e,n) å› ä¸ºhint = pow(d,e,n) å¯å¾—hint = d ** e d ** e * e ** e-&gt;(ed) ** e-&gt;(ed) ** e == 1 mod phin å› æ­¤æ ¹æ®eå’Œhintå³å¯æ±‚å¾—phin ä»è€Œå¾—åˆ°phinå’Œnçš„æœ€å¤§å…¬çº¦æ•°p è„šæœ¬å¦‚ä¸‹ &lt;!â€“codeï¿¼1â€“&gt;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"}],"tags":[{"name":"wp","slug":"wp","permalink":"https://sch01ar.github.io/tags/wp/"}]},{"title":"æ¢¦å¼€å§‹çš„åœ°æ–¹","slug":"æ¢¦å¼€å§‹çš„åœ°æ–¹","date":"2022-10-15T07:59:58.000Z","updated":"2022-12-01T05:15:04.679Z","comments":true,"path":"2022/10/15/æ¢¦å¼€å§‹çš„åœ°æ–¹/","link":"","permalink":"https://sch01ar.github.io/2022/10/15/%E6%A2%A6%E5%BC%80%E5%A7%8B%E7%9A%84%E5%9C%B0%E6%96%B9/","excerpt":"","text":"Â¶Macä¸‹åˆ©ç”¨Hexoå’Œgithub pagesæ­å»ºä¸ªäººåšå®¢ Â¶ç¯å¢ƒé…ç½® Â¶1.Node.jså®‰è£… ä¸‹è½½åœ°å€ï¼šNode.js Â¶2.æ·˜å®é•œåƒå®‰è£… &lt;!â€“codeï¿¼0â€“&gt; Â¶3.å®‰è£…Hexo &lt;!â€“codeï¿¼1â€“&gt; Â¶åˆå§‹åŒ–Hexo Blog Â¶1.åˆå§‹åŒ–Hexo æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å¹¶è¿›å…¥ï¼Œä¾‹å¦‚blog &lt;!â€“codeï¿¼2â€“&gt; Â¶2.æœ¬åœ°å¯åŠ¨Hexo &lt;!â€“codeï¿¼3â€“&gt; æµè§ˆå™¨æ‰“å¼€ç½‘ç«™ï¼Œå³å¯çœ‹åˆ°æœ¬åœ°åšå®¢ Â¶åˆ›å»ºåšå®¢æ–‡ç«  Â¶1.åˆ›å»ºæ–‡ç«  &lt;!â€“codeï¿¼4â€“&gt; åœ¨blogæ–‡ä»¶å¤¹ä¸­çš„_posté‡Œå³å¯çœ‹åˆ°æ–°å»ºçš„mdæ–‡ä»¶ Â¶2.æ¸…ç†ç¼“å­˜é¡¹ç›® åœ¨æ–°å»ºåšå®¢æˆ–ä¿®æ”¹åšå®¢æ—¶ï¼Œéœ€è¦è¿›è¡Œè¯¥æ“ä½œ &lt;!â€“codeï¿¼5â€“&gt; Â¶3.é‡æ–°ç”Ÿæˆåšå®¢ &lt;!â€“codeï¿¼6â€“&gt; Â¶4.å¯åŠ¨åšå®¢ &lt;!â€“codeï¿¼7â€“&gt;","categories":[{"name":"å»ºç«™","slug":"å»ºç«™","permalink":"https://sch01ar.github.io/categories/%E5%BB%BA%E7%AB%99/"}],"tags":[{"name":"åšå®¢æ­å»º","slug":"åšå®¢æ­å»º","permalink":"https://sch01ar.github.io/tags/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"}]},{"title":"Hello World","slug":"hello-world","date":"2022-10-15T07:57:23.442Z","updated":"2022-12-01T05:15:29.274Z","comments":true,"path":"2022/10/15/hello-world/","link":"","permalink":"https://sch01ar.github.io/2022/10/15/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Â¶Quick Start Â¶Create a new post &lt;!â€“codeï¿¼0â€“&gt; More info: Writing Â¶Run server &lt;!â€“codeï¿¼1â€“&gt; More info: Server Â¶Generate static files &lt;!â€“codeï¿¼2â€“&gt; More info: Generating Â¶Deploy to remote sites &lt;!â€“codeï¿¼3â€“&gt; More info: Deployment","categories":[],"tags":[]}],"categories":[{"name":"CTF","slug":"CTF","permalink":"https://sch01ar.github.io/categories/CTF/"},{"name":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","permalink":"https://sch01ar.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"},{"name":"å»ºç«™","slug":"å»ºç«™","permalink":"https://sch01ar.github.io/categories/%E5%BB%BA%E7%AB%99/"}],"tags":[{"name":"wp","slug":"wp","permalink":"https://sch01ar.github.io/tags/wp/"},{"name":"éå¯¹ç§°åŠ å¯†","slug":"éå¯¹ç§°åŠ å¯†","permalink":"https://sch01ar.github.io/tags/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/"},{"name":"lattice","slug":"lattice","permalink":"https://sch01ar.github.io/tags/lattice/"},{"name":"äºŒå‰æ ‘","slug":"äºŒå‰æ ‘","permalink":"https://sch01ar.github.io/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/"},{"name":"diary","slug":"diary","permalink":"https://sch01ar.github.io/tags/diary/"},{"name":"åšå®¢æ­å»º","slug":"åšå®¢æ­å»º","permalink":"https://sch01ar.github.io/tags/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/"}]}