<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>æ ¼å¯†ç </title>
    <link href="/2023/11/10/lattice/"/>
    <url>/2023/11/10/lattice/</url>
    
    <content type="html"><![CDATA[<h2 id="çº¿æ€§ä»£æ•°å‰ç½®çŸ¥è¯†"><a class="header-anchor" href="#çº¿æ€§ä»£æ•°å‰ç½®çŸ¥è¯†">Â¶</a>çº¿æ€§ä»£æ•°å‰ç½®çŸ¥è¯†</h2><blockquote><p>å…ˆå›é¡¾ä¸€ä¸‹å­¦æ ¡çº¿ä»£è¯¾ç¨‹è®²è¿‡çš„å‡ ä¸ªæ¦‚å¿µ</p></blockquote><h3 id="å‘é‡ç©ºé—´"><a class="header-anchor" href="#å‘é‡ç©ºé—´">Â¶</a>å‘é‡ç©ºé—´</h3><p>è®¾$V$æ˜¯ n å…ƒå‘é‡çš„é›†åˆï¼Œå¦‚æœ$V$éç©ºï¼Œå¹¶ä¸”å¯¹äºå‘é‡çš„çº¿æ€§è¿ç®—å°é—­(å³å¯¹ä»»æ„ $\boldsymbol{v_1} \in V,\boldsymbol{v_2} \in V,k \in \mathbb{R}$ ï¼Œéƒ½æœ‰ $\boldsymbol{v_1+v_2} \in V,k\boldsymbol{v_1} \in V$ )ï¼Œåˆ™ç§° $V$ æ˜¯ä¸€ä¸ª<strong>å‘é‡ç©ºé—´</strong>ã€‚</p><h3 id="å‘é‡ç©ºé—´çš„åŸºä¸ç»´æ•°"><a class="header-anchor" href="#å‘é‡ç©ºé—´çš„åŸºä¸ç»´æ•°">Â¶</a>å‘é‡ç©ºé—´çš„åŸºä¸ç»´æ•°</h3><p>å‘é‡ç©ºé—´$V$çš„ä¸€ä¸ªæå¤§æ— å…³ç»„å«åš$V$çš„ä¸€ä¸ª<strong>åŸº</strong>ï¼Œ$V$ çš„ç§©å«åš$V$çš„<strong>ç»´æ•°</strong>ï¼Œè®°ä½œ$dim(V)$ã€‚è‹¥ $dim(V)=r$ï¼Œåˆ™ç§°$V$ä¸º$r$ç»´å‘é‡ç©ºé—´ã€‚</p><p>è‹¥å·²çŸ¥$r$ç»´å‘é‡ç©ºé—´$V$çš„åŸºä¸º$\boldsymbol{v_1,v_2,\cdots,v_r}$ï¼Œåˆ™å‘é‡ç©ºé—´$V$å¯ä»¥è¡¨ç¤ºæˆ</p><p>$$<br>V={ \boldsymbol{v}=x_1\boldsymbol{v_1}+x_2\boldsymbol{v_2}+\cdots +x_r\boldsymbol{v_r} | x_1,x_2,\cdots,x_r \in \mathbb{R}}<br>$$</p><h3 id="å‘é‡æ­£äº¤ä¸æ–½å¯†ç‰¹-Schmidt-æ­£äº¤åŒ–"><a class="header-anchor" href="#å‘é‡æ­£äº¤ä¸æ–½å¯†ç‰¹-Schmidt-æ­£äº¤åŒ–">Â¶</a>å‘é‡æ­£äº¤ä¸æ–½å¯†ç‰¹(Schmidt)æ­£äº¤åŒ–</h3><ul><li><p>å½“$\boldsymbol{a\neq 0,b\neq 0}$æ—¶ï¼Œå½“$(\boldsymbol{a,b}=0)$ï¼Œå³$\boldsymbol{a^Tb}=0$æ—¶ï¼Œç§°å‘é‡$\boldsymbol{a,b}$æ­£äº¤ã€‚</p></li><li><p>ç”±ä¸¤ä¸¤æ­£äº¤çš„éé›¶å‘é‡ç»„æˆçš„å‘é‡ç»„ç§°ä¸º<strong>æ­£äº¤å‘é‡ç»„</strong>ï¼Œç”±å•ä½å‘é‡ç»„æˆçš„æ­£äº¤å‘é‡ç»„ç§°ä¸º<strong>æ ‡å‡†æ­£äº¤å‘é‡ç»„</strong>ã€‚</p></li></ul><h2 id="æ ¼"><a class="header-anchor" href="#æ ¼">Â¶</a>æ ¼</h2><p>$n$å…ƒå‘é‡çš„é›†åˆ $v_1,\cdots,v_n \in \mathbb{R}^n$ï¼Œæ ¼ï¼ˆLatticesï¼‰å°±æ˜¯è¿™äº›å‘é‡çš„çº¿æ€§ç»„åˆ</p><p>$$L={a_1v_1+a_2v_2+\cdots+a_nv_n \mid a_1,a_2,\cdots,a_n \in \mathbb{Z}}$$</p><p>å¯¹æ¯”å‘é‡ç©ºé—´çš„å®šä¹‰ï¼Œå¯ä»¥å‘ç°ç³»æ•°æ˜¯æ•´æ•°ï¼Œå› æ­¤å®šä¹‰å‡ºæ¥çš„æ ¼ç©ºé—´æ˜¯ä¸€äº›æ ¼ç‚¹ï¼Œè€Œéè¿ç»­çš„å‘é‡ç©ºé—´ã€‚</p><p>ä¸‹å›¾æ˜¯ä¸€ä¸ªäºŒç»´æ ¼ï¼Œå¹³è¡Œå››è¾¹å½¢çš„ä¸€ç»„é‚»è¾¹æ˜¯æ ¼çš„åŸºåº•ã€‚é€šè¿‡å¯¹è¿™ä¸¤ä¸ªå‘é‡ä¸æ–­è¿›è¡Œçº¿æ€§ç»„åˆï¼Œé‚£ä¹ˆå°±äº§ç”Ÿäº†å¾ˆå¤šæ ¼ç‚¹ï¼Œå°±å½¢æˆäº†ä¸€ä¸ªæ ¼ã€‚<br><img src="/img/lattice.png" alt=""></p><h3 id="åŸºæœ¬åŸŸ"><a class="header-anchor" href="#åŸºæœ¬åŸŸ">Â¶</a>åŸºæœ¬åŸŸ</h3><p>å‡å®š $v_1,v_2,\cdots,v_n$ æ˜¯æ ¼ $L$ çš„åŸºï¼Œ$F{v_1,v_2,\cdots,v_n}={a_1v_1+a_2v_2+\cdots+a_nv_n \mid a_1,a_2,\cdots,a_n \in [0,1]}$</p><p>ä¸Šå›¾ä¸­çš„å¹³è¡Œå››è¾¹å½¢ï¼Œå°±æ˜¯äºŒç»´æ ¼ä¸­ä¸€ç»„åŸºåº•æ„æˆçš„åŸºæœ¬åŸŸã€‚</p><p>æ ¼åŸºæœ¬åŸŸçš„<strong>ä½“ç§¯</strong>ç­‰äºæ ¼çš„<strong>è¡Œåˆ—å¼</strong>çš„å€¼ï¼ŒåŸºæœ¬åŸŸçš„ä½“ç§¯å°±æ˜¯ç§¯åˆ†ï¼Œè€Œè¿™ä¹Ÿæ­£æ˜¯è¡Œåˆ—å¼çš„å‡ ä½•æ„ä¹‰ï¼Œ$Volume(F{v_1,v_2,\cdots,v_n})=det(L)$</p><h3 id="çŸ©é˜µè¡¨ç¤º"><a class="header-anchor" href="#çŸ©é˜µè¡¨ç¤º">Â¶</a>çŸ©é˜µè¡¨ç¤º</h3><p>å‡å®š $v_1,v_2,\cdots,v_n$ æ˜¯æ ¼ $L$ çš„åŸºï¼Œ$w_1,w_2,\cdots,w_n \in L$ï¼Œåˆ™å¿…ç„¶å­˜åœ¨æ•´ç³»æ•° $a_{ij}$ ä½¿å¾—ï¼š</p><p>$$<br>\begin{cases} w_1=a_{11}v_1+a_{12}v_2+\cdots+a_{1n}v_n \ w_2=a_{21}v_1+a_{22}v_2+\cdots+a_{2n}v_n \ \vdots \ w_n=a_{n1}v_1+a_{n2}v_2+\cdots+a_{nn}v_n \end{cases}<br>$$</p><p>å¯ä»¥æå–å‡ºä¸€ä¸ªç³»æ•°çŸ©é˜µ</p><p>$$<br>A=<br>\begin{bmatrix}<br>a_{1,1} &amp; a_{1,2} &amp; \ldots &amp; a_{1,n}\<br>a_{2,1} &amp; a_{2,2} &amp; \ldots &amp; a_{2,n}\<br>\vdots &amp; \vdots &amp; \ddots &amp; \vdots \<br>a_{n,1} &amp; a_{n,2} &amp; \ldots &amp; a_{n,n}<br>\end{bmatrix}<br>$$</p><p>è¿›è€Œå°†ä¸Šè¿°æ–¹ç¨‹ç»„è½¬æ¢ä¸ºçŸ©é˜µè¡¨ç¤º$\boldsymbol{w}=A * \boldsymbol{v}$</p><h2 id="LLL-BKZ-ç®—æ³•"><a class="header-anchor" href="#LLL-BKZ-ç®—æ³•">Â¶</a>LLL/BKZ ç®—æ³•</h2><p>ä¸€ç§<strong>æ ¼åŸºçº¦ç®€</strong>ç®—æ³•ï¼Œå¯ä»¥æ‰¾åˆ°æ ¼ä¸Šçš„ä¸€ç»„æœ€çŸ­çš„<strong>æ­£äº¤åŸº</strong>ã€‚</p><p>åœ¨<code>Sagemath</code>ä¸­å¯ä»¥ç›´æ¥è°ƒç”¨å‡½æ•°ã€‚</p><p>ä½†å¯¹äºå‡½æ•°çš„å®ç°ä»¥åŠç®—æ³•çš„åŸç†æ²¡å¿…è¦æ·±ç©¶ï¼Œåœ¨å…·ä½“é¢˜ç›®å½“ä¸­ä¼šä½¿ç”¨å³å¯ã€‚</p><p>&lt;!â€“codeï¿¼0â€“&gt;</p><p>ä¸‹å›¾æ˜¯é«˜æ–¯å¯å‘å¼ï¼Œä¸ºæˆ‘ä»¬å±•ç¤ºäº†æ ¼ä¸Šæœ€çŸ­å‘é‡çš„<strong>æ¬§å‡ é‡Œå¾—èŒƒæ•°</strong>çš„å¤§è‡´èŒƒå›´ã€‚<br><img src="/img/gsqf.png" alt=""></p><p>è¿™æ ·æˆ‘ä»¬å°±çŸ¥é“æ„é€ å‡ºæ¥çš„æ ¼ï¼Œæ˜¯å¦å¯ä»¥è§„çº¦å‡ºæˆ‘ä»¬çš„ç›®æ ‡å‘é‡ï¼Œä¹Ÿä¸ºæˆ‘ä»¬è°ƒæ•´æ ¼çš„å¹³è¡¡æä¾›äº†æ€è·¯ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨ä»¥ä¸‹å‡ ä¸ªé—®é¢˜å½“ä¸­å…·ä½“çœ‹ä¸€ä¸‹<code>LLL</code>ç®—æ³•çš„åº”ç”¨ã€‚</p><h3 id="LLL-è§£å†³-SVP-é—®é¢˜"><a class="header-anchor" href="#LLL-è§£å†³-SVP-é—®é¢˜">Â¶</a>LLL è§£å†³ SVP é—®é¢˜</h3><blockquote><p>æœ€çŸ­å‘é‡é—®é¢˜(Shortest Vector Problemï¼ŒSVP)</p></blockquote><p>è¿™æ˜¯æœ€åŸºæœ¬çš„ä¸€ä¸ªé—®é¢˜ï¼Œåç»­å¾ˆå¤šæ ¼é—®é¢˜æœ€ç»ˆéƒ½è½¬æ¢æˆäº†<code>SVP</code>é—®é¢˜ï¼Œä»<code>LLL</code>ç®—æ³•ä¸­æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œæœ€ç»ˆå¾—åˆ°çš„æ˜¯æ ¼ä¸Šçš„æœ€çŸ­æ­£äº¤å‘é‡ç»„ã€‚</p><p>ä¸‹é¢ä»ä¸€ä¸ªä¾‹å­æ¥ä»‹ç»æ ¼çš„æ„é€ å’Œ LLL çš„åº”ç”¨ã€‚</p><p>&lt;!â€“codeï¿¼1â€“&gt;</p><p>$$(p*f - 58 * f + q) % g = 44$$<br>$$k\cdot g+44=(p-58)\cdot f+q$$<br>æˆ‘ä»¬ç›®çš„æ˜¯é€šè¿‡$f,g$æ±‚å‡º$p,q$ï¼Œä»ä»£ç çš„å®šä¹‰å¯ä»¥çœ‹åˆ°ï¼Œ$p,q$çš„ä½æ•°ç›¸æ¯”äº$f,g$æ¥è¯´å¾ˆå°ï¼Œå› æ­¤å¯ä»¥åº”ç”¨æ ¼çš„æ€è·¯ï¼Œæ„é€ ä¸€ä¸ªåˆé€‚çš„æ ¼ï¼Œè§„çº¦å‡º$(p,q)$</p><p>å†™å‡ºå¦‚ä¸‹æ–¹ç¨‹ç»„<br>$$k\cdot g-(p-58)\cdot f=q-44$$<br>$$k\cdot 0-(p-58)\cdot (-1)=p-58$$<br>å¯ä»¥çœ‹åˆ°ç¬¬äºŒä¸ªå¼å­æ˜¯ä¸€ä¸ªæ’ç­‰å¼ï¼Œåœ¨æ„é€ æ ¼æ—¶æˆ‘ä»¬é€šå¸¸éœ€è¦åŠ å…¥è¿™æ ·çš„æ’ç­‰å¼ã€‚</p><p>ä¸‹é¢å°†æ–¹ç¨‹ç»„è½¬æ¢ä¸ºçŸ©é˜µã€‚</p><p>$$(k, p-58)Â \begin{bmatrix}0&amp;g\1&amp;-fÂ \end{bmatrix}=(p-58,q-44)$$</p><p>å¾—åˆ°äº†$v*B=w$çš„å½¢å¼ã€‚åœ¨è¿™ä¸ªå¼å­ä¸­æˆ‘ä»¬å…³å¿ƒçš„æ˜¯$w$å‘é‡æ˜¯å¦æ˜¯æ ¼$B$ä¸Šçš„æœ€çŸ­å‘é‡ï¼Œ$v$è¿™æ˜¯çº¿æ€§ç»„åˆçš„ç³»æ•°å¹¶ä¸ç”¨è¿‡å¤šå…³æ³¨ã€‚</p><p>åœ¨ä»‹ç»<strong>é«˜æ–¯å¯å‘å¼</strong>çš„æ—¶å€™ï¼Œæåˆ°äº†æ ¼ä¸Šæœ€çŸ­å‘é‡çš„<strong>æ¬§å‡ é‡Œå¾—èŒƒæ•°</strong>çš„å¤§è‡´èŒƒå›´ï¼Œæˆ‘ä»¬ç°åœ¨éªŒè¯ä¸€ä¸‹ï¼Œçœ‹çœ‹$w$æ˜¯å¦æ˜¯æ ¼$B$ä¸Šçš„æœ€çŸ­å‘é‡ï¼Œå³æ¯”è¾ƒé•¿åº¦$||w||$å’Œé«˜æ–¯æœŸæœ›å€¼$\sigma(det(B))$<br>$$||w|| = \sqrt{(p-58)<sup>2+(q-44)</sup>2}\approx 2^{1024}$$<br>$$\sigma(det(B))\approx det(B)^{1/2}=\sqrt{g}\approx 2^{1024}$$</p><p>äºæ˜¯$w$å¤§æ¦‚ç‡ä¸ºæ ¼$B$ä¸Šçš„æœ€çŸ­å‘é‡ï¼Œæ„é€ æ ¼$B$è¿›è¡Œ<code>LLL</code>ç®—æ³•å³å¯ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>lattice</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¸€äº›å…³äºp^qé—®é¢˜å‰ªæç®—æ³•</title>
    <link href="/2023/11/07/%E5%89%AA%E6%9E%9D/"/>
    <url>/2023/11/07/%E5%89%AA%E6%9E%9D/</url>
    
    <content type="html"><![CDATA[<blockquote><p>æ­¤ç¯‡æ–‡ç« é’ˆå¯¹ RSA ä¸­ p^q ç›¸å…³é—®é¢˜åŠå˜ç§åšä¸€ä¸ªæ€»ç»“ã€‚ä¹‹å‰åšè¿‡å¾ˆå¤š p^q ç›¸å…³çš„é—®é¢˜ï¼Œä½†æ˜¯æ€è·¯å¤§å·®ä¸å·®ï¼Œå‘¨æœ«æ‰“äº†é¹åŸæ¯ï¼Œå¤ç°æ—¶å‘ç°è¦ç»“åˆ copper å’Œ dfs æ¥å‰ªæã€‚</p></blockquote><p>å‚è€ƒæ–‡ç« </p><p><a href="https://tangcuxiaojikuai.xyz/post/342113ee.html">https://tangcuxiaojikuai.xyz/post/342113ee.html</a></p><p><a href="https://mp.weixin.qq.com/s/Bi0iQOXwM5UlntrtdRL1oA">https://mp.weixin.qq.com/s/Bi0iQOXwM5UlntrtdRL1oA</a></p><h2 id="p-q"><a class="header-anchor" href="#p-q">Â¶</a>p^q</h2><h3 id="æœç´¢æ–¹å¼"><a class="header-anchor" href="#æœç´¢æ–¹å¼">Â¶</a>æœç´¢æ–¹å¼</h3><ul><li>ä»ä½ä½æœç´¢ï¼Œåœ¨å·²çŸ¥ p^q å’Œ p*q çš„æƒ…å†µä¸‹ï¼Œç”±äºå¼‚æˆ–æ˜¯æŒ‰ä½è¿›è¡Œçš„ï¼Œå¯¹äºæ¯ä¸€ä½å¼‚æˆ–çš„ç»“æœæ¥è¯´ï¼Œpã€q è¯¥ä½çš„ç»„åˆæƒ…å†µæœ‰ 4 ç§<code>[1,0][0,1][1,1][0,0]</code></li></ul><h3 id="å‰ªææ¡ä»¶"><a class="header-anchor" href="#å‰ªææ¡ä»¶">Â¶</a>å‰ªææ¡ä»¶</h3><ul><li>åˆ©ç”¨<code>p*q==n</code>è¿™ä¸€æ¡ä»¶æ¥è¿›è¡Œç­›é€‰ï¼Œç”±äºæ˜¯ä»ä½ä½å¼€å§‹çˆ†ç ´ï¼Œå› æ­¤æ»¡è¶³$p_{low}*q_{low}==n_{low}$</li></ul><p>&lt;!â€“codeï¿¼0â€“&gt;</p><h2 id="p-q-rev"><a class="header-anchor" href="#p-q-rev">Â¶</a>p^q_rev</h2><p>&lt;!â€“codeï¿¼1â€“&gt;</p><h3 id="æœç´¢æ–¹å¼-v2"><a class="header-anchor" href="#æœç´¢æ–¹å¼-v2">Â¶</a>æœç´¢æ–¹å¼</h3><ul><li>ä»ä¸¤ç«¯çˆ†ç ´</li><li>æ¯ä¸€æ¬¡æœç´¢ï¼Œéœ€åˆ©ç”¨å½“å‰ gift ä¸¤ç«¯çš„ bit ä½ã€‚è¿™æ˜¯å› ä¸ºï¼Œgift çš„å½“å‰æœ€é«˜ä½å¯¹åº” p çš„æœ€é«˜ä½åŠ q çš„æœ€ä½ä½ï¼Œgift çš„å½“å‰æœ€ä½ä½å¯¹åº” p çš„æœ€ä½ä½åŠ q çš„æœ€é«˜ä½</li></ul><h3 id="å‰ªææ¡ä»¶-v2"><a class="header-anchor" href="#å‰ªææ¡ä»¶-v2">Â¶</a>å‰ªææ¡ä»¶</h3><ul><li>å°† pã€q æœªæœç´¢åˆ°çš„ä½å…¨å¡« 0ï¼Œä¹˜ç§¯åº”å°äº n</li><li>å°† pã€q æœªæœç´¢åˆ°çš„ä½å…¨å¡« 1ï¼Œä¹˜ç§¯åº”å¤§äº n</li><li>pã€q ä½ k ä½ä¹˜ç§¯å†å–ä½ k ä½ï¼Œåº”ä¸ n çš„ä½ k ä½ç›¸åŒ</li></ul><p>&lt;!â€“codeï¿¼2â€“&gt;</p><h2 id="p-q-nbits"><a class="header-anchor" href="#p-q-nbits">Â¶</a>p^(q&gt;&gt;nbits)</h2><p>&lt;!â€“codeï¿¼3â€“&gt;</p><h3 id="æ€è·¯"><a class="header-anchor" href="#æ€è·¯">Â¶</a>æ€è·¯</h3><p>è¿™ä¸ªå…¶å®å¹¶ä¸ç®—å‰ªæäº†ï¼Œå› ä¸º gift çš„é«˜ 16 ä½å°±æ˜¯ P çš„é«˜ 16 ä½ã€‚ç”¨ N é™¤ä»¥ P åå¾—åˆ°çš„å°±æ˜¯ Q çš„é«˜ä½ï¼Œå†æ¬¡åˆ©ç”¨ Q çš„é«˜ä½å’Œ giftï¼Œå¯ä»¥æ±‚å‡º P çš„ 16 ï½ 32 ä½ï¼Œä»¥æ­¤ç±»æ¨æ¥æ¢å¤ Pã€Qã€‚</p><p>&lt;!â€“codeï¿¼4â€“&gt;</p><h2 id="p-q-nbits-v2"><a class="header-anchor" href="#p-q-nbits-v2">Â¶</a>(p^q)&gt;&gt;nbits</h2><p>&lt;!â€“codeï¿¼5â€“&gt;</p><h3 id="æœç´¢æ–¹å¼-v3"><a class="header-anchor" href="#æœç´¢æ–¹å¼-v3">Â¶</a>æœç´¢æ–¹å¼</h3><ul><li>ä»é«˜ä½æœç´¢</li><li>p çš„é«˜ä½ä¹˜ q çš„é«˜ä½çš„å‰åŠéƒ¨åˆ†ç­‰äº n çš„é«˜ä½</li></ul><h3 id="å‰ªææ¡ä»¶-v3"><a class="header-anchor" href="#å‰ªææ¡ä»¶-v3">Â¶</a>å‰ªææ¡ä»¶</h3><ul><li>ä½ä½å…¨è¡¥ 0ï¼Œç›¸ä¹˜ç»“æœ &lt; n</li><li>ä½ä½å…¨è¡¥ 1ï¼Œç›¸ä¹˜ç»“æœ &gt; n</li></ul><p>&lt;!â€“codeï¿¼6â€“&gt;</p><h3 id="coppersmith"><a class="header-anchor" href="#coppersmith">Â¶</a>coppersmith</h3><p>ä¸Šè¿°å‰ªæåªèƒ½æ±‚å‡ºé«˜ 262 ä½äº†ï¼Œæœ‰å¤šç§ç»„åˆï¼Œä½†ä»ç¼ºå°‘ä½ 250 ä½ï¼Œå› æ­¤éœ€è¦ç”¨åˆ° coppersmith æ¥æ±‚è§£ã€‚</p><p>åœ¨å…·ä½“åº”ç”¨æƒ…æ™¯ä¸­åº”å½“é€‚å½“è°ƒæ•´<code>beta</code>å’Œ<code>epsilon</code>ã€‚</p><p>&lt;!â€“codeï¿¼7â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2023CBCTF</title>
    <link href="/2023/11/01/2023CBCTF/"/>
    <url>/2023/11/01/2023CBCTF/</url>
    
    <content type="html"><![CDATA[<blockquote><p>ä¹‹å‰å’Œ N1CTF æ’äº†ï¼Œä½†æ˜¯æ¯”èµ›é¢˜ç›®è´¨é‡å¾ˆé«˜ï¼Œå½“æ—¶æµ…çœ‹äº†ä¸€ä¸‹ï¼Œç°åœ¨è¡¥ä¸€ä¸‹ã€‚</p></blockquote><h2 id="CB-Curve"><a class="header-anchor" href="#CB-Curve">Â¶</a>CB_Curve</h2><p>åˆ©ç”¨ Grobner åŸºè§£ P ç‚¹ï¼Œåç»­å¤ç°æ‰çŸ¥é“è¿™æ˜¯<code>HUFF</code>æ›²çº¿ï¼Œæ ¹æ®è®ºæ–‡æ–¹æ³•å¾—åˆ°æ›²çº¿çš„å®šä¹‰å’Œæ˜ å°„æ–¹æ³•ï¼Œè¿™æ ·å°±å¯å¾—åˆ°ç»´å°”æ–¯ç‰¹æ‹‰æ–¯å½¢å¼ï¼Œåç»­é€šè¿‡å…‰æ»‘é˜¶æ±‚è§£ç¦»æ•£å¯¹æ•°å³å¯ã€‚</p><p>å…³äº Grobner åŸºçš„åº”ç”¨ï¼Œæƒ³åˆ°æš‘å‡<code>0x401</code>å¸ˆå‚…å‡ºçš„ä¸€é“é¢˜ï¼Œåç»­å†™åœ¨è¿™é“é¢˜åé¢ï¼ŒåŠ æ·±ä¸€ä¸‹å°è±¡ã€‚</p><p>æ›²çº¿å½¢å¼</p><p>$$<br>x(a<sup>2y-1)â‰¡y(bx</sup>2-1) mod \quad p<br>$$</p><p>æ›²çº¿æ˜ å°„</p><p>$$<br>(x,y)â†’(\frac{bx-ay}{y-x},\frac{b-a}{y-x})<br>$$</p><p>ç›®æ ‡æ›²çº¿</p><p>$$<br>y<sup>2â‰¡x</sup>3+(a+b)x^2+abx \quad mod \quad p<br>$$</p><p>&lt;!â€“codeï¿¼0â€“&gt;</p><h3 id="ezAlgebra-DASCTF-2023-0X401"><a class="header-anchor" href="#ezAlgebra-DASCTF-2023-0X401">Â¶</a>ezAlgebra(DASCTF 2023 &amp; 0X401)</h3><p>é¢˜ç›®æè¿°</p><p>&lt;!â€“codeï¿¼1â€“&gt;</p><p>ä¸€å…ƒ coppersimth ç”¨ c1 æ±‚ tï¼Œä»è€Œè·å¾— p</p><p>&lt;!â€“codeï¿¼2â€“&gt;</p><p>æ ¹æ® c2ã€c3 å»ºç«‹ä¸¤ä¸ªå¤šé¡¹å¼</p><p>&lt;!â€“codeï¿¼3â€“&gt;</p><p>è™½ç„¶åªæœ‰ m æœªçŸ¥ï¼Œä½†ä½¿ç”¨ Grobner åŸºéœ€è¦è‡³å°‘äºŒå…ƒå¤šé¡¹å¼ï¼Œæ‰€ä»¥å¼•å…¥ tï¼ŒåŒç†å¼•å…¥<code>f3 = t-2915836867</code>ï¼Œæ¥ä¸‹æ¥é‡‡ç”¨ Grobner è·å¾—ç†æƒ³åŸºå³å¯ã€‚</p><p>&lt;!â€“codeï¿¼4â€“&gt;</p><p>æœ€ç»ˆè§£ flag</p><p>&lt;!â€“codeï¿¼5â€“&gt;</p><h2 id="CB-RSA"><a class="header-anchor" href="#CB-RSA">Â¶</a>CB_RSA</h2><p>&lt;!â€“codeï¿¼6â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2023ACTF</title>
    <link href="/2023/10/30/2023ACTF/"/>
    <url>/2023/10/30/2023ACTF/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å‘¨æœ«æ‰“äº†ä¸€ä¸‹ ACTFï¼Œé¢˜ç›®è´¨é‡å¾ˆé«˜ã€‚æ€»å…± 6 é“é¢˜ç›®åšäº† 3 é“ï¼Œæœ‰ä¸€é“å¡ç€ç­‰åç»­å¤ç°ã€‚æœ€è¿‘å¤ªç´¯äº†ï¼Œå‘¨æœ«æ¯”èµ›ï¼Œå‘¨å†…å¤ç°ã€‚ã€‚ã€‚ğŸ­ğŸ­ æˆ‘å•Šï¼Œæ‰“ CTF æ‰“çš„ï¼</p></blockquote><h2 id="MDH"><a class="header-anchor" href="#MDH">Â¶</a>MDH</h2><blockquote><p>æ‰‹å¿«æŠ¢äº†ä¸ªä¸‰è¡€ hh</p></blockquote><p>çœ‹åˆ°è¿™é“é¢˜ç¬¬ä¸€ååº”æ˜¯æ­»å»çš„çº¿ä»£å¼€å§‹æ”»å‡»æˆ‘ï¼Œå¥½åœ¨è¿˜æœ‰ç‚¹å°è±¡ï¼Œå¯¹äºçŸ©é˜µçš„è¿¹æ¥è¯´ï¼Œå°±æ˜¯å¯¹è§’çº¿å…ƒç´ çš„å’Œã€‚</p><p>&lt;!â€“codeï¿¼0â€“&gt;</p><p>å°†<code>shared</code>çš„çŸ©é˜µè¡¨ç¤ºä¸º$a_1^T\cdot b_1\cdot b_2^T \cdot a_2$</p><p>è€Œé¢˜ç›®å·²çŸ¥$PKA=a_1\cdot a_2^T,PKB=b_1\cdot b_2^T$</p><p>å¯¹äºè¿¹çš„ä¸€ä¸ªæ€§è´¨æ¥è¯´ï¼Œè‹¥å¹²å‘é‡ç›¸ä¹˜æ‰€å¾—çš„æ–¹é˜µï¼Œæ”¹å˜å…¶ç›¸ä¹˜é¡ºåºï¼ŒçŸ©é˜µçš„è¿¹éƒ½åº”ä¸€è‡´ã€‚</p><p>å› æ­¤åªéœ€è®¡ç®—$PKA^T\cdot PKB$çš„è¿¹å³å¯ã€‚</p><p>&lt;!â€“codeï¿¼1â€“&gt;</p><h2 id="claw-crane"><a class="header-anchor" href="#claw-crane">Â¶</a>claw crane</h2><blockquote><p>é¢˜å¦‚å…¶åï¼ŒçœŸç‰›é­”æŠ“å¨ƒå¨ƒ</p></blockquote><p>&lt;!â€“codeï¿¼2â€“&gt;</p><p>æ€»ä¹‹å°±æ˜¯è¦åœ¨ä½ æ„é€ å‡ºçš„ 128 ä½æ•°å½“ä¸­éšæœºé€‰æ‹©é€‰åˆ° 0 æ‰ä¼šåŠ åˆ†ï¼Œ256 æ¬¡ä¸­éœ€è¦æ­£ç¡® 220 æ¬¡ï¼Œå› æ­¤å°±æƒ³æ–¹è®¾æ³•è®©æ•°å­—çš„ 2 è¿›åˆ¶ 0 å¤šä¸€äº›ï¼Œ<code>delta = abs(r * q - p * pow(2, 128))</code>ï¼Œr å·²çŸ¥ï¼Œéœ€è¦æˆ‘ä»¬ä¼ å…¥ pã€qï¼Œç”±äº$p\cdot 2^{128}$ç›¸å½“äºå·¦ç§» 128 ä½ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿè¦è®© rq çš„ä½ä½å°½å¯èƒ½ä¹Ÿä¸º 0ï¼Œq ä¸èƒ½è¶…è¿‡ 2^64 æ¬¡æ–¹ï¼Œå› æ­¤ q çš„å–å€¼å¯ä»¥ä¸º$2<sup>{63},2</sup>{63}+2<sup>{62},2</sup>{62}â€¦$ å¯¹äºç»™å®šçš„ r å’Œ q è®¡ç®—ä¸€ä¸ª p å€¼ï¼Œåœ¨å¤šç»„å½“ä¸­è¿›è¡Œ delta ä¸­ 0 ä¸ªæ•°çš„è®¡ç®—ï¼Œé€‰æ‹© 0 ä¸ªæ•°æœ€é«˜çš„ä¸€ç»„ pã€q å‘é€ï¼Œåˆ†æ•°å¯ä»¥ç¨³å®šåœ¨ 2000 ä»¥ä¸Šï¼Œè¿æ°”å¥½ä¸€ä¼šå°±å‡ºäº†ã€‚</p><p>&lt;!â€“codeï¿¼3â€“&gt;</p><h2 id="Easy-RSA"><a class="header-anchor" href="#Easy-RSA">Â¶</a>Easy RSA</h2><p>é¢˜ç›®</p><p>&lt;!â€“codeï¿¼4â€“&gt;</p><p>å…³é”®ä¿¡æ¯</p><p>&lt;!â€“codeï¿¼5â€“&gt;</p><p>è¯´æ˜äº†è¿™ä¸€ç»„<code>e_,d_</code>æ»¡è¶³ä¸‰ä¸ªæ¨¡æ•° nï¼Œç›¸å½“äºå·²çŸ¥ä¸‰ç»„ nã€eï¼Œå¯¹äºé¢˜ç›®æ‰€é™åˆ¶çš„ d çš„ä½æ•°ï¼Œåˆšå¥½æ»¡è¶³é€ æ ¼çš„æƒ…å†µ</p><p>&lt;!â€“codeï¿¼6â€“&gt;</p><h3 id="Review"><a class="header-anchor" href="#Review">Â¶</a>Review</h3><p>æ­¤éƒ¨åˆ†åœ¨é˜…è¯»å…¶ä½™é˜Ÿä¼ wp åçš„å¤ç›˜ï¼Œå¯¹äºä¸Šé¢˜ï¼Œæ ¼çš„å…·ä½“æ„é€ æ€è·¯æè¿°å¦‚ä¸‹ï¼š</p><p>$$<br>\begin{aligned}<br>ED -k_1N_1 &amp;= 1+k_1x_1 \<br>ED -aN_2 &amp;= 1+ax_2 \<br>ED -dN_3 &amp;= 1+dx_3<br>\end{aligned}<br>$$</p><p>æ„é€ æ ¼:</p><p>$$<br>\begin{bmatrix}<br>2^{767} &amp; E &amp;E&amp;E\<br>0 &amp; -N_1 &amp;0&amp;0\<br>0 &amp; 0 &amp;-N_2&amp;0\<br>0 &amp; 0 &amp;0&amp;-N_3\<br>\end{bmatrix}<br>$$</p><h2 id="Mid-RSA-èµ›åå¤ç°"><a class="header-anchor" href="#Mid-RSA-èµ›åå¤ç°">Â¶</a>Mid RSA(èµ›åå¤ç°)</h2><p>ä¸ Easy ä¸åŒçš„åœ°æ–¹åœ¨äºå°† d ä½æ•°æé«˜ï¼ŒåŸæœ¬çš„æ ¼æ— æ³•è§„çº¦å‡ºæ¥ï¼Œå½“æ—¶è°ƒæ ¼å­è°ƒåäº†ï¼Œä½†æ˜¯çœŸæ²¡æƒ³åˆ°æœ¬åœ°ç”Ÿæˆä¸€ç»„æ•°å’Œä¸Šä¸€é¢˜å¯¹æ¯”ä¸€ä¸‹ï¼Œä¸Šé¢˜çš„æ ¼å­æ‹¿è¿‡æ¥åªæ˜¯å·®äº†å‡ ä½ä½ä½ã€‚ã€‚ã€‚</p><p>&lt;!â€“codeï¿¼7â€“&gt;</p><p>å¯¹äº</p><p>$$<br>\begin{aligned}<br>e(d_h\times2^{16}+d_l) -1 &amp;= k_1\phi(N_1) \<br>e(d_h\times2^{16}+d_l) -1 &amp;= k_2\phi(N_2) \<br>e(d_h\times2^{16}+d_l) -1 &amp;= k_3\phi(N_3)<br>\end{aligned}<br>$$</p><p>æœ‰</p><p>$$<br>\begin{aligned}<br>e2^{16}d_h+ed_l -k_1N_1 &amp;= 1+k_1s_1 \<br>e2^{16}d_h+ed_l -k_2N_2 &amp;= 1+k_2s_2 \<br>e2^{16}d_h+ed_l -k_3N_3 &amp;= 1+k_3s_3<br>\end{aligned}<br>$$</p><p>æ„é€ æ ¼:</p><p>$$<br>\begin{bmatrix}<br>1 &amp; e2^{16} &amp;e2<sup>{16}&amp;e2</sup>{16}&amp;0\<br>0 &amp; -N_1 &amp;0&amp;0&amp;0\<br>0 &amp; 0 &amp;-N_2&amp;0&amp;0\<br>0 &amp; 0 &amp;0&amp;-N_3&amp;0\<br>0 &amp; ed_l&amp;ed_l&amp;ed_l&amp;1\<br>\end{bmatrix}<br>$$</p><p>æ„é€ æ–¹æ³•å‚è€ƒæ˜Ÿç›Ÿ 0HB å¸ˆå‚…ï¼Œè‡³äºä¸ºä½•æ˜¯ä½ä½ 16 ä½ï¼Œå¸ˆå‚…ç»™å‡ºçš„è§£é‡Šæ˜¯ï¼Œæœ¬åœ°æµ‹äº†ä¸€ç»„æ•°æ®ï¼Œå‘ç°ç”¨ä¸Šä¸€é¢˜çš„æ ¼å­è·‘å‡ºæ¥ç›¸å·®äº† 16 ä½ï¼Œä½†å…·ä½“ç›¸å·®å¤šå°‘è¿˜éœ€è¦å…·ä½“ç ”ç©¶ï¼Œç”±äº 16 ä½å·²è¶³å¤Ÿçˆ†ç ´ï¼Œå› æ­¤å…¬å¼ä¸­å†™ä¸ºäº† 16 æ¬¡æ–¹ã€‚</p><p>ç»æœ¬äººæµ‹è¯•ï¼Œå¯¹äºæœ¬é¢˜çš„ d ç¼ºå¤±äº† 7 ä½ã€‚</p><p>&lt;!â€“codeï¿¼8â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2023N1CTF</title>
    <link href="/2023/10/23/N1CTF2023/"/>
    <url>/2023/10/23/N1CTF2023/</url>
    
    <content type="html"><![CDATA[<blockquote><p>å‘¨æœ«å’Œå‰å¤§ä¸œå¤§çš„å¥½å“¥å“¥ä»¬æ‰“äº† n1ï¼Œæœ€åæ‹¿äº† rank7ï¼Œè¢« webğŸ‘´ å’Œ pwnğŸ‘´å¸¦é£</p></blockquote><blockquote><p>DJB æˆ˜é˜Ÿ wp:https://mp.weixin.qq.com/s/N03QtNsMvpux42xIAXxvrA</p></blockquote><h2 id="e2wrmup">e2W@rmup</h2><p>ECDSA æ¤­åœ†æ›²çº¿ç­¾åï¼Œä¹‹å‰æ²¡ç”¨è¿‡<code>ecdsa</code>åº“ï¼Œç»“æœå‘ç° då°±æ˜¯ç§é’¥ï¼Œæ‹†åˆ†ä¸€ä¸‹é«˜ä½ä½ï¼ŒäºŒå…ƒ coppersmithæ¢­ä¸€ä¸‹ï¼Œä¸­é—´å¯èƒ½è¦è¡¥ä¸€ä½ï¼Œè¡¥äº† 0 ä¹‹åå°±å¯ä»¥äº†ã€‚</p><p>åé¢çœ‹å¸ˆå‚…ä»¬åšå®¢è¿˜å¯ä»¥ç”¨æ ¼åšï¼Œå­¦åˆ°äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> itertools<br><span class="hljs-keyword">import</span> hashlib<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">small_roots</span>(<span class="hljs-params">f, bounds, m=<span class="hljs-number">1</span>, d=<span class="hljs-literal">None</span></span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> d:<br>        d = f.degree()<br>    R = f.base_ring()<br>    N = R.cardinality()<br><br>    f /= f.coefficients().pop(<span class="hljs-number">0</span>)<br>    f = f.change_ring(ZZ)<br><br>    G = <span class="hljs-type">Sequence</span>([], f.parent())<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(m + <span class="hljs-number">1</span>):<br>        base = N ^ (m - i) * f ^ i<br>        <span class="hljs-keyword">for</span> shifts <span class="hljs-keyword">in</span> itertools.product(<span class="hljs-built_in">range</span>(d), repeat=f.nvariables()):<br>            g = base * prod(<span class="hljs-built_in">map</span>(power, f.variables(), shifts))<br>            G.append(g)<br><br>    B, monomials = G.coefficient_matrix()<br>    monomials = vector(monomials)<br><br>    factors = [monomial(*bounds) <span class="hljs-keyword">for</span> monomial <span class="hljs-keyword">in</span> monomials]<br>    <span class="hljs-keyword">for</span> i, factor <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(factors):<br>        B.rescale_col(i, factor)<br><br>    B = B.dense_matrix().LLL()<br><br>    B = B.change_ring(QQ)<br>    <span class="hljs-keyword">for</span> i, factor <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(factors):<br>        B.rescale_col(i, <span class="hljs-number">1</span> / factor)<br><br>    H = <span class="hljs-type">Sequence</span>([], f.parent().change_ring(QQ))<br>    <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> <span class="hljs-built_in">filter</span>(<span class="hljs-literal">None</span>, B * monomials):<br>        H.append(h)<br>        I = H.ideal()<br>        <span class="hljs-keyword">if</span> I.dimension() == -<span class="hljs-number">1</span>:<br>            H.pop()<br>        <span class="hljs-keyword">elif</span> I.dimension() == <span class="hljs-number">0</span>:<br>            roots = []<br>            <span class="hljs-keyword">for</span> root <span class="hljs-keyword">in</span> I.variety(ring=ZZ):<br>                root = <span class="hljs-built_in">tuple</span>(R(root[var]) <span class="hljs-keyword">for</span> var <span class="hljs-keyword">in</span> f.variables())<br>                roots.append(root)<br>            <span class="hljs-keyword">return</span> roots<br><br>    <span class="hljs-keyword">return</span> []<br><br>msg = <span class="hljs-string">b&#x27;welcome to n1ctf2023!&#x27;</span><br>msg_hash = bytes_to_long(hashlib.sha256(msg).digest())<br><br>s = <span class="hljs-number">98064531907276862129345013436610988187051831712632166876574510656675679745081</span><br>r = <span class="hljs-number">9821122129422509893435671316433203251343263825232865092134497361752993786340</span><br><br>p = <span class="hljs-number">115792089210356248762697446949407573529996955224135760342422259061068512044369</span><br>leak = <span class="hljs-built_in">int</span>(<span class="hljs-string">&quot;10000111001100100010110100100000000100101000111011000001001011010100001010010000101001100011011010100000010010011011100010111001&quot;</span>, <span class="hljs-number">2</span>)<br>P.&lt;low,small&gt; = PolynomialRing(Zmod(p))<br><br>f = r*((small*(<span class="hljs-number">2</span>^<span class="hljs-number">128</span>))+low)+msg_hash-(leak&lt;&lt;<span class="hljs-number">128</span>)*s-small*s<br>roots = small_roots(f, [<span class="hljs-number">2</span>^<span class="hljs-number">129</span>, <span class="hljs-number">2</span>^<span class="hljs-number">130</span>], m=<span class="hljs-number">3</span>, d=<span class="hljs-number">4</span>)<br><span class="hljs-built_in">print</span>(roots)<br><br>low = <span class="hljs-number">109657576978117277727118025094273115603</span><br>high = <span class="hljs-number">222660286808164019769040839717358598716</span><br><br>d = <span class="hljs-built_in">bin</span>(high)[<span class="hljs-number">2</span>:]+<span class="hljs-string">&#x27;0&#x27;</span>+<span class="hljs-built_in">bin</span>(low)[<span class="hljs-number">2</span>:]<br>d = <span class="hljs-built_in">int</span>(d, <span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(d.bit_length())<br>aes = AES.new(long_to_bytes(d), mode=AES.MODE_ECB)<br>cipher = <span class="hljs-string">b&#x27;\xf3#\xff\x17\xdf\xbb\xc0\xc6v\x1bg\xc7\x8a6\xf2\xdf~\x12\xd8]\xc5\x02Ot\x99\x9f\xf7\xf3\x98\xbc\x045\x08\xfb\xce1@e\xbcg[I\xd1\xbf\xf8\xea\n-&#x27;</span><br>flag = aes.decrypt(cipher)<br><span class="hljs-built_in">print</span>(flag)<br><span class="hljs-comment"># b&#x27;n1ctf&#123;Wow!__You_bre4k_my_s1gn_chal1enge!!___&#125;\x03\x03\x03&#x27;</span><br><br></code></pre></td></tr></table></figure><h2 id="e2d1pèµ›åå¤ç°">e2d1p[èµ›åå¤ç°]</h2><p>å‚è€ƒæ–‡ç« ï¼š</p><p><ahref="">https://tl2cents.github.io/2023/10/23/2023-N1CTF-Crypto-Writeups/</a></p><p>https://github.com/Nu1LCTF/n1ctf-2023/tree/main/crypto/e2D1p</p><p>é¢˜ç›®</p><blockquote><p>Based on N1CTF 2022 â€œezdlpâ€. Easy dlp too, try again : ).</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> os<br>FLAG = os.environ.get(<span class="hljs-string">&#x27;FLAG&#x27;</span>, <span class="hljs-string">b&#x27;n1ctf&#123;XXXXFAKE_FLAGXXXX&#125;&#x27;</span>)<br><span class="hljs-keyword">assert</span> FLAG[:<span class="hljs-number">6</span>] == <span class="hljs-string">b&#x27;n1ctf&#123;&#x27;</span> <span class="hljs-keyword">and</span> FLAG[-<span class="hljs-number">1</span>:] == <span class="hljs-string">b&#x27;&#125;&#x27;</span><br>FLAG = FLAG[<span class="hljs-number">6</span>:-<span class="hljs-number">1</span>]<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">keygen</span>(<span class="hljs-params">nbits</span>):<br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        q = getPrime(nbits)<br>        <span class="hljs-keyword">if</span> isPrime(<span class="hljs-number">2</span>*q+<span class="hljs-number">1</span>):<br>            <span class="hljs-keyword">if</span> <span class="hljs-built_in">pow</span>(<span class="hljs-number">0x10001</span>, q, <span class="hljs-number">2</span>*q+<span class="hljs-number">1</span>) == <span class="hljs-number">1</span>:<br>                <span class="hljs-keyword">return</span> <span class="hljs-number">2</span>*q+<span class="hljs-number">1</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">key, message, mask</span>):<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">pow</span>(<span class="hljs-number">0x10001</span>, message^mask, key)<br><br><br>p = keygen(<span class="hljs-number">512</span>)<br>flag = bytes_to_long(FLAG)<br>messages = [getRandomNBitInteger(flag.bit_length()) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">200</span>)]<br>enc = [encrypt(p, message, flag) <span class="hljs-keyword">for</span> message <span class="hljs-keyword">in</span> messages]<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;message = <span class="hljs-subst">&#123;messages&#125;</span>&#x27;</span>)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;enc = <span class="hljs-subst">&#123;enc&#125;</span>&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="x01-æ¢å¤æ¨¡æ•°-p">0x01 æ¢å¤æ¨¡æ•° p</h3><p>ç»™äº† 200 ç»„ mã€c æ»¡è¶³ç­‰å¼<spanclass="math inline">\(65537^{m_iâŠ•mask}=c_i (mod p)\)</span></p><p>å¼‚æˆ–è¿ç®—åœ¨æŒ‡æ•°ä¸Šï¼Œæ²¡æœ‰ä»€ä¹ˆè¿ç®—æ€§è´¨ã€‚ä½†å¼‚æˆ–çš„æœ¬è´¨è¿˜æ˜¯æŒ‰ä½å¼‚æˆ–ï¼Œä»¥ä¸‹ç”¨m[i]è¡¨ç¤º m çš„ç¬¬ i ä½ï¼Œå¯¹äºä¸€ç»„ m å’Œ c è€Œè¨€</p><p><span class="math display">\[m\oplus mask = mask+\sum\limits_{j=0}\limits^{158}(m[j]\cdot2^i\cdot(-1)^{s[i]})\]</span></p><p>è¿™æ ·è½¬æ¢åå³å¯æŠŠåº•æ•°çœ‹ä½œ<spanclass="math inline">\(c_i=65537^{mask}\)</span>ï¼Œä¸‹ä¸€æ­¥çš„ç›®çš„å°±æ˜¯æ‰¾åˆ°æŸä¸ªå‘é‡<spanclass="math inline">\(e_i\)</span>ä½¿å¾—<spanclass="math inline">\(c_i^{e_i}â‰¡0\;mod\;p\)</span>ï¼Œè¿™æ ·å³å¯æ¢å¤å‡ºæ¨¡æ•°<spanclass="math inline">\(gcd(e_i,e_j)=p\)</span></p><p>æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„<span class="math inline">\(e_i\)</span>éœ€è¦<spanclass="math inline">\(m_i\)</span>ï¼Œæ„é€ å¦‚ä¸‹æ ¼ï¼š</p><p><span class="math inline">\(m_{i,j}=m_{i,j}*2^{256}\)</span></p><p><span class="math display">\[\begin{bmatrix}m_{0,0} &amp; m_{0,1} &amp; \ldots &amp; m_{0,158} &amp; 1 &amp; 0 &amp;\ldots &amp;0\\m_{1,0} &amp; m_{1,1} &amp; \ldots &amp; m_{1,158} &amp; 0 &amp; 1&amp;\ldots &amp;0\\\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots&amp; \ddots &amp; \vdots\\m_{199,0} &amp; m_{199,1} &amp; \ldots &amp; m_{199,158} &amp; 0&amp;0&amp; \ldots &amp;1\\\end{bmatrix}\]</span></p><p>åˆ©ç”¨<code>LLL</code>ç®—æ³•å¾—åˆ°çš„<spanclass="math inline">\(e_i\)</span>æ»¡è¶³<spanclass="math inline">\(\sum\limits_{i=1}\limits^{200}e_i=0\)</span>ï¼Œé‚£ä¹ˆä¹Ÿå°±æ»¡è¶³<spanclass="math inline">\(\sum\limits_{i=1}\limits^{200}e_i\cdotm_i=\vec{0}\)</span></p><h3 id="x02-æ±‚è§£-mask">0x02 æ±‚è§£ mask</h3><p>x=mask</p><p><span class="math display">\[65537^{\sum2^i\cdot(x_i\oplus m_i)}=c(mod \;p)\]</span></p><p>å˜æ¢æˆå¦‚ä¸‹å½¢å¼</p><p><spanclass="math display">\[(65537)^{\sum\limits_{\{i|m_i=0\}}2^i\cdotx_i+\sum\limits_{\{j|m_j=1\}}2^j\cdot(1-x_j)}=c\;(mod \;p)\]</span></p><p><spanclass="math display">\[(65537)^{\sum\limits_{\{i|m_i=0\}}2^i\cdotx_i+\sum\limits_{\{j|m_j=1\}}2^j\cdot(-x_j)}=c\cdot65537^{-\sum\limits_{\{j|m_j=1\}}2^j} (mod \;p)\]</span></p><p>æ ¹æ®ä¸Šå¼ä¸­<span class="math inline">\(m_i\)</span>ä¸º 0 æˆ– 1çš„æƒ…å†µæ„é€ å¯¹åº”<span class="math inline">\(x_i\)</span>çš„ç³»æ•°çŸ©é˜µ<spanclass="math inline">\(A\)</span>ï¼Œç³»æ•°åªä¸º 1 æˆ–-1</p><p>è®¡ç®—å‘é‡<span class="math inline">\(u\cdot A=(1,0,\cdots,0)\;(mod\;q)\)</span>ï¼ˆæ¨¡ q æ˜¯ä¿è¯é˜¶ä¸ºç´ æ•°ï¼Œä½¿å¾—å‘é‡æœ‰è§£ï¼‰</p><p>å½“<span class="math inline">\(mask_i=0\)</span>æ—¶ï¼Œä¾¿å¯æŒ‰ä¸‹å¼é€ä½æ¢å¤mask</p><p><spanclass="math display">\[\prod\limits_{i=1}\limits^{200}c_i^{u_i}=65537^0=1(mod\;p)\]</span><span class="math display">\[c_i=c_i\cdot65537^{-\sum\limits_{\{j|m_j=1\}}2^j}(mod\;p)\]</span></p><h3 id="exp">exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> tqdm <span class="hljs-keyword">import</span> tqdm<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">from</span> ast <span class="hljs-keyword">import</span> literal_eval<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br><br>lines = <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;./output.txt&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>).readlines()<br>message = literal_eval(lines[<span class="hljs-number">0</span>].strip())<br>enc = literal_eval(lines[<span class="hljs-number">1</span>].strip())<br><br><br>m_l = <span class="hljs-number">159</span><br>dim = <span class="hljs-number">200</span><br>L = matrix(ZZ, dim, dim+m_l+<span class="hljs-number">1</span>)<br>g = <span class="hljs-number">2</span> ^ <span class="hljs-number">512</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(dim):<br>    L[i, i] = <span class="hljs-number">1</span><br>    L[i, dim+m_l] = g<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(dim):<br>    line = <span class="hljs-built_in">bin</span>(message[i])[<span class="hljs-number">2</span>:].rjust(m_l, <span class="hljs-string">&#x27;0&#x27;</span>)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(line)):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(line[j]):<br>            L[i, dim+j] = g<br>        <span class="hljs-keyword">else</span>:<br>            L[i, dim+j] = <span class="hljs-number">0</span><br><br><br>basis = L.LLL()[:<span class="hljs-number">40</span>]<br>p = []<br><span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> basis:<br>    g1 = <span class="hljs-number">1</span><br>    g2 = <span class="hljs-number">1</span><br>    vec = item[:dim]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(vec)):<br>        <span class="hljs-keyword">if</span> vec[i] &gt;= <span class="hljs-number">0</span>:<br>            g1 *= <span class="hljs-built_in">pow</span>(enc[i], vec[i])<br>        <span class="hljs-keyword">else</span>:<br>            g2 *= <span class="hljs-built_in">pow</span>(enc[i], -vec[i])<br>    p.append(g1-g2)<br><br>p = <span class="hljs-built_in">list</span>(factor(reduce(GCD, p)))[-<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]<br>q = (p-<span class="hljs-number">1</span>)//<span class="hljs-number">2</span><br>A = matrix(Zmod(q), dim, m_l)<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(dim):<br>    line = <span class="hljs-built_in">bin</span>(message[i])[<span class="hljs-number">2</span>:].rjust(m_l, <span class="hljs-string">&#x27;0&#x27;</span>)<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(line)):<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">int</span>(line[j]):<br>            A[i, j] = -<span class="hljs-number">1</span><br>            enc[i] = enc[i]*inverse_mod(<span class="hljs-built_in">pow</span>(<span class="hljs-number">0x10001</span>, <span class="hljs-number">2</span> ^ (m_l-<span class="hljs-number">1</span>-j), p), p) % p<br>        <span class="hljs-keyword">else</span>:<br>            A[i, j] = <span class="hljs-number">1</span><br><br>m = <span class="hljs-string">&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> tqdm(<span class="hljs-built_in">range</span>(m_l)):<br>    v = vector(Zmod(q), [<span class="hljs-number">0</span>]*_+[<span class="hljs-number">1</span>]+[<span class="hljs-number">0</span>]*(m_l-<span class="hljs-number">1</span>-_))<br>    u = A.solve_left(v)<br>    sign = <span class="hljs-number">1</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(u)):<br>        <span class="hljs-keyword">if</span> u[i] &gt;= <span class="hljs-number">0</span>:<br>            sign = sign*<span class="hljs-built_in">pow</span>(enc[i], <span class="hljs-built_in">int</span>(u[i]), p) % p<br>        <span class="hljs-keyword">else</span>:<br>            sign = sign*inverse_mod(<span class="hljs-built_in">pow</span>(enc[i], -<span class="hljs-built_in">int</span>(u[i]), p), p) % p<br>    <span class="hljs-keyword">if</span> sign != <span class="hljs-number">1</span>:<br>        m += <span class="hljs-string">&#x27;1&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        m += <span class="hljs-string">&#x27;0&#x27;</span><br><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-built_in">hex</span>(<span class="hljs-built_in">int</span>(m, <span class="hljs-number">2</span>))[<span class="hljs-number">2</span>:]))<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>LCG</title>
    <link href="/2023/06/19/LCG/"/>
    <url>/2023/06/19/LCG/</url>
    
    <content type="html"><![CDATA[<h2 id="LCG"><a class="header-anchor" href="#LCG">Â¶</a>LCG</h2><p>çº¿æ€§åŒä½™ï¼ˆLCGï¼‰æ˜¯äº§ç”Ÿä¼ªéšæœºæ•°çš„æ–¹æ³•ã€‚</p><h2 id="åŸºæœ¬å½¢å¼ï¼š"><a class="header-anchor" href="#åŸºæœ¬å½¢å¼ï¼š">Â¶</a>åŸºæœ¬å½¢å¼ï¼š</h2><p>$$<br>X_{n+1}=(aX_n+b);mod;m<br>$$</p><h2 id="åŸºæœ¬å…¬å¼"><a class="header-anchor" href="#åŸºæœ¬å…¬å¼">Â¶</a>åŸºæœ¬å…¬å¼</h2><h3 id="å…¬å¼ä¸€"><a class="header-anchor" href="#å…¬å¼ä¸€">Â¶</a>å…¬å¼ä¸€</h3><p><strong>æ±‚é€’å½’æ•°ç»„å…ƒç´ </strong></p><p>$$X_n=a^{-1}(X_{n+1}-b);mod;m$$</p><h3 id="å…¬å¼äºŒ"><a class="header-anchor" href="#å…¬å¼äºŒ">Â¶</a>å…¬å¼äºŒ</h3><p><strong>æ±‚å‚æ•° a</strong><br>åˆ©ç”¨ä¸¤ä¸ªé€’å½’å¼æ¶ˆå» b å¾—åˆ° a</p><p>$$a=(X_{n+2}-X_{n+1})(X_{n+1}-X_n)^{-1}$$</p><h3 id="å…¬å¼ä¸‰"><a class="header-anchor" href="#å…¬å¼ä¸‰">Â¶</a>å…¬å¼ä¸‰</h3><p><strong>æ±‚å‚æ•° b</strong><br>$$b=(X_{n+1}-aX_{n});mod;m$$</p><h3 id="å…¬å¼å››"><a class="header-anchor" href="#å…¬å¼å››">Â¶</a>å…¬å¼å››</h3><p><strong>æ±‚å‚æ•° m</strong></p><p>$$t_n=X_{n+1}-X_n$$<br>$$t_n=(aX_n+b)-(aX_{n-1}+b);mod;m$$<br>$$t_{n+1}t_{n-1}-t_nt_n=0;mod;m$$<br>$$T_n=t_{n+1}t_{n-1}-t_nt_næ˜¯ m çš„å€æ•°$$<br>$$m=gcd(T_n,T_{n-1})$$</p><h2 id="ç›¸å…³æ±‚è§£ä»£ç "><a class="header-anchor" href="#ç›¸å…³æ±‚è§£ä»£ç ">Â¶</a>ç›¸å…³æ±‚è§£ä»£ç </h2><p>&lt;!â€“codeï¿¼0â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>D^3CTF</title>
    <link href="/2023/05/07/d3ctf2023/"/>
    <url>/2023/05/07/d3ctf2023/</url>
    
    <content type="html"><![CDATA[<h1>d3noisy</h1><p>&lt;!â€“codeï¿¼0â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>RSA(æŒç»­æ›´æ–°ğŸ«¡)</title>
    <link href="/2023/04/20/RSA/"/>
    <url>/2023/04/20/RSA/</url>
    
    <content type="html"><![CDATA[<h1>åŸºæœ¬åŸç†</h1><p>RSA ä¸­åŠ ã€è§£å¯†ï¼š</p><p>åŠ å¯†$c = m^e\quad mod\quad n$</p><p>è§£å¯†$m = c^d\quad mod\quad n$</p><p>æ¥ä¸‹æ¥è¯æ˜ä¸€ä¸‹è§£å¯†è¿‡ç¨‹ï¼Œå…ˆå¼•å…¥æ¬§æ‹‰å®šç†ã€‚</p><h2 id="æ¬§æ‹‰å®šç†"><a class="header-anchor" href="#æ¬§æ‹‰å®šç†">Â¶</a>æ¬§æ‹‰å®šç†</h2><p>å¯¹äºäº’ä¸ºè´¨æ•°çš„ mã€n ä¸¤ä¸ªæ•°ï¼Œæœ‰$m^{\phi(n)} = 1\quad mod\quad n$ï¼Œå…¶ä¸­$\phi(n)$è¡¨ç¤ºå°äº n çš„è´¨æ•°çš„ä¸ªæ•°ã€‚</p><h2 id="è§£å¯†åŸç†"><a class="header-anchor" href="#è§£å¯†åŸç†">Â¶</a>è§£å¯†åŸç†</h2><p>é€šè¿‡$c = m^e\quad mod\quad n$ä¸æ¬§æ‹‰å®šç†$m^{\phi(n)} = 1\quad mod\quad n$ï¼Œæˆ‘ä»¬ä¾¿å¯è¿›è¡Œæ¨å¯¼ã€‚</p><p>å¯¹æ¬§æ‹‰å®šç†è¿›è¡Œå˜å½¢ï¼Œå¾—åˆ°$m^{k\phi(n)+1} = m\quad mod\quad n$</p><p>å› ä¸ºæˆ‘ä»¬å·²ç»çŸ¥é“$c = m^e\quad mod\quad n$ï¼Œæ‰€ä»¥å¯»æ‰¾ä¸€ä¸ª dï¼Œä½¿å¾—$ed = k\phi(n)+1$,åˆ™å¯ä»¥å¾—åˆ°$m^{ed}=m\quad mod \quad n$</p><p>åˆ™å¾—åˆ°äº†$c^d =m\quad mod\quad n$</p><h1>å…±æ¨¡æ”»å‡»</h1><p>æ‰€è°“å…±æ¨¡ï¼Œå°±æ˜¯ n ç›¸åŒï¼Œä¼šå¯¹åº”å¤šç»„ cï¼Œeã€‚</p><p>ä¾‹ï¼šç»™å®š nã€c1ã€c2ã€e1ã€e2</p><p>m = c<sub>1</sub><sup>e1</sup> mod n</p><p>m = c<sub>2</sub><sup>e2</sup> mod n</p><h2 id="æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•"><a class="header-anchor" href="#æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•">Â¶</a>æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•</h2><p>ç»™å®šä¸¤ä¸ªæ•´æ•° aã€bï¼Œå¿…å®šå­˜åœ¨ xã€yï¼Œä½¿å¾— gcd(a,b)=ax+by</p><p>è¿ç”¨è¯¥ç®—æ³•æ¨å¯¼è¿‡ç¨‹</p><p>m = m % n</p><p>m = m<sup>s1e1+s2e2</sup> % n</p><p>m = (m<sup>e1s1</sup> * m<sup>e2s2</sup>)% n</p><p>m = (m<sup>e1s1</sup> % n) * (m<sup>e2s2</sup> % n) % n</p><p>m = (c1<sup>s1</sup> % n) * (c2<sup>s2</sup> % n) % n</p><h2 id="EXP"><a class="header-anchor" href="#EXP">Â¶</a>EXP</h2><p>&lt;!â€“codeï¿¼0â€“&gt;</p><h1>Wienerâ€™s Attack</h1><p>é€‚ç”¨äºå·²çŸ¥ Nã€eï¼Œä¸” e è¿‡å¤§æˆ–è¿‡å°ã€‚</p><p>Wiener è¡¨ç¤ºå¦‚æœ$d&lt;\frac{1}{3}n^{\frac{1}{4}}$,é‚£ä¹ˆä¸€ç§åŸºäº<strong>è¿åˆ†æ•°</strong>çš„æ”»å‡»å°±å¯å±åŠ RSA å®‰å…¨ã€‚</p><p>é‚£ä¹ˆä»€ä¹ˆæ˜¯è¿åˆ†æ•°ä»¥åŠå¦‚ä½•åˆ©ç”¨å‘¢ï¼Ÿ</p><h2 id="è¿åˆ†æ•°"><a class="header-anchor" href="#è¿åˆ†æ•°">Â¶</a>è¿åˆ†æ•°</h2><p>å½“ $a_0, a_1, a_2, \dots, a_n$ éƒ½æ˜¯æ­£æ•´æ•°æ—¶ï¼Œä¸€ä¸ªè¿åˆ†æ•°å¯ä»¥è¡¨ç¤ºä¸ºï¼š<br>$$x;=;a_0 + \cfrac{1}{a_1 + \cfrac{1}{a_2 + \cfrac{1}{\ddots + \cfrac{1}{a_n}}}}$$</p><p>ä¾‹å¦‚æˆ‘ä»¬å¯ä»¥æ±‚è§£$\pi$çš„è¿‘ä¼¼å€¼<br>$$\pi = 3 + \cfrac{1}{7 + \cfrac{1^2}{15 + \cfrac{2^2}{1 + \cfrac{3^2}{1 + \cfrac{4^2}{2 + \cdots}}}}}$$<br>å…¶ä¸­æ¯ä¸€é¡¹å¯ä»¥ç”¨å¦‚ä¸‹å…¬å¼è®¡ç®—ï¼š</p><p>$$<br>a_k = \begin{cases}<br>a_0, &amp; k=0 \<br>\lfloor b_k \rfloor, &amp; k &gt; 0<br>\end{cases}\<br>$$</p><p>$$<br>b_k = \begin{cases}<br>a_0, &amp; k=0 \<br>\dfrac{1}{b_{k-1} - \lfloor b_{k-1} \rfloor}, &amp; k &gt; 0<br>\end{cases}<br>$$</p><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ$a_0 = 3$ï¼Œå¹¶ä¸”æŒ‰ç…§ä¸Šè¿°å…¬å¼é€’å½’è®¡ç®— $a_k$ å’Œ $b_k$ ç›´åˆ°è¾¾åˆ°ä¸€å®šç²¾åº¦ä¸ºæ­¢ï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªè¿‘ä¼¼å€¼ $\pi \approx 3.14159265$ã€‚</p><p>è‡³æ­¤ä¹Ÿå°±æ˜ç™½äº†è¿åˆ†æ•°çš„ä½œç”¨ï¼Œå¸¸ç”¨äºæ— ç†æ•°çš„é€¼è¿‘ã€‚</p><p>å½“ç„¶ï¼Œä¹Ÿå¯ä»¥é€¼è¿‘ä¸€ä¸ªä»»æ„æ•°ï¼Œå¾—åˆ°æœ€æ¥è¿‘ç²¾ç¡®å€¼çš„è¿‘ä¼¼å€¼ã€‚</p><h2 id="Legendreâ€™s-theorem"><a class="header-anchor" href="#Legendreâ€™s-theorem">Â¶</a>Legendreâ€™s theorem</h2><p>$$\left | \frac{e}{N}-\frac{k}{d} \right |\leq \frac{1}{2d^2}$$<br>å½“æ»¡è¶³è¿™ä¸€ç‚¹æ—¶ï¼Œ$\frac{k}{d}$å°±æ˜¯$\frac{e}{N}$çš„è¿åˆ†æ•°æ”¶æ•›ã€‚</p><h2 id="æ”»å‡»-RSA-åŸç†"><a class="header-anchor" href="#æ”»å‡»-RSA-åŸç†">Â¶</a>æ”»å‡» RSA åŸç†</h2><p>$$\phi(n)=(p-1)(q-1)$$</p><p>$$\because p,qå¾ˆå¤§,\therefore \phi(n) \approx N$$<br>$$ed - 1=k\phi(n)$$<br>åŒé™¤ $d\phi(n)$ å¾—<br>$$\frac{e}{\phi(n)}-\frac{k}{d}=\frac{1}{d\phi(n)}$$<br>$$\therefore \frac{e}{N}-\frac{k}{d}=\frac{1}{d\phi(n)}$$</p><p>åˆ°è¿™é‡Œå‘ç°ï¼Œç­‰å¼å³è¾¹çš„$\frac{1}{d\phi(n)}$å¾ˆå°ï¼Œå› æ­¤$\frac{k}{d}$å°±æ˜¯ä¸€ä¸ªå¯¹äºå·²çŸ¥é‡$\frac{e}{N}$çš„ä¸€ä¸ªè¿åˆ†æ•°é€¼è¿‘ã€‚</p><p>å› æ­¤å¯ä»¥é€šè¿‡å°†$\frac{e}{N}$çš„è¿åˆ†æ•°å±•å¼€ï¼Œä¾æ¬¡è®¡ç®—æ¯ä¸€ä¸ªæ¸è¿›åˆ†æ•°ã€‚Wiener è¯æ˜äº†å¯ä»¥ç²¾å‡†è¦†ç›–$\frac{k}{d}$ã€‚</p><h2 id="exp"><a class="header-anchor" href="#exp">Â¶</a>exp</h2><p>&lt;!â€“codeï¿¼1â€“&gt;</p><h1>Extending Wienerâ€™s Attack</h1><p>æ‰©å±•ç»´çº³æ”»å‡»æ˜¯ä¸ºäº†æ‰©å±•åˆ°$n$ä¸ªåŠ å¯†æŒ‡æ•°$e_i$,ä¸”$d_i$éƒ½è¾ƒå°çš„æƒ…å†µã€‚<br>ç”±$e<em>d-k</em>\lambda(N)=1$å¾—</p><p>$$d_ige_i-k_iN=g+k_is$$</p><p>è®°ä¸ºç»´çº³ç­‰å¼$W_i$ã€‚</p><p>åˆ©ç”¨ Guo çš„æ–¹æ³•å¯å¾—åˆ°å…³ç³»å¼:<br>$$k_id_je_j-k_jd_ie_i=k_i-k_j$$</p><p>è®°ä¸ºéƒ­ç­‰å¼$G_{i,j}$ã€‚æ³¨æ„åˆ°ä¸¤ç§ç­‰å¼çš„å³ä¾§éƒ½éå¸¸å°ã€‚</p><p>å‚è€ƒè®ºæ–‡å’Œ wiki ä¸­çš„åšæ³•ï¼Œåç»­çš„æ€è·¯æ˜¯ä½¿ç”¨è¿™ä¸¤ä¸ªå¼å­çš„ä¸åŒå…³ç³»å»æ„é€ æ ¼ï¼Œè¿›è€Œæ ¼åŸºçº¦åŒ–æ±‚å¾—$\phi(N)$æ¥å®ç°$N$çš„åˆ†è§£ã€‚</p><h2 id="ä¸¤ä¸ªå°è§£å¯†æŒ‡æ•°"><a class="header-anchor" href="#ä¸¤ä¸ªå°è§£å¯†æŒ‡æ•°">Â¶</a>ä¸¤ä¸ªå°è§£å¯†æŒ‡æ•°</h2><h2 id="ä¸‰ä¸ªå°è§£å¯†æŒ‡æ•°"><a class="header-anchor" href="#ä¸‰ä¸ªå°è§£å¯†æŒ‡æ•°">Â¶</a>ä¸‰ä¸ªå°è§£å¯†æŒ‡æ•°</h2><h1>ä½åŠ å¯†æŒ‡æ•°æ”»å‡» e=3</h1><p>&lt;!â€“codeï¿¼2â€“&gt;</p><h1>ä½åŠ å¯†æŒ‡æ•°å¹¿æ’­æ”»å‡»</h1><p>ç‰¹ç‚¹æ˜¯ e å°ï¼Œæœ‰å¤šç»„ nï¼Œå¯¹åº”äº†å¤šç»„ c</p><p>m<sup>e</sup> = c1 mod n1</p><p>m<sup>e</sup> = c2 mod n2</p><p>m<sup>e</sup> = c3 mod n3</p><h2 id="ä¸­å›½å‰©ä½™å®šç†-CRT"><a class="header-anchor" href="#ä¸­å›½å‰©ä½™å®šç†-CRT">Â¶</a>ä¸­å›½å‰©ä½™å®šç†(CRT)</h2><p>å®šç†å†…å®¹å¦‚ä¸‹</p><p>é’ˆå¯¹ä¸Šè¿°æ–¹ç¨‹ç»„ï¼Œè‹¥ n1ã€n2ã€n3 äº’è´¨ï¼Œå¯¹äºä»»æ„çš„ c1ã€c2ã€c3ï¼Œæ–¹ç¨‹ç»„éƒ½æœ‰è§£ mã€‚</p><p>ä½¿ç”¨æ¡ä»¶æ˜¯ m^e &lt; n1ã€n2ã€n3ã€‚é€šè§£æ¨å¯¼å¦‚ä¸‹ï¼š</p><p>è®¾$N=n_1 \times n_2 \times n_3, N_1=N/n_1, N_2=N/n_2, N_3=N/n_3$</p><p>è®¾$t_i=N_i^{-1}$,è¿™é‡Œè¡¨ç¤º$t_i$æ˜¯$N_i$åœ¨æ¨¡$n_i$çš„é€†å…ƒã€‚</p><p>æœ‰äº†ä»¥ä¸Šå‡ ä¸ªæ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å‡ºé€šè§£å½¢å¼ï¼š</p><p>$$m=c_1t_1N_1+c_2t_2N_2+c_3t_3N_3+kN=kN+\sum_{i=1}^3c_it_iN_i$$</p><p>åœ¨æ¨¡ N åï¼Œåªå‰©å”¯ä¸€è§£$m=\sum_{i=1}^3c_it_iN_i$</p><h2 id="EXP-v2"><a class="header-anchor" href="#EXP-v2">Â¶</a>EXP</h2><p>&lt;!â€“codeï¿¼3â€“&gt;</p><h1>dpã€dq ç›¸å…³</h1><h2 id="ç»™å®š-dpã€dq-ç±»å‹"><a class="header-anchor" href="#ç»™å®š-dpã€dq-ç±»å‹">Â¶</a>ç»™å®š dpã€dq ç±»å‹</h2><p>dp â‰¡ d mod (p-1)</p><p>dq â‰¡ d mod (q-1)</p><p>m â‰¡ c<sup>d</sup> mod n</p><p>m = c<sup>d</sup> + k * n</p><p>m = c<sup>d</sup> +k _ p _ q</p><p>å¯¹ä¸Šå¼ä¸¤ç«¯åŒæ—¶å¯¹ pã€q åˆ†åˆ«å–ä½™ï¼Œå¾—ï¼šï¼ˆä¸­å›½å‰©ä½™å®šç†ï¼‰</p><p>m1 â‰¡ c<sup>d</sup> mod p</p><p>m2 â‰¡ c<sup>d</sup> mod q</p><p>åŒç†ï¼Œå¯å¾—åˆ°<br>c<sup>d</sup> = m1 +k * p</p><p>ä»£å…¥åˆ° m2 â‰¡ c<sup>d</sup> mod q ä¸­ï¼š</p><p>m2 â‰¡ (m1 + k * p)mod q ï¼Œä¸¤ç«¯å‡å» m1 å¾—</p><p>m2 - m1 â‰¡ k * p mod q ï¼Œä¸¤ç«¯ä¹˜ p çš„é€†å…ƒå¾—</p><p>(m2 - m1)p<sup>-1</sup> â‰¡ k mod q</p><p>å°† k ä»£å…¥åˆ° c<sup>d</sup> = m1 +k * p ä¸­å¾—ï¼š</p><p>c<sup>d</sup> = m1 + ((m2 - m1)p<sup>-1</sup> mod q) * p</p><p>m=c<sup>d</sup> mod n</p><p>å¾—åˆ°</p><p>m â‰¡ (((m2 - m1) _ p<sup>-1</sup> mod q) _ p + m1) mod n</p><p>æ¥ä¸‹æ¥å°±æ˜¯æ±‚è§£ m1ï¼Œm2</p><p>m1 â‰¡ c<sup>dp+k(p-1)</sup> mod p</p><p>m2 â‰¡ c<sup>dq+k(q-1)</sup> mod q</p><p>æ ¹æ®è´¹é©¬å°å®šç†</p><p>è‹¥ p æ˜¯ç´ æ•°ï¼Œåˆ™ a<sup>(p-1)</sup> â‰¡ 1 mod p</p><p>å› æ­¤ m1 â‰¡ c<sup>dp</sup> mod pï¼Œm2 â‰¡ c<sup>dq</sup> mod q</p><p>æœ€ç»ˆå¯æ±‚å¾— m</p><h3 id="EXP-v3"><a class="header-anchor" href="#EXP-v3">Â¶</a>EXP</h3><p>&lt;!â€“codeï¿¼4â€“&gt;</p><h2 id="åªç»™å®š-dp"><a class="header-anchor" href="#åªç»™å®š-dp">Â¶</a>åªç»™å®š dp</h2><p>dp â‰¡ d mod (p-1)</p><p>ed â‰¡ 1 mod (p-1) * (q-1)</p><p>ed = 1 + k2(p-1)(q-1)</p><p>å¯¹ 1 å¼ä¸¤ç«¯åŒä¹˜ eï¼Œå¾—</p><p>e * dp â‰¡ ed mod (p-1)</p><p>e * dp = k1(p-1) + ed</p><p>ä»£å…¥ ed å¾—</p><p>e * dp = k1(p-1) + 1 + k2(p-1)(q-1)</p><p>ç”±äºä¸¤ä¸ªæœªçŸ¥æ•°ç•¥æ˜¾éº»çƒ¦ï¼Œå‘ç°å…¬å› å­(p-1)ï¼Œç­‰å¼ä¸¤è¾¹åŒæ—¶å–ä½™ p-1ï¼Œå³å¯æ¶ˆæ‰ n</p><p>e * dp â‰¡ 1 mod (p-1)</p><p>e * dp =k(p-1) + 1</p><p>å¾—åˆ°è¿™ä¸ªå¼å­åï¼Œå…¶å®çœŸæ­£æ„ä¹‰ä¸Šçš„æœªçŸ¥æ•°åªæœ‰æˆ‘ä»¬è¦æ±‚çš„ pï¼Œä½†æ˜¯è¿˜å­˜åœ¨ä¸€ä¸ª kã€‚</p><p>é’ˆå¯¹ kï¼Œæˆ‘ä»¬åˆ¤æ–­ä¸€ä¸‹ä»–çš„èŒƒå›´ï¼Œçœ‹çœ‹èƒ½å¦é‡‡ç”¨çˆ†ç ´çš„æ–¹å¼ã€‚</p><p>k = (e * dp - 1)/(p-1)</p><p>å› ä¸º dp &lt; p-1</p><p>æ‰€ä»¥ k &lt; e</p><p>é€šè¿‡éå† k ç„¶åæ‰¾åˆ°(e * dp - 1)å¯ä»¥æ•´é™¤ k çš„æƒ…å†µå³å¯ã€‚</p><p>(è·‘äº†ä¸€ä¸‹å‘ç°é™åˆ¶æ¡ä»¶è¿˜ä¸å¤Ÿ)</p><p>å› æ­¤å†åŠ ä¸€ä¸ª n èƒ½å¦æ•´é™¤ p å³å¯ã€‚</p><h3 id="EXP-v4"><a class="header-anchor" href="#EXP-v4">Â¶</a>EXP</h3><p>&lt;!â€“codeï¿¼5â€“&gt;</p><h1>DLP</h1><h2 id="magic-hitcon2021"><a class="header-anchor" href="#magic-hitcon2021">Â¶</a>magic(hitcon2021)</h2><p>&lt;!â€“codeï¿¼6â€“&gt;</p><h3 id="EXP-v5"><a class="header-anchor" href="#EXP-v5">Â¶</a>EXP</h3><h1>rabin</h1><p>é€‚ç”¨äº RSA ä¸­ e=2 çš„æƒ…å†µ</p><h2 id="pqpq-seccon2022"><a class="header-anchor" href="#pqpq-seccon2022">Â¶</a>pqpq(seccon2022)</h2><p>&lt;!â€“codeï¿¼7â€“&gt;</p><h3 id="å¤§è‡´æ€è·¯"><a class="header-anchor" href="#å¤§è‡´æ€è·¯">Â¶</a>å¤§è‡´æ€è·¯</h3><p>æ ¹æ®é¢˜ç›®ï¼Œå¯å…ˆé€šè¿‡è®¡ç®— c1ã€c2 è¡¨è¾¾å¼ï¼Œåˆå¹¶æ‰¾å‡ºå…¬å› å­ï¼Œå³å¯æ±‚å‡º pã€qï¼Œä»è€Œ r ä¹Ÿå¯æ±‚å¾—ã€‚<br>å‘ç° e=65537 * 2ï¼Œå› æ­¤æ˜¯æ— é€†å…ƒå­˜åœ¨çš„ï¼Œç´¢æ€§å°±å°† e æ‹†åˆ†ä¸º 65537 ä¸ 2ï¼Œe2=2 æ—¶ä¾¿å¯é€šè¿‡ Rabin ç®—æ³•è§£å¯†ã€‚</p><h3 id="æ±‚-pã€qã€r"><a class="header-anchor" href="#æ±‚-pã€qã€r">Â¶</a>æ±‚ pã€qã€r</h3><p>$c2 = (p - q)^e \mod n \$<br>å·¦å³åŒä¹˜ r<br>$c2 * r = rp^e + rq^e + X*pqr = rp^e + rq^e \mod n\$<br>$c2 = p^e + q^e \mod n\$<br>åŒç†å¾—åˆ°$c1 = p^e - q^e \mod n \$<br>ä»è€Œæ±‚å¾— pã€q<br>$p=gcd(c1+c2,n)\$</p><p>$q=gcd(c1-c2,n)\$</p><h3 id="æ±‚è§£-m-2"><a class="header-anchor" href="#æ±‚è§£-m-2">Â¶</a>æ±‚è§£ m^2</h3><p>$\phi(n)=(p-1)<em>(q-1)</em>(r-1)\$<br>é€šè¿‡ e1(e/2)å’Œ$\phi(n)$æ±‚å‡º dï¼Œå¾—åˆ°$cm<sup>d=m</sup>{2<em>e1</em>d}=m^2 \mod n$</p><h3 id="Rabin-è§£å¯†"><a class="header-anchor" href="#Rabin-è§£å¯†">Â¶</a>Rabin è§£å¯†</h3><p>æ¥ä¸‹æ¥å°±æ˜¯ä¼ ç»Ÿ Rabin è§£å¯†ï¼Œæ‰¾äº†ä¸¤ç§è„šæœ¬ï¼Œexp ä¸­çš„<code>sqrtPrime(n,p)</code>å’Œ<code>Tonelli_Shanks(n,p)</code>ä»»é€‰å…¶ä¸€å³å¯ï¼Œéƒ½æ˜¯åŸºäºäºŒæ¬¡å‰©ä½™å®šç†æ‰€å®ç°çš„è§£å¯†ç®—æ³•</p><p>&lt;!â€“codeï¿¼8â€“&gt;</p><h1>e ä¸ phi ä¸äº’ç´ </h1><h2 id="GCD-p-1-e-1-GCD-q-1-e-1"><a class="header-anchor" href="#GCD-p-1-e-1-GCD-q-1-e-1">Â¶</a>GCD(p-1,e)!=1 GCD(q-1,e)!=1</h2><p>&lt;!â€“codeï¿¼9â€“&gt;</p><h2 id="m-GCD-n"><a class="header-anchor" href="#m-GCD-n">Â¶</a>m^GCD &lt; n</h2><p>æ±‚å‡º$d*t$åï¼Œå¯¹$m$å¼€$t$æ¬¡æ–¹æ ¹ã€‚</p><p>&lt;!â€“codeï¿¼10â€“&gt;</p><h2 id="m-GCD-n-v2"><a class="header-anchor" href="#m-GCD-n-v2">Â¶</a>m^GCD &gt; n</h2><p>$$t=GCD(e,phi)$$<br>$$d=inverse(e//t,phi)$$<br>$$c=pow(c,d,n)$$<br>ä½¿ç”¨ CRT è¿›è¡Œæœ‰é™åŸŸå¼€æ ¹<br>$$x^t;=c;mod;p$$<br>$$x^t;=c;mod;q$$</p><p>&lt;!â€“codeï¿¼11â€“&gt;</p><h2 id="AMM"><a class="header-anchor" href="#AMM">Â¶</a>AMM</h2><p>é€‚ç”¨äº$e$å¯æ•´é™¤$\phi$çš„æƒ…å†µ</p><p>&lt;!â€“codeï¿¼12â€“&gt;</p><h1>å·²çŸ¥ p^q å’Œ p*q</h1><p>&lt;!â€“codeï¿¼13â€“&gt;</p><h1>æ˜æ–‡ç›¸å…³æ”»å‡»</h1><p>&lt;!â€“codeï¿¼14â€“&gt;</p><p>é€‚ç”¨äº</p><p>$$<br>C_1=M^e ; mod; n \</p><p>C_2=(aM+b)^e ; mod ; n<br>$$</p><p>&lt;!â€“codeï¿¼15â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>ECC(æŒç»­æ›´æ–°ğŸ¥±)</title>
    <link href="/2023/04/19/ECC/"/>
    <url>/2023/04/19/ECC/</url>
    
    <content type="html"><![CDATA[<h1>ECC</h1><p>æ¤­åœ†æ›²çº¿å¯†ç å­¦(Elliptic Curve Cryptography)ï¼Œæ˜¯ä¸€ç§åŸºäºæ¤­åœ†æ›²çº¿æ•°å­¦çš„å…¬é’¥å¯†ç ã€‚</p><p>åŸºäº ECC çš„ä¸‰å¤§é—®é¢˜ï¼š<strong>å¯†é’¥äº¤æ¢</strong>ã€<strong>æ•°å­—ç­¾å</strong>ã€<strong>ç¦»æ•£å¯¹æ•°</strong></p><h2 id="æ¤­åœ†æ›²çº¿"><a class="header-anchor" href="#æ¤­åœ†æ›²çº¿">Â¶</a>æ¤­åœ†æ›²çº¿</h2><p>æ¤­åœ†æ›²çº¿å®šä¹‰å¼ï¼š$y<sup>2;=x</sup>3+ax+b$ï¼Œï¼ˆç»´å°”æ–¯ç‰¹æ‹‰æ–¯æ ‡å‡†å½¢å¼ï¼‰</p><p>æ›²çº¿çš„ä¸€èˆ¬å½¢å¼ï¼š$y<sup>2+a_1xy+a_3y;=x</sup>3+a_2x^2+a_4x+a_6$</p><p>åˆ¤åˆ«å¼$\Delta=-16(4a<sup>3+27b</sup>2);mod;p=0$</p><h3 id="æ›²çº¿æ€§è´¨"><a class="header-anchor" href="#æ›²çº¿æ€§è´¨">Â¶</a>æ›²çº¿æ€§è´¨</h3><p>æ¤­åœ†æ›²çº¿ä¸Šçš„å›°éš¾é—®é¢˜:$Q=nP$ï¼Œç»™å®šæ¤­åœ†æ›²çº¿ä¸Š$Pã€Q$ä¸¤ç‚¹ï¼Œæ±‚$n$ååˆ†å›°éš¾</p><h4 id="point-addition-ç‚¹åŠ æ³•"><a class="header-anchor" href="#point-addition-ç‚¹åŠ æ³•">Â¶</a>point addition ç‚¹åŠ æ³•</h4><p>æ²¿æ›²çº¿çš„ P + Q ä¸¤ç‚¹ç”»ä¸€æ¡é€šè¿‡ä¸¤ç‚¹çš„ç›´çº¿ã€‚ç°åœ¨ç»§ç»­è¿™æ¡çº¿ï¼Œç›´åˆ°å®ƒç¬¬ä¸‰æ¬¡ä¸ä½ çš„æ›²çº¿ç›¸äº¤ã€‚æœ€ååœ¨è¯¥ç‚¹æ²¿ y è½´çš„æ–¹å‘å–åå°„ã€‚<br>$P+Q+Râ€™=0,R=P+Q,Râ€™(x,-y)=R(x,y)$<br><img src="/img/ECClines.png" alt=""></p><h4 id="æœ‰é™åŸŸ"><a class="header-anchor" href="#æœ‰é™åŸŸ">Â¶</a>æœ‰é™åŸŸ</h4><p>å®šä¹‰åœ¨æœ‰é™åŸŸ$F_p$ä¸Šï¼Œé›¶å…ƒæ˜¯$O$</p><p>**ç‚¹çš„é˜¶:**å¯¹äºæ¤­åœ†æ›²çº¿ä¸Šä¸€ç‚¹$P$ï¼Œè‹¥å­˜åœ¨ä¸€ä¸ªæœ€å°çš„æ­£æ•´æ•°$n$ï¼Œä½¿å¾—$nP=O$ï¼Œåˆ™ç§°$n$æ˜¯ç‚¹$P$çš„é˜¶ã€‚</p><p>**æ¤­åœ†æ›²çº¿çš„é˜¶:**æ¯ä¸ªåœ¨æœ‰é™åŸŸä¸Šçš„æ¤­åœ†æ›²çº¿éƒ½ç”±æœ‰é™ä¸ªç‚¹ç»„æˆï¼Œæœ‰å¤šå°‘ä¸ªç‚¹æ¤­åœ†æ›²çº¿çš„é˜¶å°±æ˜¯å¤šå°‘ã€‚</p><h3 id="Sage-ç¯å¢ƒ"><a class="header-anchor" href="#Sage-ç¯å¢ƒ">Â¶</a>Sage ç¯å¢ƒ</h3><p>åœ¨çº¿ç¯å¢ƒ<a href="https://sagecell.sagemath.org/">https://sagecell.sagemath.org/</a></p><p>æœ¬åœ°ç¯å¢ƒ<a href="https://doc.sagemath.org/html/en/installation/index.html">https://doc.sagemath.org/html/en/installation/index.html</a> (æ¨èåœ¨ Linux ç¯å¢ƒæ­å»º)</p><p>åŸºæœ¬è¯­æ³•<a href="https://www.osgeo.cn/sagemath/tutorial/index.html">https://www.osgeo.cn/sagemath/tutorial/index.html</a></p><h4 id="ç®€å•è¿ç®—"><a class="header-anchor" href="#ç®€å•è¿ç®—">Â¶</a>ç®€å•è¿ç®—</h4><p>&lt;!â€“codeï¿¼0â€“&gt;</p><h2 id="ECDHï¼ˆå¯†é’¥äº¤æ¢ï¼‰"><a class="header-anchor" href="#ECDHï¼ˆå¯†é’¥äº¤æ¢ï¼‰">Â¶</a>ECDHï¼ˆå¯†é’¥äº¤æ¢ï¼‰</h2><p>ECDH æ˜¯æ¤­åœ†æ›²çº¿è¿ªè²-èµ«å°”æ›¼ç§˜é’¥äº¤æ¢ï¼ˆElliptic Curve Diffieâ€“Hellman key Exchangeï¼‰ï¼Œä¸»è¦æ˜¯ç”¨æ¥åœ¨ä¸€ä¸ªä¸å®‰å…¨çš„é€šé“ä¸­å»ºç«‹èµ·å®‰å…¨çš„å…±æœ‰åŠ å¯†èµ„æ–™ï¼Œä¸€èˆ¬æ¥è¯´äº¤æ¢çš„éƒ½æ˜¯ç§é’¥ã€‚</p><h3 id="ç®—æ³•äº¤æ¢è¿‡ç¨‹"><a class="header-anchor" href="#ç®—æ³•äº¤æ¢è¿‡ç¨‹">Â¶</a>ç®—æ³•äº¤æ¢è¿‡ç¨‹</h3><p><strong>å…¬æœ‰å‚æ•°</strong>ï¼š$p,g$</p><p><strong>Alice ç§é’¥</strong>ï¼šå¤§æ•´æ•°$a$</p><p><strong>ç”Ÿæˆ Alice å…¬é’¥</strong>ï¼š$A=g^a;\mod;p$</p><p>Alice å°†$A,p,g$ä¼ é€’ç»™ Bob</p><p><strong>Bob ç§é’¥</strong>ï¼šå¤§æ•´æ•°$b$</p><p><strong>ç”Ÿæˆ Bob å…¬é’¥</strong>ï¼š$B=g^b;\mod;p$</p><p><strong>Bob è®¡ç®—å…¬å…±å¯†é’¥</strong>ï¼š$K=A^b;\mod;p$</p><p>Bob å°†$B,p,g$ä¼ é€’ç»™ Alice<br><strong>Alice è®¡ç®—å…¬å…±å¯†é’¥</strong>ï¼š$K=B^a;\mod;p$</p><p>äº¤æ¢å®Œæˆï¼ŒäºŒè€…åå•†å‡º<code>K</code>å…¬å…±å¯†é’¥ï¼Œå¹¶ä¸”æœªåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­æš´éœ² Kã€‚</p><h3 id="An-der-schonen-Elliptische-Kurve"><a class="header-anchor" href="#An-der-schonen-Elliptische-Kurve">Â¶</a>An_der_schonen_Elliptische_Kurve</h3><p>&lt;!â€“codeï¿¼1â€“&gt;</p><h3 id="exp"><a class="header-anchor" href="#exp">Â¶</a>exp</h3><p>&lt;!â€“codeï¿¼2â€“&gt;</p><h2 id="ECDSAï¼ˆæ•°å­—ç­¾åï¼‰"><a class="header-anchor" href="#ECDSAï¼ˆæ•°å­—ç­¾åï¼‰">Â¶</a>ECDSAï¼ˆæ•°å­—ç­¾åï¼‰</h2><p>åŸºäºæ¤­åœ†æ›²çº¿çš„ DSA</p><h3 id="åœºæ™¯"><a class="header-anchor" href="#åœºæ™¯">Â¶</a>åœºæ™¯</h3><p>Alice æƒ³è¦ä½¿ç”¨å¥¹çš„ç§é’¥$d_A$æ¥ç­¾åï¼ŒBob æƒ³ç”¨ Alice çš„å…¬é’¥ $H_A$è¦éªŒè¯ç­¾å$H_A=d_AG$ã€‚<br>åªæœ‰ Alice æ‰èƒ½æä¾›æ­£ç¡®çš„ç­¾åï¼Œè€Œæ¯ä¸ªäººéƒ½å¯ä»¥éªŒè¯ç­¾åã€‚</p><h3 id="ç­¾å"><a class="header-anchor" href="#ç­¾å">Â¶</a>ç­¾å</h3><p>1.é€‰å®šä¸€æ¡æ¤­åœ†æ›²çº¿$E_p(a,b)$ã€‚</p><p>2.é€‰å–ä¸€ä¸ªéšæœºæ•°$k,1&lt;k&lt;n-1$ï¼Œ$n$ä¸ºæ¤­åœ†æ›²çº¿çš„é˜¶ã€‚</p><p>3.é€‰å–æ¤­åœ†æ›²çº¿çš„åŸºç‚¹$G(a,b)$,è®¡ç®— $K=k * G(a,b)$ï¼Œä»¤$r=K[0]\mod n$ï¼Œå³ r æ˜¯ K ç‚¹çš„æ¨ªåæ ‡ï¼ˆè‹¥ r ä¸º 0ï¼Œé‡æ–°é€‰ k è¿›è¡Œè®¡ç®—ï¼‰ã€‚</p><p>4.è®¡ç®—æ˜æ–‡ M çš„å“ˆå¸Œï¼Œä»¤$e=hash(M)$ï¼Œè®¡ç®—$s=k^{-1}(z+rd_A)\mod n$ã€‚</p><p>5.ç»™å‡ºç­¾å$(r,s)$</p><h3 id="éªŒè¯"><a class="header-anchor" href="#éªŒè¯">Â¶</a>éªŒè¯</h3><p>1.è®¡ç®— $u_1=s^{-1}z\mod n$</p><p>2.è®¡ç®— $u_2=s^{-1}r\mod n$</p><p>3.è®¡ç®—ç‚¹$P=u_1G+u_2H_A$</p><p>å½“$r=x_P\mod n$æ—¶ï¼Œç­¾åéªŒè¯æˆåŠŸã€‚</p><h3 id="DSA-LCG"><a class="header-anchor" href="#DSA-LCG">Â¶</a>DSA-LCG</h3><p><a href="https://cseweb.ucsd.edu/~mihir/papers/dss-lcg.pdf">è¯•è¯•è¿™ä¸ª</a></p><p>&lt;!â€“codeï¿¼3â€“&gt;</p><h2 id="ECDLPï¼ˆç¦»æ•£å¯¹æ•°ï¼‰"><a class="header-anchor" href="#ECDLPï¼ˆç¦»æ•£å¯¹æ•°ï¼‰">Â¶</a>ECDLPï¼ˆç¦»æ•£å¯¹æ•°ï¼‰</h2><p>ç»™å®šæ¤­åœ†æ›²çº¿ Eï¼Œå·²çŸ¥ Pã€Q ä»¥åŠ$Q=kP$ï¼Œæ±‚ kã€‚</p><p>&lt;!â€“codeï¿¼4â€“&gt;</p><h3 id="PH-å…‰æ»‘é˜¶åˆ†è§£"><a class="header-anchor" href="#PH-å…‰æ»‘é˜¶åˆ†è§£">Â¶</a>PH å…‰æ»‘é˜¶åˆ†è§£</h3><h4 id="crypto-sign-in-1-VNCTF2023"><a class="header-anchor" href="#crypto-sign-in-1-VNCTF2023">Â¶</a>crypto-sign-in-1(VNCTF2023)</h4><p>ä¸€é“ ECDLP é¢˜ç›®ï¼Œå½“æ—¶æƒ³åˆ°ä½¿ç”¨<code>Pohlig-Hellman</code>ç®—æ³•ï¼Œä½†æ˜¯ä¸€ç›´æ²¡èƒ½æ‰¾åˆ°åˆé€‚çš„ Aã€B æ¥ç¡®å®š G çš„é˜¶ nï¼Œèµ›åçœ‹å¤§ä½¬ wpï¼Œæœç„¶æ˜¯ç”¨ pwntools è¿œç¨‹å¤šè¯•å‡ ç»„ y1ã€y2ï¼Œæ‰¾åˆ°å…‰æ»‘çš„é˜¶ï¼Œä»è€Œè§£å¯†æˆåŠŸã€‚</p><p>&lt;!â€“codeï¿¼5â€“&gt;</p><h4 id="EXP"><a class="header-anchor" href="#EXP">Â¶</a>EXP</h4><p>&lt;!â€“codeï¿¼6â€“&gt;</p><h3 id="Singular-Attack"><a class="header-anchor" href="#Singular-Attack">Â¶</a>Singular Attack</h3><p>åˆ©ç”¨æ›²çº¿ä¸Šçš„å¥‡å¼‚ç‚¹è¿›è¡Œæ”»å‡»ï¼Œå¥‡ç‚¹å°±æ˜¯è¯¥ç‚¹å¯¼æ•°ä¸å­˜åœ¨ï¼Œæˆ–è€…å¯¼æ•°ä¸º 0 ä½†ä¸æ˜¯æå€¼ç‚¹ã€‚<br>è‹¥æ¤­åœ†æ›²çº¿çš„åˆ¤åˆ«å¼$\Delta=-16(4a<sup>3+27b</sup>2);mod;p=0$ï¼Œè¯´æ˜è¯¥æ›²çº¿æœ‰å¥‡ç‚¹ã€‚</p><h4 id="RWCTF2023-ä½“éªŒèµ›"><a class="header-anchor" href="#RWCTF2023-ä½“éªŒèµ›">Â¶</a>RWCTF2023 ä½“éªŒèµ›</h4><p>&lt;!â€“codeï¿¼7â€“&gt;</p><p>æ ¹æ®é¢˜ç›®ï¼Œå¯å¾—åˆ°æ›²çº¿å…³äº x çš„å¯¼æ•°ï¼Œ$3x<sup>2+4x+1$ï¼Œæ‰€ä»¥å¯å¾—åˆ°æ–¹ç¨‹ä¸º$y</sup>2=x<sup>3+2x</sup>2+x+C$</p><p>é¢˜ç›®å·²çŸ¥ç‚¹(4,10)åœ¨æ›²çº¿ä¸Šï¼Œä»£å…¥å¾—åˆ° 100 = 64 + 32 + 4 + Cï¼Œå³ C = 0ï¼Œæ‰€ä»¥æ–¹ç¨‹ç¡®å®š$y<sup>2=x</sup>3+2x^2+x$</p><p>æ–¹ç¨‹å·¦å³æ±‚å¯¼å¾—åˆ°$2y \frac{dy}{dx}=3x^2+4x+1$ï¼Œæ‰€ä»¥å½“ y=0 æ—¶å¯¼æ•°ä¸å­˜åœ¨ï¼Œå†æŠŠ y=0 ä»£å…¥æ–¹ç¨‹ï¼Œæ±‚å¾— x=-1ï¼Œæ‰€ä»¥æ‰¾åˆ°è¯¥æ›²çº¿çš„å¥‡ç‚¹ä¸º(-1,0)ã€‚</p><p>ä¸‹ä¸€æ­¥æˆ‘ä»¬æŠŠæ›²çº¿å¹³ç§»ï¼Œä½¿å¾—æ›²çº¿ä»¥(0,0)ä¸ºå¥‡ç‚¹ï¼Œå¾—åˆ°<code>y^2 = x^3 + 193387944202565886198256260591909756040*x^2</code>ï¼Œæ”¹å†™ä¸º<code>y^2 = (x + 193387944202565886198256260591909756040) * x^2</code></p><p>å› ä¸º<code>193387944202565886198256260591909756040 = pow(89654903351345918131227153390056628523,2,p)</code><br>æˆ‘ä»¬å°±å¯æŠŠ Pã€Q ç‚¹æ˜ å°„åˆ°ä¹˜æ³•ç¾¤ä¸Šï¼Œä»è€Œè¿›è¡Œç®€å•çš„å¯¹æ•°è®¡ç®—ã€‚</p><p>æ˜ å°„æ³•åˆ™å¦‚ä¸‹:<br>$$(x,y)\rightarrow\frac{y+tx}{y-tx}$$</p><h4 id="EXP-v2"><a class="header-anchor" href="#EXP-v2">Â¶</a>EXP</h4><p>&lt;!â€“codeï¿¼8â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Euler&#39;s Factoring to RSA</title>
    <link href="/2023/04/18/Euler/"/>
    <url>/2023/04/18/Euler/</url>
    
    <content type="html"><![CDATA[<h1>Eulerâ€™s Factoring to RSA</h1><h2 id="Outline"><a class="header-anchor" href="#Outline">Â¶</a>Outline</h2><p>å¯¹äº RSA ä¸­$N=(ma<sup>2+nb</sup>2)(mc<sup>2+nd</sup>2)$çš„æƒ…å†µè¿›è¡Œåˆ†æä»¥åŠå®‰å…¨æ€§è¯„æµ‹ã€‚</p><h2 id="Eulerâ€™s-factorization-method"><a class="header-anchor" href="#Eulerâ€™s-factorization-method">Â¶</a>Eulerâ€™s factorization method</h2><p>æ¬§æ‹‰å› å¼åˆ†è§£æ³•æ˜¯é€šè¿‡ä¸¤ç§æ–¹å¼å°†æ•°å­—å†™æˆä¸¤ä¸ªå¹³æ–¹å’Œæ¥åˆ†è§£æ•°å­—çš„æ–¹æ³•ï¼Œå¯¹äºä¸€ä¸ªåˆæ•°$N$æ¥è¯´ï¼Œè‹¥$N=a<sup>2+b</sup>2$ï¼Œåˆ™å¯ä»¥å°†$N$è¿›è¡Œå› å¼åˆ†è§£ï¼Œä¾‹å¦‚$1000009=1000<sup>2+3</sup>2=972<sup>2+235</sup>2=293\cdot3413$</p><h2 id="Theoretical-basis"><a class="header-anchor" href="#Theoretical-basis">Â¶</a>Theoretical basis</h2><p><strong>Brahmagupta-Fibonacci æ’ç­‰å¼</strong><br>$$(a<sup>2+b</sup>2)(c<sup>2+d</sup>2)=(ac-bd)<sup>2+(ad+bc)</sup>2=(ac+bd)<sup>2+(ad-bc)</sup>2$$</p><h2 id="Proof"><a class="header-anchor" href="#Proof">Â¶</a>Proof</h2><p><img src="/img/Euler.jpg" alt=""></p><p>$$a-c=kl$$<br>$$d-b=km$$<br>$$a+c=hm$$<br>$$d+b=hl$$<br>è¿ç”¨<strong>Brahmagupta-Fibonacci æ’ç­‰å¼</strong><br>$$(k<sup>2+h</sup>2)(l<sup>2+m</sup>2)=(kl+hm)<sup>2+(km-hl)</sup>2=((a-c)+(a+c))<sup>2+((d-b)-(d+b))</sup>2=4a<sup>2+4b</sup>2=4n$$<br>æ‰€ä»¥å¾—åˆ°<br>$$n=((\frac{k}{2})<sup>2+(\frac{h}{2})</sup>2)(l<sup>2+m</sup>2)$$<br>åç»­æ±‚è§£å¦‚ä¸‹ï¼š<br>$$khl<sup>2+khm</sup>2=(a-c)(d+b)+(a+c)(d-b)$$<br>$$kh(l<sup>2+m</sup>2)=2ad-2bc$$<br>$$l<sup>2+m</sup>2=GCD(ad-bc,n)$$</p><h2 id="Generally"><a class="header-anchor" href="#Generally">Â¶</a>Generally</h2><p>å¯¹äºæ›´ä¸€èˆ¬çš„$N$æ¥è¯´ï¼Œå¦‚æœ$N=ma<sup>2+nb</sup>2=mc<sup>2+nd</sup>2$çš„æƒ…å†µåº”ç”¨<strong>æ¬§æ‹‰åˆ†è§£</strong>æ˜¯å¦å¯ä»¥è¿›è¡Œï¼Ÿ<br>å½“ç„¶æ˜¯å¯ä»¥çš„ï¼Œä½†å¯æƒœæ¬§æ‹‰åœ¨ 1891 å¹´å¤±å»äº†ç”Ÿå‘½ï¼Œæ²¡èƒ½ç»§ç»­è¿›è¡Œä»–çš„ç ”ç©¶ã€‚åä¸– Lucas å’Œ Mathews å…ˆåå¯¹è¿™æ ·çš„æƒ…å†µè¿›è¡Œäº†åˆ†ææ¨å¯¼ï¼Œè¯æ˜äº†$N$æ˜¯å¯åˆ†è§£çš„ã€‚</p><h2 id="My-proof"><a class="header-anchor" href="#My-proof">Â¶</a>My proof</h2><p>å¯¹äº$a,b,c,d,m,n\in \mathbb{Z}^+,å¹¶ä¸”gcd(ma,nb)=gcd(mc,nd)=1$<br>$$N=ma<sup>2+nb</sup>2=mc<sup>2+nd</sup>2$$<br>$$N=\frac{1}{2}[m(a<sup>2+c</sup>2)+n(b<sup>2+d</sup>2)]$$</p><p>$$N(d<sup>2-b</sup>2)=\frac{1}{2}(ma<sup>2d</sup>2+mc<sup>2d</sup>2+nb<sup>2d</sup>2+nd<sup>4-ma</sup>2b<sup>2-mc</sup>2b<sup>2-nb</sup>4-nb<sup>2d</sup>2)$$<br>$$\because n(d<sup>2-b</sup>2)=m(a<sup>2-c</sup>2)$$</p><p>$$\therefore N=\frac{1}{2}[ma<sup>2d</sup>2-mb<sup>2c</sup>2+mc<sup>2d</sup>2-ma<sup>2b</sup>2+m(a<sup>2-c</sup>2)(d<sup>2+b</sup>2)]$$<br>$$N=m(ad+bc)(ad-bc)$$<br>æˆ‘ä»¬è¿˜éœ€è¦å¦å¤–ä¸€ä¸ªç­‰å¼ï¼Œè¿ç”¨<strong>Brahmagupta-Fibonacci æ’ç­‰å¼</strong>å¾—åˆ°<br>$$N<sup>2=(ma</sup>2+nb<sup>2)(mc</sup>2+nd^2)$$<br>$$N<sup>2=(mac-nbd)</sup>2+mn(ad+bc)^2$$<br>å› ä¸º$gcd(m,N)=1$,ç”±æ­¤å¾—åˆ°<br>$$N=gcd(N,ad-bc)* \frac{N}{gcd(N,ad-bc)}$$</p><h2 id="Apply-to-RSA"><a class="header-anchor" href="#Apply-to-RSA">Â¶</a>Apply to RSA</h2><p>åœ¨ RSA ä¼ ç»ŸåŠ å¯†ä¸­æˆ‘ä»¬çŸ¥é“ï¼Œ$N$çš„é€‰å–å°¤ä¸ºé‡è¦ï¼Œå¦‚æœé€‰å–çš„$N$æ˜“äºåˆ†è§£ï¼Œé‚£ä¹ˆæ˜æ–‡å°†ä¸å†å®‰å…¨ã€‚<br>å¯¹äº$N=(ma<sup>2+nb</sup>2)(mc<sup>2+nd</sup>2)$ï¼Œå³$p=ma<sup>2+nb</sup>2,q=mc<sup>2+nd</sup>2$</p><p>é’ˆå¯¹è¿™ç§çœ‹ä¼¼æ•°å­—å¾ˆå¤§çš„$N$,ä¸‹é¢è¿›è¡Œä¸€äº›å®é™…çš„ä»£ç ç”Ÿæˆä¸æ”»å‡»ã€‚</p><h3 id="Pã€Q-generate"><a class="header-anchor" href="#Pã€Q-generate">Â¶</a>Pã€Q_generate</h3><p>&lt;!â€“codeï¿¼0â€“&gt;</p><h3 id="abcd-generate"><a class="header-anchor" href="#abcd-generate">Â¶</a>abcd_generate</h3><p>&lt;!â€“codeï¿¼1â€“&gt;</p><h3 id="Encrypt"><a class="header-anchor" href="#Encrypt">Â¶</a>Encrypt</h3><p>&lt;!â€“codeï¿¼2â€“&gt;</p><h3 id="Attack"><a class="header-anchor" href="#Attack">Â¶</a>Attack</h3><p>&lt;!â€“codeï¿¼3â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>NSSCTF Round11</title>
    <link href="/2023/04/08/NSSCTFRound11/"/>
    <url>/2023/04/08/NSSCTFRound11/</url>
    
    <content type="html"><![CDATA[<p>æœ€å rank æ’ç¬¬ 4ï¼Œå·®ä¸€é“ AKï¼Œå¯æƒœã€‚</p><h1>ez_enc</h1><p>é¢˜ç›®æè¿°è¯´äº†ä¸æ˜¯åŸ¹æ ¹åŠ å¯†ï¼Œæ‰€ä»¥è€ƒè™‘ AB ä¸ºäºŒè¿›åˆ¶æƒ…å†µï¼Œ192 ä½æ•°åˆ¤æ–­ï¼Œ8 ä½ä¸ºä¸€ç»„ï¼Œç®€å•å†™ä¸ªè„šæœ¬è·‘å°±è¡Œã€‚<code>NSSCTF&#123;mS4gT1Kv9L8NjPzx&#125;</code></p><h1>MyMessage(2ğŸ©¸)</h1><h2 id="é¢˜ç›®"><a class="header-anchor" href="#é¢˜ç›®">Â¶</a>é¢˜ç›®</h2><p>&lt;!â€“codeï¿¼0â€“&gt;</p><h2 id="é¢˜è§£"><a class="header-anchor" href="#é¢˜è§£">Â¶</a>é¢˜è§£</h2><p>åˆ†æä¸€ä¸‹å‘ç°æ˜¯ CRTï¼Œe æ˜¯ 127ï¼Œä¸ç®—å¾ˆå¤§ï¼Œpwntools è¿œç¨‹è¿ä¸€ä¸‹å°±å‡ºäº†ï¼Œç”¨ 127 ç»„ nã€c å°±èƒ½å‡ºã€‚</p><p>&lt;!â€“codeï¿¼1â€“&gt;</p><h1>MyGame(3ğŸ©¸)</h1><h2 id="é¢˜ç›®-v2"><a class="header-anchor" href="#é¢˜ç›®-v2">Â¶</a>é¢˜ç›®</h2><p>&lt;!â€“codeï¿¼2â€“&gt;</p><h2 id="é¢˜è§£-v2"><a class="header-anchor" href="#é¢˜è§£-v2">Â¶</a>é¢˜è§£</h2><p>ä»”ç»†è¯»ä»£ç ï¼Œå‘ç°æ˜¯å…±æ¨¡æ”»å‡»ï¼Œæ‰¾ä¸¤ç»„ cã€e å³å¯</p><p>&lt;!â€“codeï¿¼3â€“&gt;</p><h1>ez_signin(3ğŸ©¸)</h1><h2 id="é¢˜ç›®-v3"><a class="header-anchor" href="#é¢˜ç›®-v3">Â¶</a>é¢˜ç›®</h2><p>&lt;!â€“codeï¿¼4â€“&gt;</p><h2 id="é¢˜è§£-v3"><a class="header-anchor" href="#é¢˜è§£-v3">Â¶</a>é¢˜è§£</h2><p>ä» num1 å’Œ num2 å…¥æ‰‹è¿›è¡Œæ¨å¯¼ï¼Œè¿™ç§ç±»ä¼¼æ¨å¯¼åœ¨<code>seccon</code>ä¸­çš„<code>pqpq</code>ä¹Ÿé‡åˆ°è¿‡ï¼Œé‡åˆ° p å’Œ q å’Œä¸å·®çš„æ¬¡æ–¹æ—¶è¦å–„äºå±•å¼€ã€‚<br>$$num1=p^e - q^e ; mod ;n$$<br>$$num2=(p-q)^e ; mod ;n=p^e + q^e ;mod;n$$<br>$$num1-num2=2q^e ;mod;n$$<br>ä¸ n æ±‚ gcd å³å¯å¾—åˆ° qã€‚åç»­åˆå‘ç°<code>gcd(e,phi)=4</code><br>æˆ‘ç›´æ¥ç”¨<code>phi//4</code>å°±å‡ºäº†ï¼Œä½†çœ‹åˆ«çš„å¸ˆå‚…é¢˜è§£æ˜¯ä½¿ç”¨äº† 16 æ¬¡ rabinã€‚<a href="https://www.cnblogs.com/App1eTree#/c/subject/p/nssctf_Round11.html">App1e_Tree</a></p><p>&lt;!â€“codeï¿¼5â€“&gt;</p><h1>NTR(4â„ï¸)</h1><h2 id="é¢˜ç›®-v4"><a class="header-anchor" href="#é¢˜ç›®-v4">Â¶</a>é¢˜ç›®</h2><p>&lt;!â€“codeï¿¼6â€“&gt;</p><h2 id="é¢˜è§£-v4"><a class="header-anchor" href="#é¢˜è§£-v4">Â¶</a>é¢˜è§£</h2><p>åŸºç¡€ NTRU æ ¼å¯†ç ï¼Œå…·ä½“æ¨å¯¼å¯çœ‹å‰å‡ ç¯‡åšå®¢ DUTCTF çš„ ez_RSA</p><p>&lt;!â€“codeï¿¼7â€“&gt;</p><h1>ez_fac(æœªå‡º)</h1><h2 id="é¢˜ç›®-v5"><a class="header-anchor" href="#é¢˜ç›®-v5">Â¶</a>é¢˜ç›®</h2><p>&lt;!â€“codeï¿¼8â€“&gt;</p><h2 id="é¢˜è§£-v5"><a class="header-anchor" href="#é¢˜è§£-v5">Â¶</a>é¢˜è§£</h2><p>èµ›åè‡ªå·±æ¨äº†ä¸€ä¸‹ï¼Œæ¬§æ‹‰å…¬å¼åˆ†è§£<br><img src="/img/Euler.jpg" alt=""><br>å› æ­¤æœ‰<br>$$a-c=kl$$<br>$$d-b=km$$<br>$$a+c=hm$$<br>$$d+b=hl$$<br>æ¨åˆ°è¿™æ­¥ä¹‹åï¼Œè¿ç”¨<code>Brahmagupta-Fibonacci</code>æ’ç­‰å¼ï¼Œå¾—åˆ°<br>$$n=((\frac{k}{2})<sup>2+(\frac{h}{2})</sup>2)(l<sup>2+m</sup>2)$$</p><p>$$khl<sup>2+khm</sup>2=(a-c)(d+b)+(a+c)(d-b)$$<br>$$kh(l<sup>2+m</sup>2)=2ad-2bc$$<br>$$l<sup>2+m</sup>2=GCD(ad-bc,n)$$<br>æ‰€ä»¥å¯¹åº”åˆ°æœ¬é¢˜å½“ä¸­ï¼Œ<code>p=GCD((a0*b1-a1*b0),n)</code></p><p>&lt;!â€“codeï¿¼9â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>NKCTF2023</title>
    <link href="/2023/04/04/2023NKCTF/"/>
    <url>/2023/04/04/2023NKCTF/</url>
    
    <content type="html"><![CDATA[<h1>æ•°å­—ä¸­å›½ Babysecret</h1><p>é¢˜ç›®</p><p>&lt;!â€“codeï¿¼0â€“&gt;</p><p>$enc=pow(x,flag,p)$,ç¦»æ•£å¯¹æ•°é—®é¢˜ï¼Œp æ˜¯å…‰æ»‘çš„ï¼Œåç»­å¯é€šè¿‡ PH æ±‚è§£ï¼Œä½† x æœªçŸ¥</p><p>$c=(rx+s);mod;p$,c å’Œ r æ˜¯ 30 ä½çš„å‘é‡ï¼Œé€šè¿‡ LWE æ±‚è§£ x å³å¯ã€‚</p><p>&lt;!â€“codeï¿¼1â€“&gt;</p><h1>NKCTF2023</h1><h2 id="babyRSA"><a class="header-anchor" href="#babyRSA">Â¶</a>babyRSA</h2><p>é¢˜ç›®</p><p>&lt;!â€“codeï¿¼2â€“&gt;</p><h3 id="é¢˜ç›®åˆ†æ"><a class="header-anchor" href="#é¢˜ç›®åˆ†æ">Â¶</a>é¢˜ç›®åˆ†æ</h3><p>é¢˜ç›®ååŠéƒ¨åˆ†æ˜¯ dp æ³„éœ²ï¼Œé€šè¿‡ Nã€eã€dP å¯æ±‚å‡º Pã€Q</p><p>&lt;!â€“codeï¿¼3â€“&gt;</p><h4 id="æ³•ä¸€"><a class="header-anchor" href="#æ³•ä¸€">Â¶</a>æ³•ä¸€</h4><p>ä¹‹åè¦é€šè¿‡$P = m<sup>p;mod;n$ä¸$Q=m</sup>q; mod ;n$æ¥æ±‚è§£ mï¼Œä¸‹é¢è¿›è¡Œä¸€äº›æ•°å­¦æ¨å¯¼</p><p>$$c_1<sup>q=m</sup>{pq};mod;n$$<br>$$c_1<sup>{pq}=c_2</sup>{p^2};mod;n$$<br>$$c_1<sup>{pq}=c_2</sup>{p^2};mod;p$$</p><p>æ ¹æ®è´¹é©¬å°å®šç†è½¬æ¢å¯å¾—</p><p>$$c_1<sup>n=c_2</sup>p;mod;p$$<br>$$gcd(c_1^n-c_2,n);=;p$$</p><p>æ±‚å‡º p å’Œ q åï¼Œä½¿ç”¨ crt å³å¯æ±‚å¾— m</p><p>&lt;!â€“codeï¿¼4â€“&gt;</p><h4 id="æ³•äºŒ"><a class="header-anchor" href="#æ³•äºŒ">Â¶</a>æ³•äºŒ</h4><p>é€šè¿‡æ¨å¯¼å°†åŸå¼è½¬æ¢ä¸º</p><p>$$PQ=(k_1p+m)(k_2q+m)$$<br>$$m(P+Q)=2m^2+(k_1p+k_2q)m$$<br>$$PQ-m(P+Q)+m^2=k_1k_2n$$<br>$$PQ-m(c_1+c_2)+m^2=0;mod;n$$</p><p>&lt;!â€“codeï¿¼5â€“&gt;</p><h2 id="ezRSA"><a class="header-anchor" href="#ezRSA">Â¶</a>ezRSA</h2><p>å·²çŸ¥ phi åˆ†è§£ n,åç»­åŒ babyRSA</p><p>&lt;!â€“codeï¿¼6â€“&gt;</p><h2 id="ez-math"><a class="header-anchor" href="#ez-math">Â¶</a>ez_math</h2><p>é¢˜ç›®</p><p>&lt;!â€“codeï¿¼7â€“&gt;</p><p>æ ¹æ®ä¸€ä¸ª hint å¾—åˆ°<br>$$8^x;mod;n=4$$<br>$$2^{3x-2}=1;mod;n$$<br>ç”±è´¹é©¬å°å®šç†å¾—ï¼Œ3x-2=phi</p><p>&lt;!â€“codeï¿¼8â€“&gt;</p><h2 id="ez-polynomial"><a class="header-anchor" href="#ez-polynomial">Â¶</a>ez_polynomial</h2><p>é¢˜ç›®</p><p>&lt;!â€“codeï¿¼9â€“&gt;</p><h3 id="é¢˜è§£"><a class="header-anchor" href="#é¢˜è§£">Â¶</a>é¢˜è§£</h3><p>å¤šé¡¹å¼ RSAï¼Œç»™å®š nã€eã€c</p><p>&lt;!â€“codeï¿¼10â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>DUTCTF2023</title>
    <link href="/2023/03/28/DUTCTF2023/"/>
    <url>/2023/03/28/DUTCTF2023/</url>
    
    <content type="html"><![CDATA[<h1>DUTCTF2023wp</h1><h2 id="å†™åœ¨å‰é¢"><a class="header-anchor" href="#å†™åœ¨å‰é¢">Â¶</a>å†™åœ¨å‰é¢</h2><p>ä»”ç»†ä¸€æƒ³è‡ªå·±å­¦ CTF ä¹Ÿä¸€å¹´äº†ï¼Œçºªå¿µä¸€ä¸‹æœ€åä¸€æ¬¡å‚åŠ æ ¡èµ› ğŸ¥¹ï¼Œæ˜å¹´å¯å°±æ˜¯å‡ºé¢˜äººäº† ğŸ¤“ã€‚ä½†æ˜¯æ„Ÿè§‰ä¸€å¹´ä»¥æ¥è’åºŸäº†å¾ˆå¤šæ—¶é—´ï¼Œåœ¨å¾ˆå¤šæ–¹é¢å¯¹é¢˜ç›®ä¸ç†Ÿæ‚‰ï¼Œæ€»è·‘åï¼Œç”šè‡³æ˜¯è‡ªå·±å¤ç°è¿‡çš„ä¸€äº›æ–¹æ³•éƒ½æ²¡æ„è¯†åˆ°ï¼ˆhint å¤ªåˆ°ä½äº† ğŸ˜­ï¼‰ã€‚</p><h2 id="Crypto"><a class="header-anchor" href="#Crypto">Â¶</a>Crypto</h2><p>ç¬¬ä¸€æ¬¡ akï¼Œå¥½çˆ½ ğŸ˜­</p><h3 id="è€æ»šäº”"><a class="header-anchor" href="#è€æ»šäº”">Â¶</a>*è€æ»šäº”</h3><p>ç™¾åº¦æœé¾™è¯­ï¼Œè€å¿ƒå¯¹ç€æ‰¾å°±å‡ºäº†<code>DUTCTF&#123;YOU_ARE_A_REAL_DRAGONBORN&#125;</code></p><h3 id="ç¥å¥‡çš„çŸ­ä¿¡"><a class="header-anchor" href="#ç¥å¥‡çš„çŸ­ä¿¡">Â¶</a>*ç¥å¥‡çš„çŸ­ä¿¡</h3><p>è¯ºåŸºäºšæ‰‹æœºï¼Œ9 é”®ï¼Œç¬¬ä¸€ä½ä»£è¡¨å“ªä¸ªé”®ï¼Œç¬¬äºŒä¸ªä»£è¡¨ç¬¬å‡ ä¸ªå­—æ¯ï¼Œ<code>DUTCTF&#123;SCREW&#125;</code></p><h3 id="éšæœºæ•°çš„åŠ›é‡"><a class="header-anchor" href="#éšæœºæ•°çš„åŠ›é‡">Â¶</a>éšæœºæ•°çš„åŠ›é‡</h3><p>å¯å…ˆäº†è§£ä¸€ä¸‹ MT19937 ä¼ªéšæœºæ•°åŸç†ï¼Œç„¶åçœ‹ä¸€ä¸‹<a href="https://blog.csdn.net/qq_42557115/article/details/128228201?spm=1001.2014.3001.5506">ç ´è§£æ–¹æ³•</a>ï¼Œå¯¹äºæ¢…æ£®æ—‹è½¬ç®—æ³•ä¹‹å‰<a href="https://sch01ar.github.io/2022/10/16/2021ByteCTF-easyxor/">åšå®¢</a>ä¹Ÿè¯¦ç»†æ¨å¯¼è¿‡ã€‚è¿™é‡Œé’ˆå¯¹é¢˜ç›®åˆ†æä¸€ä¸‹ï¼Œé¦–å…ˆ ban æ‰äº† 32 ä½çš„é¢„æµ‹æ–¹æ³•ï¼Œé€šè¿‡äº†è§£åˆ°ï¼Œ<code>randcrack</code>åº“å®é™…ä¸Šæ˜¯é€šè¿‡æ”¶å–ç‰¹å®šä½æ•°æ¥å®ç°é¢„æµ‹ï¼Œä¾‹å¦‚ 32 ä½æ•°ï¼Œå°±éœ€è¦ 624 ä¸ªï¼Œé‚£ä¹ˆå¦‚æœä½¿ç”¨ 64 ä½æ•°ï¼Œåº”è¯¥å°±éœ€è¦ 312 ä¸ªã€‚åç»­åªè¦å¯¹æ”¶å–çš„æ•°å­—è¿›è¡Œä¸€ä¸‹å¤„ç†ï¼Œè½¬æˆ 624 ä¸ª 32 ä½æ•°å³å¯ã€‚<br>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªç–‘é—®å°±æ˜¯ï¼Œæœ€å¤§çš„ 64 ä½æ•°æ˜¯$2<sup>{64}-1$ï¼Œä½†æ˜¯å¦‚æœä¼ $name=2</sup>{64}-1$å°±æ— æ³•é¢„æµ‹ï¼Œè€Œæ”¹æˆå…¶ä½™ç•¥å°ä¸€ç‚¹çš„ 64 ä½æ•°å³å¯ã€‚</p><h4 id="exp"><a class="header-anchor" href="#exp">Â¶</a>exp</h4><p>&lt;!â€“codeï¿¼0â€“&gt;</p><h3 id="shamir"><a class="header-anchor" href="#shamir">Â¶</a>shamir</h3><p>ç›´æ¥æ‰¾è„šæœ¬è·‘ï¼Œå…·ä½“å¦‚ä½•æ¢å¤ a0 ç³»æ•°å°±ä¸ç»†è¯´äº†ã€‚ä¹‹å‰ hitcon æœ‰ä¸ªä¹Ÿæ˜¯ shamir çš„é¢˜ï¼Œä¹ŸæŒºæœ‰æ„æ€çš„ã€‚<a href="https://sch01ar.github.io/2022/11/28/hitcon2022-BabySSS/">babysss</a></p><p>&lt;!â€“codeï¿¼1â€“&gt;</p><h3 id="ECC1"><a class="header-anchor" href="#ECC1">Â¶</a>ECC1</h3><p>å‘ç°æ˜¯ ECDSA ç±»å‹ï¼Œäºæ˜¯ç°å­¦ã€‚ã€‚ã€‚ä¸‹é¢å†™ä¸€ä¸‹ ECDSA çš„ç­¾åä¸éªŒè¯è¿‡ç¨‹ã€‚</p><h4 id="åœºæ™¯"><a class="header-anchor" href="#åœºæ™¯">Â¶</a>åœºæ™¯</h4><p>Alice æƒ³è¦ä½¿ç”¨å¥¹çš„ç§é’¥$d_A$æ¥ç­¾åï¼ŒBob æƒ³ç”¨ Alice çš„å…¬é’¥ $H_A$è¦éªŒè¯ç­¾å$H_A=d_AG$ã€‚<br>åªæœ‰ Alice æ‰èƒ½æä¾›æ­£ç¡®çš„ç­¾åï¼Œè€Œæ¯ä¸ªäººéƒ½å¯ä»¥éªŒè¯ç­¾åã€‚</p><h4 id="ç­¾å"><a class="header-anchor" href="#ç­¾å">Â¶</a>ç­¾å</h4><p>1.é€‰å®šä¸€æ¡æ¤­åœ†æ›²çº¿$E_p(a,b)$ã€‚</p><p>2.é€‰å–ä¸€ä¸ªéšæœºæ•°$k,1&lt;k&lt;n-1$ï¼Œ$n$ä¸ºæ¤­åœ†æ›²çº¿çš„é˜¶ã€‚</p><p>3.é€‰å–æ¤­åœ†æ›²çº¿çš„åŸºç‚¹$G(a,b)$,è®¡ç®— $K=k * G(a,b)$ï¼Œä»¤$r=K[0]\mod n$ï¼Œå³ r æ˜¯ K ç‚¹çš„æ¨ªåæ ‡ï¼ˆè‹¥ r ä¸º 0ï¼Œé‡æ–°é€‰ k è¿›è¡Œè®¡ç®—ï¼‰ã€‚</p><p>4.è®¡ç®—æ˜æ–‡ M çš„å“ˆå¸Œï¼Œä»¤$e=hash(M)$ï¼Œè®¡ç®—$s=k^{-1}(z+rd_A)\mod n$ã€‚</p><p>5.ç»™å‡ºç­¾å$(r,s)$</p><h4 id="éªŒè¯"><a class="header-anchor" href="#éªŒè¯">Â¶</a>éªŒè¯</h4><p>1.è®¡ç®— $u_1=s^{-1}z\mod n$</p><p>2.è®¡ç®— $u_2=s^{-1}r\mod n$</p><p>3.è®¡ç®—ç‚¹$P=u_1G+u_2H_A$</p><p>å½“$r=x_P\mod n$æ—¶ï¼Œç­¾åéªŒè¯æˆåŠŸã€‚</p><h4 id="è§£é¢˜è¿‡ç¨‹"><a class="header-anchor" href="#è§£é¢˜è¿‡ç¨‹">Â¶</a>è§£é¢˜è¿‡ç¨‹</h4><p>é€šè¿‡å¯¹é¢˜ç›®çš„åˆæ­¥é˜…è¯»ï¼Œå‘ç°å…³é”®æ˜¯æ±‚å‡ºç§é’¥<code>d=privkey</code>ï¼Œè€Œæƒ³è¦æ±‚å‡º$d$å°±è¦æ±‚å‡º$k$ï¼Œè™½ç„¶$k$ æ˜¯ä»¥éšæœºæ•°çš„å½¢å¼å‡ºç°ï¼Œä½†å‘ç°æœ¬é¢˜ä¸­æ¯æ¬¡ç­¾åè¿‡ç¨‹çš„ k å¹¶ä¸æ˜¯å®Œå…¨éšæœºï¼Œè€Œæ˜¯çº¿æ€§ä¼ªéšæœº$k = (a * k + b)\mod n$ã€‚è¿™é‡Œæˆ‘å¾ˆæƒ³æŠŠ$k$æ±‚å‡ºæ¥ï¼Œç„¶åå†å»æ±‚ç§é’¥$d$ã€‚æ‰€ä»¥æœ‰æ²¡æœ‰ä¸€ç§å¯èƒ½ï¼Œä¸ç”¨æ±‚$k$ï¼Œå¦‚æœæŠŠ$k$æ¶ˆæ‰ï¼Œæ–¹ç¨‹é‡Œåªå‰©ä¸€ä¸ªæœªçŸ¥æ•°$d$ï¼Œå³å¯ã€‚ç»†å¿ƒä¸€ç‚¹è¿›è¡Œæ•°å­¦æ¨å¯¼ï¼Œå°±ä¼šå‘ç°ç­”æ¡ˆã€‚<br>$$k_1s_1=e+r_1d\mod n$$<br>$$k_2s_2=e+r_2d\mod n$$<br>$$k_2=ak_1+b\mod n$$<br>$$k_2=ak_1+b+xn$$<br>$$s_1s_2k_2=s_1s_2ak_1+s_1s_2b+s_1s_2xn$$<br>$$s_1(e+r_2d)=s_2a(e+r_1d)+s_1s_2b \mod n$$<br>$$d=(s_1r_2-s_2ar_1)^{-1}(s_2ae-s_1e+s_1s_2b)\mod n$$</p><p>è¿™é‡Œä¸¤æ¬¡çš„ä½¿ç”¨çš„$e$ä¸€æ ·ï¼Œæ˜¯å› ä¸ºä¼ çš„æ˜æ–‡ä¸€æ ·ï¼Œ$n$å¯¹åº”çš„æ˜¯é¢˜ç›®é‡Œç»™çš„$order$ã€‚è¿™é‡Œè¿˜æƒ³è¯´ä¸€ä¸‹è‡ªå·±å› ä¸ºä¸ç»†è‡´èµ°è¿‡çš„å¼¯è·¯ï¼Œé¢˜ç›®é‡Œé€šè¿‡$p$å®šä¹‰çš„æ›²çº¿ï¼Œæ‰€ä»¥è¯¯ä»¥ä¸º$curve.order$æ˜¯$p$ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´å‰ä¸¤ä¸ªå¼å­å’Œç¬¬ä¸‰ä¸ªç®—å¼çš„æ¨¡æ•°ä¸åŒã€‚æœ‰è¶£çš„æ˜¯ï¼Œæ‰¾åˆ°äº†ä¸€ç¯‡è®ºæ–‡å’Œæ–‡ç« è¿›è¡Œäº†å®ç°ã€‚<br><a href="https://cseweb.ucsd.edu/~mihir/papers/dss-lcg.pdf">è®ºæ–‡</a><br>ä½†å…¶å®$curve.order=order$æ‰€ä»¥ä¸Šè¿°æ‰€æœ‰éƒ½æ˜¯åœ¨æ¨¡$orderçš„æ¡ä»¶ä¸‹$ï¼Œæ‰€ä»¥è¿›è¡Œä¸€ä¸‹æ¨å¯¼å°±å‡ºäº†ã€‚</p><h4 id="exp-v2"><a class="header-anchor" href="#exp-v2">Â¶</a>exp</h4><p>&lt;!â€“codeï¿¼2â€“&gt;</p><h3 id="ECC2"><a class="header-anchor" href="#ECC2">Â¶</a>ECC2</h3><p>hint:äºŒå…ƒ copper<br>çœ‹åˆ° hint ç¬é—´çŸ¥é“æ€ä¹ˆåšäº†ï¼Œå‰æ®µæ—¶é—´åˆšå­¦äº†ä¸€ä¸‹å¤šå…ƒ copperï¼Œæ„Ÿæ…¨ä¸€ä¸‹è¿˜æ˜¯è¿ç”¨ä¸ç†Ÿç»ƒï¼Œæ²¡æœ‰ä¸€çœ¼å‘ç°ã€‚</p><h4 id="è§£é¢˜æ€è·¯"><a class="header-anchor" href="#è§£é¢˜æ€è·¯">Â¶</a>è§£é¢˜æ€è·¯</h4><p>åŒæ ·æ˜¯ ECDSAï¼Œç›¸æ¯”äºä¸Šé¢˜æ¥è¯´ï¼Œk æ˜¯éšæœºçš„ï¼Œä½†æ˜¯æ¯æ¬¡ç­¾åçš„æ—¶å€™ä¼šæ³„éœ² k çš„é«˜ä½ã€‚æ­¤é¢˜å¦å¤–ä¸€ä¸ªå…³é”®æ˜¯ï¼Œ$r$æ˜¯ç”±ç§é’¥$d$ç”Ÿæˆçš„ï¼Œæ‰€ä»¥ä¸ç®¡ä¼ ä»€ä¹ˆæ˜æ–‡ï¼Œæ‰€å¾—åˆ°çš„$r$æ˜¯ä¸€æ ·çš„ï¼Œåˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸€ä¸ªäºŒå…ƒæ–¹ç¨‹ã€‚<br>$$s_1k_1=z_1+dr \mod n$$<br>$$s_2k_2=z_2+dr \mod n$$<br>$$k=kh+kl$$<br>$$s_1(k_1h+k_1l)-z_1=s_2(k_2h+k_2l)-z_2 \mod n$$<br>$$f(k_1l,k_2l)=s_1(k_1h+k_1l)-z_1-s_2(k_2h+k_2l)+z_2$$<br>éšåä½¿ç”¨å¤šå…ƒ copper è¿›è¡Œæ±‚è§£ã€‚å…·ä½“å¯çœ‹ä¸Šç¯‡åšå®¢ã€‚</p><p>&lt;!â€“codeï¿¼3â€“&gt;</p><h3 id="ez-RSA"><a class="header-anchor" href="#ez-RSA">Â¶</a>ez_RSA</h3><p>hint 1:<a href="https://www.ijcsi.org/papers/IJCSI-9-2-1-311-314.pdf">è®ºæ–‡</a></p><p>hint 2:</p><p>&lt;!â€“codeï¿¼4â€“&gt;</p><h4 id="è§£é¢˜æ€è·¯-v2"><a class="header-anchor" href="#è§£é¢˜æ€è·¯-v2">Â¶</a>è§£é¢˜æ€è·¯</h4><p>é€šè¿‡è®ºæ–‡ï¼Œå‰åŠéƒ¨åˆ†ç™½ç»™ï¼ŒæŒ‰ç…§è®ºæ–‡é€ æ ¼ï¼Œå³å¯è§„çº¦å‡º$_P$ã€‚<br>æ¥ä¸‹æ¥çš„é—®é¢˜å°±æ˜¯å¦‚ä½•æ±‚$_E$<br>$$c=rh+m \mod p$$<br>$$h=f^{-1}g \mod p$$<br>å°†ä¸€å¼å¸¦å…¥äºŒå¼<br>$$c=r(f^{-1}g)+m \mod p$$<br>$$cf=rg+mf \mod p$$<br>å› ä¸º r æ˜¯ 1024 ä½ï¼Œg æ˜¯ 768 ä½ï¼Œf æ˜¯ 1024 ä½ï¼Œm æ˜¯ 128 ä½ï¼Œp æ˜¯ 2048 ä½ï¼Œæ‰€ä»¥<br>$$rg+mf \mod p=rg+mf$$<br>$$cf \mod p=rg+mf$$<br>ä¸¤è¾¹åŒæ—¶å¯¹$g$å–æ¨¡ï¼Œå³å¯æ¶ˆå»æœªçŸ¥æ•°$r$ï¼Œå¾—åˆ°<br>$$m=(f*c \mod p)*f^{-1} \mod g$$</p><h4 id="exp-v3"><a class="header-anchor" href="#exp-v3">Â¶</a>exp</h4><p>&lt;!â€“codeï¿¼5â€“&gt;</p><h2 id="misc"><a class="header-anchor" href="#misc">Â¶</a>misc</h2><h3 id="ç­¾åˆ°"><a class="header-anchor" href="#ç­¾åˆ°">Â¶</a>*ç­¾åˆ°</h3><p>b ç«™ 21 çº§ pwn ä¾‹ä¼šè¯„è®ºåŒº</p><h3 id="æˆ‘åœ¨å“ª"><a class="header-anchor" href="#æˆ‘åœ¨å“ª">Â¶</a>æˆ‘åœ¨å“ª</h3><p>æ”¾å¤§å›¾ç‰‡çœ‹åˆ°åå…«ä¸­ï¼Œæœç´¢ä¸´æ±Ÿåå…«ä¸­ï¼Œå‘ç°æ˜¯é‡åº†åå…«ä¸­ï¼Œåœ°å›¾ä¸Šæœä¸€ä¸‹é™„è¿‘åœ°é“ç«™ï¼ŒæŒ¨ç€æ¡¥çš„å°±æ˜¯ï¼Œæ›¾å®¶å²©ã€‚</p><h3 id="ä¸è¦æ›´æ–°"><a class="header-anchor" href="#ä¸è¦æ›´æ–°">Â¶</a>ä¸è¦æ›´æ–°</h3><p>æµé‡åˆ†æé¢˜ï¼Œwireshark é‡Œè¿‡æ»¤ä¸€ä¸‹ httpï¼Œæ‰¾åˆ° github ç½‘é¡µ<br><img src="/img/web.png" alt=""><br>æ ¹æ® hint æŸ¥çœ‹å†å²æäº¤è®°å½•ï¼Œå‘ç°å‡ flagï¼Œå¯¹äºå¯†ç æ‰‹æ¥è¯´ä¸€çœ¼å‡¯æ’’ï¼Œç§»ä½ 13ã€‚<br><img src="/img/kaisa.png" alt=""></p><h2 id="web"><a class="header-anchor" href="#web">Â¶</a>web</h2><h3 id="Trenja"><a class="header-anchor" href="#Trenja">Â¶</a>*Trenja</h3><p>F12 æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œæœç´¢ flag å­—æ®µå³å¯ã€‚</p><h2 id="pwn"><a class="header-anchor" href="#pwn">Â¶</a>pwn</h2><h3 id="ä¸­é—´äºº"><a class="header-anchor" href="#ä¸­é—´äºº">Â¶</a>*ä¸­é—´äºº</h3><p>å¤ªå¥½ç©äº†ï¼ŒåŸç†æ˜¯æ±½è½¦æ»šåŠ¨ç ã€‚bob æ¥å¼€è½¦é—¨ï¼Œæˆªæ–­ï¼Œå¼€é—¨å¤±è´¥ã€‚bob å†å¼€è½¦é—¨ï¼Œæˆªæ–­ï¼Œå‘é€ç¬¬ä¸€æ¬¡æˆªæ–­ä¿¡å·ï¼Œbob å¼€é—¨æˆåŠŸã€‚bob ç¦»å¼€ï¼Œæˆ‘ä»¬å‘é€ç¬¬äºŒæ¬¡æˆªæ–­çš„ä¿¡å·ï¼Œæ‰“å¼€è½¦é—¨ï¼</p><h2 id="reverse"><a class="header-anchor" href="#reverse">Â¶</a>reverse</h2><h3 id="è´ªåƒè›‡"><a class="header-anchor" href="#è´ªåƒè›‡">Â¶</a>*è´ªåƒè›‡</h3><p>æ‹–å…¥ IDAï¼Œalt+t æœç´¢ DUT å³å¯</p><h3 id="GAME"><a class="header-anchor" href="#GAME">Â¶</a>*GAME</h3><p>ä¸‹æ£‹èµ¢äº†å°±å‡ºäº†</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>Coppersmithç›¸å…³æ”»å‡»</title>
    <link href="/2023/03/07/Coppersmith%E6%94%BB%E5%87%BB/"/>
    <url>/2023/03/07/Coppersmith%E6%94%BB%E5%87%BB/</url>
    
    <content type="html"><![CDATA[<h1>åŸç†</h1><p>Coppersmith å®šç†æ˜¯åœ¨ä¸€ä¸ª e é˜¶æ¨¡ n çš„å¤šé¡¹å¼$f(x)$ä¸­ï¼Œè‹¥æœ‰æ ¹å°äº$n^{\frac{1}{e}}$ï¼Œåˆ™å¯ä»¥ç”¨ O(log n)çš„ç®—æ³•æ±‚å‡ºæ ¹ã€‚</p><p>ç›´æ¥æ±‚è§£$f(x)$çš„æ ¹å¯èƒ½æ¯”è¾ƒå›°éš¾ï¼Œåœ¨æ­¤åˆ©ç”¨<code>LLL</code>ç®—æ³•æ±‚å¾—å¤šé¡¹å¼$g(x)$ï¼Œæ±‚å¾—çš„å¤šé¡¹å¼ä¸$f(x)$å…·æœ‰ç›¸åŒçš„æ ¹$x_0$ï¼Œ$g(x)$å…·æœ‰æ›´å°çš„ç³»æ•°ï¼Œä¸”å®šä¹‰åŸŸä¸ºæ•´æ•°åŸŸã€‚</p><p>æœ¬è´¨æ€æƒ³å°±æ˜¯æŠŠæœ‰é™åŸŸä¸Šçš„æ–¹ç¨‹è½¬åŒ–åˆ°æ•´æ•°åŸŸã€‚</p><h1>ç†è®ºåŸºç¡€</h1><p>$$f(x,y) = \sum_{i=0}<sup>{d}\sum_{j=0}</sup>{e} a_{i,j}x<sup>iy</sup>j$$</p><h2 id="Howgrave-Graham"><a class="header-anchor" href="#Howgrave-Graham">Â¶</a>Howgrave-Graham</h2><p><img src="/img/Howgrave.png" alt=""><br>éœ€è¦æ„é€ ä¸€ä¸ªç³»æ•°æ›´å°çš„å¤šé¡¹å¼ï¼Œ$||g(x)||$ä»£è¡¨èŒƒæ•°ï¼Œå³æœ€å¤§çš„ç³»æ•°ã€‚æ„é€ æ–¹æ³•å¦‚ä¸‹<br><img src="/img/%E6%9E%84%E9%80%A0%E6%96%B9%E6%B3%95.png" alt=""></p><h2 id="LLL-ç®—æ³•"><a class="header-anchor" href="#LLL-ç®—æ³•">Â¶</a>LLL ç®—æ³•</h2><p>æ ¼åŸºçº¦åŒ–ç®—æ³•ï¼Œé€šè¿‡å¯¹æ„é€ å‡ºçš„æ ¼ï¼Œä»è€Œçº¦åŒ–äº§ç”Ÿç¬¦åˆçº¦æŸçš„å¤šé¡¹å¼ã€‚<br><img src="/img/LLL.png" alt=""></p><h2 id="p-é«˜ä½æ”»å‡»"><a class="header-anchor" href="#p-é«˜ä½æ”»å‡»">Â¶</a>p é«˜ä½æ”»å‡»</h2><p>&lt;!â€“codeï¿¼0â€“&gt;</p><h3 id="exp"><a class="header-anchor" href="#exp">Â¶</a>exp</h3><p>&lt;!â€“codeï¿¼1â€“&gt;</p><h2 id="p-é«˜ä½éƒ¨åˆ†æ³„éœ²"><a class="header-anchor" href="#p-é«˜ä½éƒ¨åˆ†æ³„éœ²">Â¶</a>p é«˜ä½éƒ¨åˆ†æ³„éœ²</h2><p>&lt;!â€“codeï¿¼2â€“&gt;</p><h2 id="q-ä½ä½å’Œ-p-é«˜ä½"><a class="header-anchor" href="#q-ä½ä½å’Œ-p-é«˜ä½">Â¶</a>q ä½ä½å’Œ p é«˜ä½</h2><p>&lt;!â€“codeï¿¼3â€“&gt;</p><h2 id="dp-é«˜ä½æ”»å‡»"><a class="header-anchor" href="#dp-é«˜ä½æ”»å‡»">Â¶</a>dp é«˜ä½æ”»å‡»</h2><p>ç»™å®š$e,n,c,dp_0,k,;dp_0=dp&gt;&gt;k$</p><p>$$<br>edp\equiv ed\equiv 1;mod;(p-1)\<br>edp=k(p-1)+1\<br>edp+k-1=kp\<br>edp+k-1 \equiv 0; mod; p\<br>\because dp&lt; p-1\<br>\because edp=k(p-1)+1\<br>\therefore e&gt;k\<br>\therefore e(dp_0 &lt;&lt; k+x)+k-1 \equiv 0;mod;p<br>$$</p><p>&lt;!â€“codeï¿¼4â€“&gt;</p><h3 id="EXP"><a class="header-anchor" href="#EXP">Â¶</a>EXP</h3><p>&lt;!â€“codeï¿¼5â€“&gt;</p><h2 id="å¤šå…ƒ-coppersmith"><a class="header-anchor" href="#å¤šå…ƒ-coppersmith">Â¶</a>å¤šå…ƒ coppersmith</h2><p><a href="https://lordriot.live/2021/01/06/Way-to-CopperSmith/">åŸç†å­¦ä¹ </a><br><a href="https://www.researchgate.net/publication221010552_New_attacks_on_RSA_with_small_secret_CRT-exponents">è®ºæ–‡å­¦ä¹  1</a>ã€<br><a href="https://eprint.iacr.org/2010/146.pdf">è®ºæ–‡å­¦ä¹  2</a><br><a href="https://phot0n.com/2022/04/30/MRCTF2022/">è„šæœ¬æ¥æº</a></p><p>&lt;!â€“codeï¿¼6â€“&gt;</p><p>å…·ä½“å‚æ•°è¯´æ˜ï¼Œä¾‹å¦‚</p><p>&lt;!â€“codeï¿¼7â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>DLPä¸­å¸¸ç”¨ç®—æ³•</title>
    <link href="/2023/02/24/DLP%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95/"/>
    <url>/2023/02/24/DLP%E4%B8%AD%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1>Pohlig-Hellman ç®—æ³•ï¼ˆå…‰æ»‘é˜¶ï¼‰</h1><p>ç»™å®š a,b,pï¼Œp æ˜¯ç´ æ•°ï¼Œæ±‚ xï¼Œ$a^x \equiv b (mod;p)$<br>åœ¨æ¨¡ p ä¸‹ï¼Œè®¾è¯¥ç¾¤çš„ç”Ÿæˆå…ƒä¸º gï¼Œåˆ™æœ‰</p><p>$$<br>a \equiv g^{a1} (mod;p) \newline<br>b \equiv g^{b1} (mod;p)<br>$$</p><p>è”ç«‹æ¡ä»¶æœ‰</p><p>$$<br>g^{a1x} \equiv g^{b1} (mod;p)<br>$$</p><p>ç”±æ¬§æ‹‰å®šç†å¾—$\phiÂ§;=;p-1$ï¼Œåˆ™æœ‰$a1x;=b1;(mod;(p-1))$</p><p>1.å°† p-1 åˆ†è§£ï¼Œå³ $p-1=p_1<sup>{k_1}p_2</sup>{k_2}\cdots p_m^{k_m}$</p><p>2.å°† x è¡¨ç¤ºæˆ$p_i$ è¿›åˆ¶,<br>åˆ—å‡ºæ–¹ç¨‹<br>$$x;=p_i^0a_0 + p_i<sup>1a_1+â€¦+p_i</sup>{k_i-1}a*{k_i-1}$$</p><p>3.ä»¤ r=1ï¼Œæ±‚$(a<sup>x)</sup>{\frac{p-1}{p_i^r}}; \equiv b<sup>{\frac{p-1}{p_i</sup>r}}(mod; p)$</p><p>4.å°† 2 ä¸­çš„å…¬å¼ä»£å…¥åˆ° 3ï¼Œå±•å¼€å¾—åˆ°<br>$$a^{a0*\frac{p-1}{p_i}}* a^{(p-1)a1} * a<sup>{(p-1)p_ia_2}â€¦a</sup>{(p-1)p_i^{k_i-2}a_{k_i-1}} \equiv b^{\frac{p-1}{p_i}}(mod;p)$$</p><p>5.ä»ç¬¬äºŒé¡¹å¼€å§‹ï¼Œåé¢æ¯é¡¹éƒ½æ˜¯ 1ï¼Œæ¬§æ‹‰å®šç†:$a^{(p-1)} \equiv 1(mod;p)$ï¼ŒåŒ–ç®€å¾—åˆ°çš„å¼å­ä¸º<br>$$\newline a^{a0*\frac{p-1}{p_i}} \equiv b^{\frac{p-1}{p_i}}(mod ;p)\newline$$<br>å› ä¸ºè¯¥æ–¹ç¨‹åªæœ‰ a0 æœªçŸ¥ï¼Œæ‰€ä»¥å¯åœ¨[0,pi-1]èŒƒå›´å†…çˆ†ç ´å‡º a0</p><p>6.å†ä»¤ r = 2,3,4â€¦kiï¼Œé‡å¤æ­¥éª¤ 3ï¼Œå³å¯æ±‚å‡ºæ‰€æœ‰çš„$a_2,a_3â€¦a_{k_i-1}$ï¼Œä»è€Œå¾—åˆ° m ä¸ªå…³äº x çš„æ–¹ç¨‹ï¼Œæœ€åä½¿ç”¨ CRT è¿›è¡Œæ±‚è§£å³å¯ã€‚</p><p>æ€»ç»“:å°† p-1 çš„ m ä¸ªè´¨å› å­ï¼Œåˆ†åˆ«æ±‚å‡ºå…¶æ–¹ç¨‹å†…çš„æ‰€æœ‰ç³»æ•° aï¼Œä»è€Œæ„é€ äº† m ä¸ªå…³äº x çš„æ–¹ç¨‹ï¼Œæœ€ç»ˆåˆ©ç”¨ CRT æ±‚è§£ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>2022DASCTF_NOV-lllcccggg-wp</title>
    <link href="/2022/11/30/2022DASCTF_NOV-lllcccgggwp/"/>
    <url>/2022/11/30/2022DASCTF_NOV-lllcccgggwp/</url>
    
    <content type="html"><![CDATA[<h1>é¢˜ç›®æè¿°</h1><p>å¦‚é¢˜ç›®åå­—ä¸€æ ·ï¼Œæœ‰å¥½å¤šä¸ªlcgï¼Œ<s>å½“æ—¶çœ‹æ™•äº†</s><br>&lt;!â€“codeï¿¼0â€“&gt;</p><h1>é¢˜ç›®åˆ†æ</h1><p>1.<code>key</code>æ˜¯ä¸€ä¸ªèƒŒåŒ…é—®é¢˜ï¼Œå·²çŸ¥å…¬é’¥<code>m</code>ï¼Œå’Œçš„è¯ç›®å‰ä¸çŸ¥é“ã€‚</p><p>2.ä»¥1ä¸­çš„å’Œä¸º<code>seed</code>ï¼Œé€šè¿‡LCGäº§ç”Ÿäº†ä¸€ç»„åºåˆ—<code>output</code>ã€‚</p><p>è‡³æ­¤ï¼Œå·²ç»å¯ä»¥æ ¹æ®<code>output</code>æ¥æ±‚å‡ºLCGä¸­çš„aã€bã€nï¼Œä»è€Œæ±‚å‡º<code>seed</code>ï¼Œä»è€Œé€šè¿‡èƒŒåŒ…å¯æ±‚å¾—keyã€‚</p><p>3.ä»¥<code>key</code>ä¸ºseedï¼Œç§°ä½œ<code>state</code>ï¼Œå†è¿›è¡ŒLCGï¼Œ<code>state = (a * state + b) % c</code>ï¼Œå¹¶ä¸”aï¼Œbï¼Œcå·²çŸ¥ã€‚</p><p>ä½†æ˜¯æƒ³è¦ç›´æ¥æ­£å‘æ±‚è§£å‡ºæœ€åçš„stateï¼Œååˆ†å›°éš¾ï¼Œforå¾ªç¯äº†10^10000æ¬¡ï¼Œè¿™é‡Œæ¶‰åŠåˆ°äº†<strong>çŸ©é˜µå¿«é€Ÿå¹‚</strong>çš„ä½¿ç”¨ã€‚</p><p>é€šè¿‡æ„é€ çŸ©é˜µ<br>$$<br>\mathbf{A} =<br>\begin{bmatrix}<br>state &amp; 1<br>\end{bmatrix}<br>$$<br>$$<br>\mathbf{C} =<br>\begin{bmatrix}<br>a &amp; 0\<br>b &amp; 1\<br>\end{bmatrix}<br>$$<br>é€šè¿‡è®¡ç®—$A<em>C^{10</em>10000}$å³å¯å¾—åˆ°çŸ©é˜µBï¼ŒB = [ state, 1]</p><p>4.æ±‚å‡ºstateåè¿›è¡Œå¼‚æˆ–è§£å¯†å³å¯ã€‚</p><h1>EXP</h1><p>&lt;!â€“codeï¿¼1â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>èƒŒåŒ…åŠ å¯†ç®—æ³•</title>
    <link href="/2022/11/29/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98%E7%AE%97%E6%B3%95/"/>
    <url>/2022/11/29/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98%E7%AE%97%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a class="header-anchor" href="#å‰è¨€">Â¶</a>å‰è¨€</h2><p>åœ¨ä¸€æ¬¡CTFæ¯”èµ›ä¸­é‡åˆ°äº†ï¼Œå†™äº†10ä¸ªforåµŒå¥—ç¡¬çˆ†å‡ºæ¥äº†ï¼Œå¤ç°çš„æ—¶å€™å‘ç°æ˜¯èƒŒåŒ…åŠ å¯†ã€‚</p><p><img src="/img/bag.png" alt=""></p><h2 id="Merkleâ€“Hellman-å…¬é’¥åŠ å¯†ç®—æ³•"><a class="header-anchor" href="#Merkleâ€“Hellman-å…¬é’¥åŠ å¯†ç®—æ³•">Â¶</a>Merkleâ€“Hellman å…¬é’¥åŠ å¯†ç®—æ³•</h2><p>æ•´ä½“åŠ å¯†æµç¨‹<br>&lt;!â€“codeï¿¼0â€“&gt;<br>å¯ä»¥å‘ç°ï¼ŒåŠ å¯†ååˆ†å®¹æ˜“ï¼Œä½†è§£å¯†ååˆ†å›°éš¾ï¼Œè¿™ä¹Ÿæ˜¯éå¯¹ç§°åŠ å¯†çš„ç‰¹ç‚¹ã€‚</p><h3 id="åŠ å¯†"><a class="header-anchor" href="#åŠ å¯†">Â¶</a>åŠ å¯†</h3><h4 id="ç”Ÿæˆç§é’¥"><a class="header-anchor" href="#ç”Ÿæˆç§é’¥">Â¶</a>ç”Ÿæˆç§é’¥</h4><p>è¶…é€’å¢åºåˆ—ï¼Œä¹Ÿå°±æ˜¯aä¸­æ¯ä¸€ä½å…ƒç´ éœ€è¦å¤§äºå…¶ä¹‹å‰æ‰€æœ‰å…ƒç´ çš„å’Œã€‚<br>&lt;!â€“codeï¿¼1â€“&gt;</p><h4 id="ç”Ÿæˆå…¬é’¥"><a class="header-anchor" href="#ç”Ÿæˆå…¬é’¥">Â¶</a>ç”Ÿæˆå…¬é’¥</h4><p>æ¨¡æ•°mè¦æ±‚ï¼š<code>m &gt; sum(a)</code><br>ä¹˜æ•°wè¦æ±‚ï¼š<code>gcd(w,m) == 1</code><br>&lt;!â€“codeï¿¼2â€“&gt;<br>bå’Œmä½œä¸ºå…¬é’¥ã€‚<br>åŠ å¯†ï¼š<code>S = numpy.dot(x,b)</code></p><h3 id="è§£å¯†"><a class="header-anchor" href="#è§£å¯†">Â¶</a>è§£å¯†</h3><p>æ‹¿åˆ°å…¬é’¥$M=(m_1,m_2,\ldots,m_n)$ï¼Œæ„é€ å¦‚ä¸‹çŸ©é˜µ<br>$$<br>\begin{bmatrix}<br>2 &amp; 0 &amp; \ldots &amp; 0 &amp; m_1 \<br>0 &amp; 2 &amp; \ldots &amp; 0 &amp; m_2 \<br>\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \<br>0 &amp; 0 &amp; \ldots &amp; 2 &amp; m_n \<br>1 &amp; 1 &amp; \ldots &amp; 1 &amp; S \<br>\end{bmatrix}<br>$$<br>è¿™ä¸ªçŸ©é˜µçš„æ‰€æœ‰è¡Œå‘é‡çš„çº¿æ€§ç»„åˆæ„æˆäº†ä¸€ä¸ªæ ¼ï¼Œæ¥ä¸‹æ¥å°†é€šè¿‡æ˜æ–‡çš„ç‰¹ç‚¹å’Œæ ¼ä¸Šçš„ç‰¹æ®Šè§£æ³•æ¥è¿›è¡Œè§£å¯†ã€‚</p><h4 id="LLL"><a class="header-anchor" href="#LLL">Â¶</a>LLL</h4><p>å¯¹äºæ˜æ–‡$X=(x_1,x_2,\ldots,x_n)$è¿™ä¸€ç»„æ•°æ¥è¯´ï¼Œæ„é€ ä¸€ä¸ªå‘é‡<br>$$<br>a=\sum_{i=1}^nx_iv_i-v_{n+1}=(2x_1-1,2x_2-1,\ldots,2x_n-1,0)<br>$$<br>æ˜¾ç„¶ï¼Œaå‘é‡åœ¨æ ¼Lä¸Šã€‚å› ä¸ºXä¸­çš„æ‰€æœ‰xåªèƒ½å–å€¼0æˆ–1ï¼Œå› æ­¤aå‘é‡çš„é•¿åº¦å¾ˆå°ï¼Œçº¦ä¸º$\sqrt{n}$ï¼Œå¯¹äºå¾ˆå¤§çš„æ ¼åŸºæ¥è¯´ï¼Œaå‘é‡æ— ç–‘æ˜¯æ ¼Lä¸Šçš„æœ€å°å‘é‡ï¼Œå› æ­¤æˆ‘ä»¬åˆ©ç”¨LLLç®—æ³•å³å¯æ±‚å‡ºaå‘é‡ã€‚</p><h4 id="ä¾‹é¢˜"><a class="header-anchor" href="#ä¾‹é¢˜">Â¶</a>ä¾‹é¢˜</h4><p>&lt;!â€“codeï¿¼3â€“&gt;<br>è¿™é‡Œæ³¨æ„ä¸€ä¸‹ï¼Œç¬¬ä¸€è¡Œå‘é‡ä¸­æ˜¯æœ‰+1ä¸-1ï¼Œéœ€è¦è¿›è¡Œå–åï¼Œå³-1ä»£è¡¨1ï¼Œ1ä»£è¡¨0ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>éå¯¹ç§°åŠ å¯†</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hitcon 2022-ãŠ™ï¸BabySSS</title>
    <link href="/2022/11/28/hitcon2022-BabySSS/"/>
    <url>/2022/11/28/hitcon2022-BabySSS/</url>
    
    <content type="html"><![CDATA[<p>I implemented a toy Shamirâ€™s Secret Sharing for fun. Can you help me check is there any issues with this?</p><h1>Shamirâ€™s Secret Sharingå¯†é’¥åˆ†äº«ç®—æ³•</h1><p>$$f(x)=a_0 + a_1x + a_2x^2 + â€¦â€¦ + a_{k-1} x^{k-1} mod p<br>$$</p><h1>é¢˜ç›®æºç </h1><p>&lt;!â€“codeï¿¼0â€“&gt;</p><h1>é¢˜ç›®åˆ†æ</h1><p>é¢˜ç›®ç»™äº†8ç»„xï¼Œyçš„å€¼ï¼Œå¯é€šè¿‡CRTæ¨¡xæ±‚å‡ºa_0 ï¼Œé€šè¿‡æ¨¡x^2 å¯æ±‚å‡ºa_1 ï¼ŒåŒç†å¯æ±‚å‡ºæ‰€æœ‰ç³»æ•°ï¼Œæ¢å¤å‡ºpolyevalå‡½æ•°ï¼Œä»è€Œå¾—åˆ°æ­£ç¡®çš„secretã€‚</p><h1>EXP</h1><p>&lt;!â€“codeï¿¼1â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Gaussæ ¼åŸºçº¦ç®€ç®—æ³•</title>
    <link href="/2022/11/24/Gauss%E6%A0%BC%E5%9F%BA%E7%BA%A6%E7%AE%80%E7%AE%97%E6%B3%95/"/>
    <url>/2022/11/24/Gauss%E6%A0%BC%E5%9F%BA%E7%BA%A6%E7%AE%80%E7%AE%97%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<p>ç”±Gaussæå‡ºçš„äºŒç»´æ ¼åŸºçº¦åŒ–ç®—æ³•</p><h1>ç®—æ³•ä¼ªä»£ç </h1><p>å³å¯¹ç»™å®šçš„ä¸¤ä¸ªåŸºå‘é‡è¿›è¡Œä¸æ–­çš„ç›¸äº’çº¦åŒ–ï¼Œæœ€ç»ˆæ±‚å¾—æ ¼ä¸Šçš„æœ€å°å‘é‡</p><p>Loop</p><p>(a) If ||v2|| &lt; ||v1||, swap v1, v2</p><p>(b) Compute m = âŒŠ v1âˆ™v2 / v1âˆ™v1 âŒ‰</p><p>Â© If m = 0, return v1, v2</p><p>(d) v2 = v2 - m*v1</p><p>Continue Loop</p><h1>ä»£ç å®ç°</h1><p>&lt;!â€“codeï¿¼0â€“&gt;</p><h1>ä¾‹é¢˜</h1><p>&lt;!â€“codeï¿¼1â€“&gt;</p><h2 id="æ€è·¯"><a class="header-anchor" href="#æ€è·¯">Â¶</a>æ€è·¯</h2><p>ç»™å®šå…¬é’¥qã€hï¼Œä»¥åŠæ˜æ–‡e</p><p>è¦æ±‚ç§é’¥fã€g</p><p>ä»–ä»¬ä¹‹é—´æœ‰å¦‚ä¸‹å…³ç³»ï¼š</p><p>fh â‰¡ g mod q</p><p>å³ kq + g =fh</p><p>g = fh -kq<br>æ ¹æ®è¿™ä¸€ç‰¹ç‚¹å³å¯æ„é€ æ ¼ï¼Œä¹Ÿå°±æ˜¯æ ¼å¯†ç ä¸­å¾ˆç»å…¸çš„ï¼Œé‡åˆ°ä¸€ä¸ªå‘é‡ä¹˜çŸ©é˜µï¼Œå³å¯è¿›è¡Œæ„é€ </p><p>ç”±äºå­˜åœ¨ä¸€ç»„aã€bï¼Œä½¿å¾—aï¼ˆ1ï¼Œhï¼‰+ bï¼ˆ0ï¼Œqï¼‰=ï¼ˆfï¼Œgï¼‰$a(1,h) + b(0,q) = (f,g)$</p><p>a = fï¼Œb = k</p><p>é€‰å–ä¸€ç»„åŸºåº•ä¸ºï¼ˆ1ï¼Œhï¼‰å’Œï¼ˆ0ï¼Œqï¼‰ï¼Œä¹Ÿå°±æ˜¯ä¸Šè¿°é«˜æ–¯çº¦ç®€ç®—æ³•å½“ä¸­çš„v1ä¸v2ï¼Œæ±‚å‡ºv1ä¸v2æ ¼ä¸Šæœ€å°çš„å‘é‡ï¼Œå³ä¸ºï¼ˆfï¼Œgï¼‰</p><h2 id="EXP"><a class="header-anchor" href="#EXP">Â¶</a>EXP</h2><p>&lt;!â€“codeï¿¼2â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>lattice</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>äºŒå‰æ ‘å»ºç«‹ä¸éå†</title>
    <link href="/2022/11/10/%E4%BA%8C%E5%8F%89%E6%A0%91%E5%BB%BA%E7%AB%8B%E4%B8%8E%E9%81%8D%E5%8E%86/"/>
    <url>/2022/11/10/%E4%BA%8C%E5%8F%89%E6%A0%91%E5%BB%BA%E7%AB%8B%E4%B8%8E%E9%81%8D%E5%8E%86/</url>
    
    <content type="html"><![CDATA[<p>ç½‘ä¸Šå¾ˆå¤šç®—æ³•é€šè¿‡ç›´æ¥å°†äºŒå‰æ ‘ç»“ç‚¹è¿æ¥ï¼Œä»è€Œæ„æˆäºŒå‰æ ‘ï¼Œè¿™é‡Œæˆ‘æ„å»ºäº†ä¸€ä¸ªäºŒå‰æ ‘ç±»ï¼Œé€šè¿‡ç”¨æˆ·æ§åˆ¶è¾“å…¥æ¥å»ºç«‹äºŒå‰æ ‘ã€‚</p><p>æœ‰å±‚åºéå†ï¼Œé€’å½’ã€éé€’å½’çš„å‰åºéå†ã€ä¸­åºéå†ã€ååºéå†ç®—æ³•ã€‚</p><p>&lt;!â€“codeï¿¼0â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>æ•°æ®ç»“æ„ä¸ç®—æ³•</category>
      
    </categories>
    
    
    <tags>
      
      <tag>äºŒå‰æ ‘</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2022ç¥¥äº‘æ¯wp-crypto</title>
    <link href="/2022/10/30/2022-10-30-2022%E7%A5%A5%E4%BA%91%E6%9D%AFwp-crypto/"/>
    <url>/2022/10/30/2022-10-30-2022%E7%A5%A5%E4%BA%91%E6%9D%AFwp-crypto/</url>
    
    <content type="html"><![CDATA[<h1>little little fermat</h1><h2 id="é¢˜ç›®æºç "><a class="header-anchor" href="#é¢˜ç›®æºç ">Â¶</a>é¢˜ç›®æºç </h2><p>&lt;!â€“codeï¿¼0â€“&gt;</p><h2 id="é¢˜ç›®åˆ†æ"><a class="header-anchor" href="#é¢˜ç›®åˆ†æ">Â¶</a>é¢˜ç›®åˆ†æ</h2><p>æ ¹æ®é¢˜ç›®åå­—æ¥çœ‹ï¼Œæ­¤é¢˜å’Œè´¹é©¬å°å®šç†çš„ä½¿ç”¨æœ‰å…³ï¼Œé¢˜ç›®ä¸­æœ‰ä¸€ä¸ª<code> obfuscate</code>å‡½æ•°ï¼Œè¿›è¡Œäº†å¯¹qçš„ç”Ÿæˆï¼Œ<code>q=p+A</code>ï¼Œè¿™é‡Œå¯ä»¥çœ‹ä¸€ä¸‹Açš„èŒƒå›´ï¼Œæ˜¯åœ¨2<sup>[18,319]</sup>ä¹‹é—´ï¼Œå› æ­¤pã€qæ¥è¿‘ï¼Œå°è¯•ä¸€ä¸‹yafuåˆ†è§£ã€‚</p><p><img src="/img/20221030.jpg" alt=""><br>é¢˜ç›®å¯¹må…ˆè¿›è¡Œäº†å¤„ç†ï¼Œå†è¿›è¡ŒRSAåŠ å¯†ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦çŸ¥é“xã€‚<code>assert 114514 ** x % p == 1</code>è¿ç”¨è´¹é©¬å°å®šç†ï¼Œè‹¥114514ä¸päº’ç´ ï¼Œåˆ™x=p-1ï¼Œå³å¯æ±‚è§£mã€‚</p><h2 id="EXP"><a class="header-anchor" href="#EXP">Â¶</a>EXP</h2><p>&lt;!â€“codeï¿¼1â€“&gt;</p><h1>fill</h1><h2 id="é¢˜ç›®æºç -v2"><a class="header-anchor" href="#é¢˜ç›®æºç -v2">Â¶</a>é¢˜ç›®æºç </h2><p>&lt;!â€“codeï¿¼2â€“&gt;</p><h2 id="é¢˜ç›®åˆ†æ-v2"><a class="header-anchor" href="#é¢˜ç›®åˆ†æ-v2">Â¶</a>é¢˜ç›®åˆ†æ</h2><p>éšæœºäº§ç”Ÿ32ä½çš„æ•°ï¼Œsha256()åŠ å¯†åä½œä¸ºflagï¼Œå¹¶å°†å…¶2è¿›åˆ¶çš„æ¯ä¸€ä½å­˜åˆ°äº†<code>f_list</code>æ•°ç»„ä¸­ã€‚</p><p>åˆ åˆ›å»ºäº†ä¸€ä¸ª<code>r_list</code>32ä½æ•°ç»„ï¼Œé‡Œé¢å­˜ç€éšæœºæ•°ï¼Œå…ˆæš‚æ—¶ä¸ç®¡ã€‚</p><p>åŒ å¯¹<code>r_list</code>æ•°ç»„ä¸­çš„éšæœºæ•°åšäº†åŠ å¯†ï¼Œäº§ç”Ÿäº†<code>M</code>æ•°ç»„ã€‚</p><p>å¯¹<code>f_list</code>å’Œ<code>M</code>æ•°ç»„è¿›è¡Œäº†<code>numpy.dot</code>è¿ç®—ï¼Œå³å‘é‡ä¹˜æ³•ï¼Œå¾—åˆ°å’Œä¸ºSã€‚</p><p>å’ åˆ›å»ºäº†ä¸€ä¸ª<code>s</code>æ•°ç»„ï¼Œè¿™ä¸ªå¾ˆæ˜æ˜¾ï¼Œç”¨LCGçº¿æ€§åŒä½™ç®—æ³•è¿›è¡Œäº†åŠ å¯†ã€‚</p><p>æœ€åå°†<code>M</code>æ•°ç»„ä¸<code>s</code>æ•°ç»„ç›¸åŠ ã€‚</p><p>è¿™å°±æ˜¯è¿™é“é¢˜æ•´ä½“çš„æµç¨‹ï¼Œæ¯ä¸€æ­¥å¹¶ä¸éš¾ï¼Œåªæ˜¯æ­¥éª¤å¤šï¼Œç•¥æ˜¾å¤æ‚ã€‚</p><h2 id="EXP-v2"><a class="header-anchor" href="#EXP-v2">Â¶</a>EXP</h2><h3 id="0x01"><a class="header-anchor" href="#0x01">Â¶</a>0x01</h3><p>å¯ä»¥å…ˆè¿›è¡Œä¸€ä¸‹LCGçš„æ±‚è§£ï¼ŒæŠŠsæ•°ç»„æ±‚è§£å‡ºæ¥ï¼Œä»è€Œæ±‚å‡ºMæ•°ç»„ã€‚</p><p>&lt;!â€“codeï¿¼3â€“&gt;</p><h3 id="0x02"><a class="header-anchor" href="#0x02">Â¶</a>0x02</h3><p>æŒ‰ç†æ¥è¯´ï¼Œæ„Ÿè§‰åº”è¯¥æ ¹æ®æ±‚å‡ºæ¥çš„<code>M</code>æ•°ç»„è¿›è¡Œé€†è¿ç®—ï¼Œæ±‚å‡º<code>r_list</code>æ•°ç»„ï¼Œä½†æ˜¯æ±‚å‡ºæ¥<code>r_list</code>æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Œæ‰€ä»¥ç›´æ¥å°è¯•æ±‚<code>f_list</code>ã€‚å› ä¸º<code>f_list</code>ä¸­ä¸æ˜¯0å°±æ˜¯1ï¼Œä¸<code>M</code>åšå‘é‡ä¹˜æ³•ï¼Œå³ä¸º<code>M</code>æ•°ç»„ä¸­è‹¥å¹²å…ƒç´ çš„å’Œã€‚æ ¹æ®é¢˜ç›®ç»™å®šå’ŒSï¼Œå…ˆå¤§æ¦‚çœ‹ä¸€ä¸‹éœ€è¦<code>M</code>ä¸­å¤šå°‘ä¸ªå…ƒç´ ç´¯åŠ ã€‚å‘ç°åœ¨Må‰21ä½å’Œ &lt; Sï¼Œå‰22ä½å’Œ &gt; Sï¼Œæ‰€ä»¥çŒœæƒ³åº”è¯¥æ˜¯Må½“ä¸­ï¼Œé™¤10ä¸ªå·¦å³å…ƒç´ ä¹‹å¤–çš„å’Œã€‚</p><p>è¿™é‡Œå°±éå†äº†ä¸€ä¸‹ï¼Œå¤æ‚åº¦å®åœ¨å¤ªé«˜äº†ï¼Œä¹Ÿæ²¡æƒ³ç€èƒ½å‡ºï¼Œç»“æœè¿˜çœŸç®—å‡ºæ¥äº†o.O</p><p>&lt;!â€“codeï¿¼4â€“&gt;</p><p>ä¹Ÿå°±è¯´æ˜ï¼Œ<code>f_list</code>ä¸­ä¸‹æ ‡ä¸ºè¿™äº›çš„ï¼Œå¯¹åº”å€¼æ˜¯0ï¼Œå…¶ä½™ä¸º1ï¼Œå³å¯å¾—åˆ°msgçš„2è¿›åˆ¶æ•°ï¼Œè½¬ä¸ºåè¿›åˆ¶åè¿›è¡Œ<code>sha256()</code>åŠ å¯†å³å¯ã€‚</p><p>&lt;!â€“codeï¿¼5â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2022NewStarCTF-flip_flop</title>
    <link href="/2022/10/27/2022NewStarCTF-flip_flop/"/>
    <url>/2022/10/27/2022NewStarCTF-flip_flop/</url>
    
    <content type="html"><![CDATA[<h1>flip-flop</h1><p>AES-CBCåŠ å¯†æ¨¡å¼</p><h2 id="é¢˜ç›®"><a class="header-anchor" href="#é¢˜ç›®">Â¶</a>é¢˜ç›®</h2><p>æºç å¦‚ä¸‹ï¼š<br>&lt;!â€“codeï¿¼0â€“&gt;</p><h2 id="é¢˜ç›®åˆ†æ"><a class="header-anchor" href="#é¢˜ç›®åˆ†æ">Â¶</a>é¢˜ç›®åˆ†æ</h2><p>æ­¤é¢˜æ˜¯é€šè¿‡æ³¨å†Œå¾—åˆ°çš„ç”¨æˆ·è´¦æˆ·çš„å¯†æ–‡ï¼Œç„¶åè¾“å…¥ç®¡ç†å‘˜è´¦æˆ·å¯¹åº”çš„å¯†æ–‡ï¼Œæ‰èƒ½å¾—åˆ°flagã€‚</p><p>å¯¹ç”¨æˆ·è´¦æˆ·å’Œç®¡ç†å‘˜è´¦æˆ·çš„åŠ å¯†è§£å¯†å‡é‡‡ç”¨AES-CBCæ¨¡å¼ï¼Œä½†æ˜¯æœ¬é¢˜ä»…æœ‰ä¸€ç»„æ˜æ–‡ï¼Œivä»…ä½œä¸ºåç§»é‡ï¼Œä¹Ÿå°±æ˜¯æœ¬é¢˜ä¸­çš„user_keyã€‚</p><p>è¿™é‡Œå…ˆæ¥è¯´ä¸€ä¸‹æˆ‘æœ€ä¸€å¼€å§‹çš„æ€è·¯ï¼Œç”±äºuser_keyæ¯æ¬¡æ˜¯éšæœºäº§ç”Ÿçš„ï¼Œä½†æ˜¯ä¸€æ¬¡ç¨‹åºçš„è¿è¡Œå½“ä¸­æ˜¯ä¸å˜çš„ã€‚ç”±äºå¯†æ–‡ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œå‰åŠéƒ¨åˆ†ä¸ºuser_key.hex()ï¼ŒååŠéƒ¨åˆ†ä¸ºcode.hex()ï¼Œæ‰€ä»¥åªè¦æ„é€ å‡ºadminå¯¹åº”çš„codeå³å¯ï¼Œé‚£ä¹ˆå°±éœ€è¦AESåŠ å¯†å½“ä¸­çš„keyï¼Œæ‰€ä»¥å°±éœ€è¦æ„é€ ä¸€ä¸ªkeyæ¥äº§ç”Ÿå‡ºadminå¯¹åº”çš„codeã€‚æŸ¥è¯¢äº†å¾ˆå¤šèµ„æ–™å‘ç°éƒ½éš¾ä»¥å®ç°ã€‚äºæ˜¯â€¦â€¦</p><p>é‚£ä¸ºä»€ä¹ˆä¸æ¢ä¸€ä¸‹æ€è·¯ï¼Ÿä¸èƒ½æ„é€ codeï¼Œèƒ½ä¸èƒ½æ„é€ ivï¼Ÿ</p><p>å…ˆæ¥çœ‹ä¸€ä¸‹åŠ å¯†æ–¹å¼ï¼š</p><p>C = encrypt(M ^ iv)</p><p>M = decryptÂ©^iv</p><p>å¯¹åº”ä¸€ä¸‹æœ¬é¢˜å½“ä¸­çš„NewStarCTFerå’Œadminï¼š<br><code>b'NewStarCTFer____' = decrypt(code) ^ iv1</code></p><p><code>b'AdminAdmin______' = decrypt(code) ^ iv2</code></p><p>å› æ­¤å¯æ±‚å‡ºadminå¯¹åº”çš„iv2ï¼Œéšåæ‹¼æ¥ä¸Šæ™®é€šç”¨æˆ·çš„ååŠæ®µcodeå³å¯ã€‚</p><h2 id="EXP"><a class="header-anchor" href="#EXP">Â¶</a>EXP</h2><p>&lt;!â€“codeï¿¼1â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUåˆ·é¢˜æ—¥è®°20221026</title>
    <link href="/2022/10/26/BUU%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B020221026/"/>
    <url>/2022/10/26/BUU%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B020221026/</url>
    
    <content type="html"><![CDATA[<h1>RSA5</h1><h2 id="é¢˜ç›®åˆ†æ"><a class="header-anchor" href="#é¢˜ç›®åˆ†æ">Â¶</a>é¢˜ç›®åˆ†æ</h2><p>ç»™å®še=65537</p><p>ç»™äº†å¾ˆå¤šç»„nã€c</p><p>ç”±äºeè¿‡å¤§ï¼Œæ‰€ä»¥ä¸è€ƒè™‘ä½¿ç”¨CRTï¼Œç”±äºmæ˜¯åŒä¸€ä¸ªï¼Œå› æ­¤éå†ä¸€ä¸‹ï¼Œæ±‚å‡ºä¸¤ä¸ªnçš„æœ€å¤§å…¬çº¦æ•°ï¼Œå³ä¸ºpï¼Œåç»­å°±ç®€å•äº†ã€‚</p><h2 id="EXP"><a class="header-anchor" href="#EXP">Â¶</a>EXP</h2><p>&lt;!â€“codeï¿¼0â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>diary</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2022 DASCTF 10æœˆæŒ‘æˆ˜èµ›wp</title>
    <link href="/2022/10/23/2022DASCTF10%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9Bwp/"/>
    <url>/2022/10/23/2022DASCTF10%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9Bwp/</url>
    
    <content type="html"><![CDATA[<h1>RSA</h1><h2 id="é¢˜ç›®å¦‚ä¸‹"><a class="header-anchor" href="#é¢˜ç›®å¦‚ä¸‹">Â¶</a>é¢˜ç›®å¦‚ä¸‹</h2><p>&lt;!â€“codeï¿¼0â€“&gt;</p><h2 id="é¢˜ç›®åˆ†æ"><a class="header-anchor" href="#é¢˜ç›®åˆ†æ">Â¶</a>é¢˜ç›®åˆ†æ</h2><p>è¯¥é¢˜çš„åŠ å¯†é¡ºåºæ˜¯ï¼š</p><p>1ã€åŠ å¯†flagï¼Œåˆ†ä¸ºä¸¤éƒ¨åˆ†m1ã€m2</p><p>2ã€åŠ å¯†m1</p><p>3ã€åŠ å¯†m2</p><p>åŒç†æˆ‘ä»¬è§£å¯†çš„é¡ºåºåº”è¯¥ä¹Ÿæ˜¯</p><p>1ã€è§£å‡ºm1ã€m2</p><p>2ã€è§£å‡ºflag</p><h3 id="æ±‚m2"><a class="header-anchor" href="#æ±‚m2">Â¶</a>æ±‚m2</h3><p>å…ˆè§‚å¯Ÿä¸€ä¸‹encrypt4å‡½æ•°</p><p>è™½ç„¶è¯´e_2=3ï¼ŒæŒ‰ç†æ¥è¯´ä½¿ç”¨ä½åŠ å¯†æŒ‡æ•°æ”»å‡»ï¼Œä½†å¹¶ä¸å¯è¡Œã€‚</p><p>åˆå› ä¸ºm = m % k</p><p>å¯é€šè¿‡è¿™ç‚¹å’Œ<code>c_3 = pow(m, e_2, n_3)</code>åšéå†æ±‚å‡ºm</p><p>æœ€åå‘ç°må³ä¸ºm2ï¼Œm2 &lt; k</p><h3 id="æ±‚m1"><a class="header-anchor" href="#æ±‚m1">Â¶</a>æ±‚m1</h3><p>å‘ç°m1åŠ å¯†æ–¹å¼é‡‡ç”¨RSAï¼Œä½†æ˜¯n_1æœªçŸ¥</p><p>n_1åˆé€šè¿‡ä¸€æ¬¡RSAåŠ å¯†ï¼Œå·²çŸ¥n_1å¯¹åº”çš„å¯†æ–‡</p><p>åˆ©ç”¨ä½åŠ å¯†æŒ‡æ•°æ”»å‡»è§£å‡ºn1</p><p>å‘ç°n1å¯åˆ†è§£ä¸º3ä¸ªç´ æ•°ä¹˜ç§¯</p><p>æ•…phiå¯æ±‚ï¼Œå³æ±‚å‡ºm1</p><h3 id="æ±‚flag"><a class="header-anchor" href="#æ±‚flag">Â¶</a>æ±‚flag</h3><p>è§‚å¯Ÿencryt1</p><p>m1æ˜¯flagå³ç§»200ä½ä¹‹åè½¬ä¸ºå­—èŠ‚</p><p>m2æ˜¯flagçš„20ä½ä¹‹åè½¬æˆå­—èŠ‚</p><p>æ‰€ä»¥æ¥è¯´m2æ˜¯æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä¸»è¦æ‰¾åˆ°flagçš„å‰20ä½ï¼Œå†æŠŠm2æ‹¼åˆ°åé¢å³å¯ã€‚</p><p>ç”±äºm1æ˜¯flagå³ç§»200ä½ï¼Œå› æ­¤flagçš„ä½ä½ç¼ºå¤±ï¼Œä½†é«˜ä½è¿˜åœ¨ï¼Œç”±äºä¸çŸ¥é“flagæ€»é•¿åº¦ï¼ŒæŠ±ç€è¯•ä¸€è¯•çš„å¿ƒæ€ï¼ŒçŒœæµ‹ä¸€ä¸‹å®ƒçš„é«˜ä½å‰20ä½æ²¡æœ‰ç¼ºå¤±</p><p>æˆ‘ä»¬å°†m1å’Œm2è½¬ä¸ºå­—èŠ‚å‘ç°</p><p>m1:bâ€™0x666c61677b3230366538353964â€™</p><p>m2:bâ€™383539643865383534633466363030636231323735376262663966357dâ€™</p><p>å‘ç°m1å’Œm2æœ‰é‡å éƒ¨åˆ†ï¼Œå³38353å¼€å§‹</p><p>å¯ä»¥è¯å®m1å‰20ä½ç¡®å®æ²¡æœ‰ç¼ºå¤±</p><p>å› æ­¤å–m1å‰20ä½ï¼ŒåŠ m2ï¼Œå³å¯è§£å‡ºflag</p><h2 id="EXP"><a class="header-anchor" href="#EXP">Â¶</a>EXP</h2><p>&lt;!â€“codeï¿¼1â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUåˆ·é¢˜æ—¥è®°20221022</title>
    <link href="/2022/10/22/BUU%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B020221022/"/>
    <url>/2022/10/22/BUU%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B020221022/</url>
    
    <content type="html"><![CDATA[<h1>RSA4</h1><p>é¢˜ç›®åªç»™äº†ä¸‰ç»„nã€cï¼Œé‡‡ç”¨ä¸­å›½å‰©ä½™å®šç†ï¼Œå…·ä½“æ¨å¯¼å¦‚ä¸‹</p><h2 id="æ¨å¯¼è¿‡ç¨‹"><a class="header-anchor" href="#æ¨å¯¼è¿‡ç¨‹">Â¶</a>æ¨å¯¼è¿‡ç¨‹</h2><p>m<sup>e</sup> â‰¡ c1 mod n1<br>m<sup>e</sup> â‰¡ c2 mod n2<br>m<sup>e</sup> â‰¡ c3 mod n3</p><h3 id="ä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰"><a class="header-anchor" href="#ä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰">Â¶</a>ä¸­å›½å‰©ä½™å®šç†ï¼ˆCRTï¼‰</h3><p>ä¸­å›½å‰©ä½™å®šç†çš„å†…å®¹æ˜¯ï¼š</p><p>é’ˆå¯¹ä¸Šè¿°æ–¹ç¨‹ç»„ï¼Œè‹¥n1ã€n2ã€n3äº’è´¨ï¼Œå¯¹äºä»»æ„çš„c1ã€c2ã€c3ï¼Œæ–¹ç¨‹ç»„éƒ½æœ‰è§£ï¼Œä½¿ç”¨æ¡ä»¶æ˜¯m^e &lt; n1ã€n2ã€n3ã€‚é€šè§£å½¢å¼å¦‚ä¸‹ï¼š</p><p>ä»¤N = n1 * n2 * n3ï¼ŒN1 = N/n1ï¼ŒN2ã€N3åŒç†</p><p>ä»¤t1 = N1<sup>(-1)</sup>ï¼Œå³å…¶å¯¹åº”çš„æ¨¡n1è¿ç®—çš„é€†å…ƒï¼Œt2ï¼Œt3åŒç†ï¼Œå¯ç”¨<code>t1=gmpy2.invert(N1,n1)</code>è¡¨ç¤ºã€‚</p><p>æœ‰äº†Niå’Œtiçš„å®šä¹‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç»™å‡ºé€šè§£å½¢å¼ï¼š</p><p>x = c1 * N1 * t1 â€¦â€¦</p><p>æœ‰äº†é€šè§£å…¬å¼æˆ‘ä»¬å°±å¯ä»¥æ±‚å‡ºm^eï¼Œå¯¹eè¿›è¡Œä¸€ä¸‹éå†å³å¯ï¼Œmå¼€æ–¹æˆåŠŸå³å¯ã€‚</p><h2 id="EXP"><a class="header-anchor" href="#EXP">Â¶</a>EXP</h2><p>&lt;!â€“codeï¿¼0â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>diary</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUåˆ·é¢˜æ—¥è®°20221021</title>
    <link href="/2022/10/21/BUU%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B020221021/"/>
    <url>/2022/10/21/BUU%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B020221021/</url>
    
    <content type="html"><![CDATA[<h1>RSA2</h1><p>é¢˜ç›®ç»™å®šnã€eã€dpã€c</p><p>éé¢„æœŸè§£ï¼šç›´æ¥åˆ†è§£n</p><p>ä¸‹é¢è€ƒè™‘nä¸èƒ½åˆ†è§£çš„æƒ…å†µ</p><h2 id="æ¨å¯¼è¿‡ç¨‹"><a class="header-anchor" href="#æ¨å¯¼è¿‡ç¨‹">Â¶</a>æ¨å¯¼è¿‡ç¨‹</h2><p>dp â‰¡ d mod (p-1)</p><p>ed â‰¡ 1 mod (p-1) * (q-1)</p><p>ed = 1 + k2(p-1)(q-1)</p><p>å¯¹1å¼ä¸¤ç«¯åŒä¹˜eï¼Œå¾—</p><p>e * dp â‰¡ ed mod (p-1)</p><p>e * dp = k1(p-1) + ed</p><p>ä»£å…¥edå¾—</p><p>e * dp = k1(p-1) + 1 + k2(p-1)(q-1)</p><p>ç”±äºä¸¤ä¸ªæœªçŸ¥æ•°ç•¥æ˜¾éº»çƒ¦ï¼Œå‘ç°å…¬å› å­(p-1)ï¼Œç­‰å¼ä¸¤è¾¹åŒæ—¶å–ä½™p-1ï¼Œå³å¯æ¶ˆæ‰n</p><p>e * dp â‰¡ 1 mod (p-1)</p><p>e * dp =k(p-1) + 1</p><p>å¾—åˆ°è¿™ä¸ªå¼å­åï¼Œå…¶å®çœŸæ­£æ„ä¹‰ä¸Šçš„æœªçŸ¥æ•°åªæœ‰æˆ‘ä»¬è¦æ±‚çš„pï¼Œä½†æ˜¯è¿˜å­˜åœ¨ä¸€ä¸ªkã€‚</p><p>é’ˆå¯¹kï¼Œæˆ‘ä»¬åˆ¤æ–­ä¸€ä¸‹ä»–çš„èŒƒå›´ï¼Œçœ‹çœ‹èƒ½å¦é‡‡ç”¨çˆ†ç ´çš„æ–¹å¼ã€‚</p><p>k = (e * dp - 1)/(p-1)</p><p>å› ä¸ºdp &lt; p-1</p><p>æ‰€ä»¥k &lt; e</p><p>é€šè¿‡éå†kç„¶åæ‰¾åˆ°(e * dp - 1)å¯ä»¥æ•´é™¤kçš„æƒ…å†µå³å¯ã€‚</p><p>(è·‘äº†ä¸€ä¸‹å‘ç°é™åˆ¶æ¡ä»¶è¿˜ä¸å¤Ÿ)</p><p>å› æ­¤å†åŠ ä¸€ä¸ªnèƒ½å¦æ•´é™¤på³å¯ã€‚</p><h2 id="EXP"><a class="header-anchor" href="#EXP">Â¶</a>EXP</h2><p>&lt;!â€“codeï¿¼0â€“&gt;</p><h1>RSA3</h1><p>ç»™å®šnã€e1ã€c1ã€e2ã€c2ã€‚</p><p>m â‰¡ c1^e1 mod n</p><p>m â‰¡ c2^e2 mod n</p><p>è¿™é‡Œé‡‡ç”¨å…±æ¨¡æ”»å‡»ï¼Œè¯¦ç»†åŸç†å¦‚ä¸‹ï¼š</p><p>æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼šç»™å®šä¸¤ä¸ªæ•´æ•°aã€bï¼Œå¿…å®šå­˜åœ¨xã€yï¼Œä½¿å¾—gcd(a,b)=ax+by</p><p>å¯¹åº”åˆ°æœ¬é¢˜å½“ä¸­ï¼Œç”±äºe1ã€e2äº’ä¸ºç´ æ•°ï¼Œå› æ­¤gcd(e1,e2)=1ï¼Œä»è€Œå­˜åœ¨s1ã€s2ä½¿å¾—:</p><p>s1 * e1 + s2 * e2 = 1</p><h2 id="æ¨å¯¼è¿‡ç¨‹-v2"><a class="header-anchor" href="#æ¨å¯¼è¿‡ç¨‹-v2">Â¶</a>æ¨å¯¼è¿‡ç¨‹</h2><p>m = m % n</p><p>m = m^(s1 * e1 + s2 * e2)^ % n</p><p>m = m^(e1 * s1)^ * m^(e2 * s2)^ % n</p><p>m = (m^(e1 * s1)^ % n) * (m^(e2 * s2)^ % n) % n</p><p>m = (c1<sup>s1</sup> % n) * (c2<sup>s2</sup> % n) % n</p><h2 id="EXP-v2"><a class="header-anchor" href="#EXP-v2">Â¶</a>EXP</h2><p>&lt;!â€“codeï¿¼1â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>diary</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUåˆ·é¢˜æ—¥è®°20221020</title>
    <link href="/2022/10/20/BUU%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B020221020/"/>
    <url>/2022/10/20/BUU%E5%88%B7%E9%A2%98%E6%97%A5%E8%AE%B020221020/</url>
    
    <content type="html"><![CDATA[<h1>RSA1</h1><p>ç»™å®šdpã€dqç±»å‹</p><p>dp â‰¡ d mod (p-1)</p><p>dq â‰¡ d mod (q-1)</p><p>m â‰¡ c<sup>d</sup> mod n</p><p>m = c<sup>d</sup> + k * n</p><p>m = c<sup>d</sup> +k * p * q</p><p>å¯¹ä¸Šå¼ä¸¤ç«¯åŒæ—¶å¯¹pã€qåˆ†åˆ«å–ä½™ï¼Œå¾—ï¼šï¼ˆä¸­å›½å‰©ä½™å®šç†ï¼‰</p><p>m1 â‰¡ c<sup>d</sup> mod p</p><p>m2 â‰¡ c<sup>d</sup> mod q</p><p>åŒç†ï¼Œå¯å¾—åˆ°<br>c<sup>d</sup> = m1 +k * p</p><p>ä»£å…¥åˆ° m2 â‰¡ c<sup>d</sup> mod q ä¸­ï¼š</p><p>m2 â‰¡ (m1 + k * p)mod q ï¼Œä¸¤ç«¯å‡å»m1å¾—</p><p>m2 - m1 â‰¡ k * p mod q ï¼Œä¸¤ç«¯ä¹˜pçš„é€†å…ƒå¾—</p><p>(m2 - m1)p<sup>-1</sup> â‰¡ k mod q</p><p>å°†kä»£å…¥åˆ° c<sup>d</sup> = m1 +k * p ä¸­å¾—ï¼š</p><p>c<sup>d</sup> = m1 + ((m2 - m1)p<sup>-1</sup> mod q) * p</p><p>m=c<sup>d</sup> mod n</p><p>å¾—åˆ°</p><p>m â‰¡ (((m2 - m1) * p<sup>-1</sup> mod q) * p + m1) mod n</p><p>æ¥ä¸‹æ¥å°±æ˜¯æ±‚è§£m1ï¼Œm2</p><p>m1 â‰¡ c<sup>dp+k(p-1)</sup> mod p</p><p>m2 â‰¡ c<sup>dq+k(q-1)</sup> mod q</p><p>æ ¹æ®è´¹é©¬å°å®šç†</p><p>è‹¥pæ˜¯ç´ æ•°ï¼Œåˆ™a<sup>(p-1)</sup> â‰¡ 1 mod p</p><p>å› æ­¤ m1 â‰¡ c<sup>dp</sup> mod pï¼Œm2 â‰¡ c<sup>dq</sup> mod q</p><p>æœ€ç»ˆå¯æ±‚å¾—m</p><h2 id="exp"><a class="header-anchor" href="#exp">Â¶</a>exp</h2><p>&lt;!â€“codeï¿¼0â€“&gt;</p><h1>RSAROLL</h1><p>&lt;!â€“codeï¿¼1â€“&gt;<br>ç»™äº†ä¸€ä¸ªdata.txtæ–‡ä»¶ï¼Œæ‰“å¼€ç›²çŒœä¸€ä¸‹ç¬¬ä¸€è¡Œæ˜¯nï¼Œeï¼Œåé¢æ˜¯c<br>&lt;!â€“codeï¿¼2â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>diary</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2021ByteCTF-easyxor</title>
    <link href="/2022/10/16/2021ByteCTF-easyxor/"/>
    <url>/2022/10/16/2021ByteCTF-easyxor/</url>
    
    <content type="html"><![CDATA[<h1>é¢˜ç›®æºç å¦‚ä¸‹</h1><p>&lt;!â€“codeï¿¼0â€“&gt;</p><h1>é¢˜ç›®åˆ†æ</h1><p>å°†flagåˆ†ä¸ºä¸¤æ®µï¼Œå‰åŠæ®µé‡‡ç”¨OFBåŠ å¯†ï¼ŒååŠæ®µé‡‡ç”¨CBCåŠ å¯†</p><h2 id="OFBè§£å¯†"><a class="header-anchor" href="#OFBè§£å¯†">Â¶</a>OFBè§£å¯†</h2><p>å°†å‰åŠæ®µflagåˆè¿›è¡Œåˆ‡åˆ†ï¼Œå°†å…¶8ä½åˆ†ä¸ºä¸€ç»„ï¼Œå­˜åˆ°groupæ•°ç»„ä¸­ã€‚<br>&lt;!â€“codeï¿¼1â€“&gt;<br>é’ˆå¯¹ä¸€ä¸ªéšæœºç”Ÿæˆçš„64ä½çš„lastï¼Œä¸keysè¿›è¡ŒconvertåŠ å¯†ï¼Œå†ä¸groupä¸­çš„æ•°è¿›è¡Œå¼‚æˆ–ã€‚<br>keysæ˜¯å››ä¸ª-32ï½32çš„æ•°ï¼Œå¯çˆ†ç ´ã€‚<br>å¯¹äºOFBè§£å¯†ååˆ†ç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬å·²çŸ¥ç¬¬ä¸€ç»„æ˜æ–‡ï¼Œæ°å¥½æ˜¯8ä½çš„â€™ByteCTF{'ï¼Œç”±äºåˆ†ç»„å¯†ç çš„æ€§è´¨ï¼Œæ‰€ä»¥åé¢çš„ä¹Ÿå°±è¿åˆƒè€Œè§£ï¼Œé€šè¿‡group[ 0]^cipher[ 0] å³å¯å¾—åˆ°cur_cï¼Œä»è€Œæ±‚å¾—ä¸‹ä¸€æ¬¡çš„cur_cï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><h3 id="expOFB"><a class="header-anchor" href="#expOFB">Â¶</a>expOFB</h3><p>&lt;!â€“codeï¿¼2â€“&gt;</p><h2 id="CBCè§£å¯†"><a class="header-anchor" href="#CBCè§£å¯†">Â¶</a>CBCè§£å¯†</h2><p>é’ˆå¯¹ååŠéƒ¨åˆ†ï¼Œæˆ‘ä»¬éœ€è¦é€†å‘è§£å‡ºconvertå‡½æ•°ï¼Œå› æ­¤å°±æ˜¯å¯¹shiftå‡½æ•°ä¸­çš„åŠ å¯†è¿ç®—è¿›è¡Œè§£å¯†ã€‚<br>ä¹‹å‰ä¸Šç½‘æœçš„wpéƒ½ä¸€ç¬”å¸¦è¿‡ï¼Œæ²¡è§£é‡Šunshifté€†å‡½æ•°æ€ä¹ˆå†™çš„ã€‚â€œéš¾é“æœ‰ä»€ä¹ˆå®šç†ï¼Ÿï¼Ÿâ€<br>è¿™é‡Œç®€å•å†™ä¸€ä¸‹æˆ‘çš„ç†è§£ã€‚</p><h3 id="åˆ†æshift"><a class="header-anchor" href="#åˆ†æshift">Â¶</a>åˆ†æshift</h3><p>&lt;!â€“codeï¿¼3â€“&gt;</p><h4 id="æ¨ç†è¿‡ç¨‹"><a class="header-anchor" href="#æ¨ç†è¿‡ç¨‹">Â¶</a>æ¨ç†è¿‡ç¨‹</h4><p>è¿™é‡Œæˆ‘ä»¬ä¸¾ä¾‹k&gt;0æ—¶çš„æƒ…å†µã€‚ï¼ˆk&lt;0åŒç†ï¼‰</p><p>må’Œcéƒ½æ˜¯64ä½,kæ˜¯-32ï½32çš„10è¿›åˆ¶æ•°ã€‚</p><p>1ã€m &lt;&lt; kç›¸å½“äºåœ¨måè¡¥kä½0ï¼Œå¾—åˆ°çš„æ–°æ•°æˆ‘ä»¬ç§°ä¸ºaï¼Œa=m &lt;&lt; kã€‚</p><p>2ã€ä»¤b = a &amp; cï¼Œç”±äºaæ˜¯64+kä½ï¼Œcæ˜¯64ä½ï¼Œæ‰€ä»¥bæ˜¯64ä½ï¼Œå¹¶ä¸”bçš„åkä½éƒ½æ˜¯0ã€‚</p><p>3ã€ä»¤x = m ^ bï¼Œxåˆ™æ˜¯shiftåŠ å¯†ä¹‹åçš„å€¼ï¼Œxä¹Ÿæ˜¯64ä½ï¼Œå¹¶ä¸”xçš„åkä½æ˜¯ä¸mçš„åkä½ç›¸åŒçš„ï¼Œä¸0å¼‚æˆ–å¾—æœ¬èº«ã€‚</p><p>æˆ‘ä»¬èµ°å®Œäº†ä¸€éshiftåŠ å¯†ï¼Œå¾—åˆ°çš„ç»“è®ºæ˜¯ï¼Œå¯†æ–‡çš„ä½æ•°åŒæ ·æ˜¯64ï¼Œå¹¶ä¸”å¯†æ–‡çš„åkä½ä¸æ˜æ–‡ç›¸åŒã€‚</p><h3 id="åˆ†æunshift"><a class="header-anchor" href="#åˆ†æunshift">Â¶</a>åˆ†æunshift</h3><p>&lt;!â€“codeï¿¼4â€“&gt;</p><h4 id="æ¨ç†è¿‡ç¨‹-v2"><a class="header-anchor" href="#æ¨ç†è¿‡ç¨‹-v2">Â¶</a>æ¨ç†è¿‡ç¨‹</h4><p>åŒæ ·æˆ‘ä»¬ä¸¾ä¾‹k&gt;0çš„æƒ…å†µã€‚</p><p>ä¹‹å‰æˆ‘ä»¬å¾—åˆ°çš„å¯†æ–‡xï¼Œç›¸å½“äºtmpã€‚</p><p>1ã€aâ€™=tmp &lt;&lt; kï¼Œtmpåkä½ä¸º0ï¼Œtmpå2kï½kä½ç­‰äºmçš„åkä½ã€‚</p><p>2ã€bâ€™=aâ€™ &amp; cï¼Œbâ€™åkä½ä¸º0ï¼Œå2kï½kä½ä¸ºm&amp;cã€‚</p><p>3ã€y=x ^ bâ€™ï¼Œyçš„åkä½ï¼Œç­‰äºxçš„åkä½ï¼Œä¹Ÿå°±æ˜¯mçš„åkä½ã€‚</p><p>4ã€yçš„å2kï½kä½ï¼Œåœ¨shiftåŠ å¯†å½“ä¸­ï¼Œa &amp; cçš„å2kï½kä½ç­‰äºmçš„åkä½&amp;cï¼Œè®°ä½œm1 &amp; cã€‚</p><p>shiftä¸­çš„xï¼Œä¹Ÿå°±æ˜¯m ^ bï¼Œm ^(m1 &amp; c)ï¼Œåœ¨unshiftæœ€åçš„ä¸€æ­¥æ“ä½œä¸­ï¼Œy= m ^(m1 &amp; c) ^ bâ€™ã€‚</p><p>è¿™æ—¶æˆ‘ä»¬åªè€ƒè™‘yçš„å2kï½kä½ï¼Œy=m ^(m1 &amp; c)^(m1 &amp; c) = m</p><p>æ‰€ä»¥è¿™æ—¶yçš„2kï½kä½ä¹Ÿç­‰äºmäº†ã€‚</p><h4 id="æ€»ç»“"><a class="header-anchor" href="#æ€»ç»“">Â¶</a>æ€»ç»“</h4><p>å› æ­¤ï¼Œæˆ‘ä»¬å‘ç°æ¯ç»è¿‡unshiftä¸€æ¬¡ï¼Œå°±æœ‰kä½è¢«è¿˜åŸï¼Œä½•æ—¶æ‰èƒ½è¢«å®Œå…¨è¿˜åŸï¼Ÿå³å¾ªç¯bits//kæ¬¡ã€‚</p><p>æ­¤æ¨ç†æ­£ç¡®ï¼Œå¯ä»¥åœ¨unshiftå‡½æ•°è¿è¡Œæ—¶è¾“å‡ºæ¯æ¬¡çš„tmpè§‚å¯Ÿå³å¯ã€‚</p><p>psï¼šè‡ªæˆ‘æ„Ÿè§‰è¿™ç§ä½è¿ç®—åº”è¯¥æ˜¯å±äºä¸€ç§æ€§è´¨æˆ–è€…å®šç†ï¼Œç½‘ä¸Šå¤§ä½¬ä»¬éƒ½æ˜¯è¯´â€œç®€å•å†™ä¸ªé€†â€ã€‚ã€‚ã€‚</p><h3 id="expCBC"><a class="header-anchor" href="#expCBC">Â¶</a>expCBC</h3><p>&lt;!â€“codeï¿¼5â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2022BUUCTFæ–°ç”Ÿèµ›-RSA</title>
    <link href="/2022/10/16/2022BUUCTF%E6%96%B0%E7%94%9F%E8%B5%9B-RSA/"/>
    <url>/2022/10/16/2022BUUCTF%E6%96%B0%E7%94%9F%E8%B5%9B-RSA/</url>
    
    <content type="html"><![CDATA[<h1>é¢˜ç›®æºç </h1><p>&lt;!â€“codeï¿¼0â€“&gt;</p><h1>é¢˜ç›®åˆ†æ</h1><p>å‘ç°nå’Œphinéƒ½ä¸å¸¸è§„ï¼Œæ²¡å…¥æ‰‹ç‚¹ï¼Œå‘ç°hintï¼Œhint=pow(d,e,n)ï¼Œæœ‰è¶£ï¼Œç”¨dåšæ˜æ–‡ï¼Œå°è¯•æ¨ç†ä¸€ä¸‹ï¼š<br>d = pow(hint,d,n)<br>d = pow((d ** e % n),d,n)<br>d = (d ** e % n) ** d % n<br>d = d ** (e*d) % n<br>d = pow(d ** e,d,n)<br>æŠŠd ** eå†æ¬¡çœ‹åšå¯†æ–‡ï¼Œå¯å¾—<br>d ** e = pow(d,e,n)<br>å› ä¸ºhint = pow(d,e,n)<br>å¯å¾—hint = d ** e<br>d ** e * e ** e-&gt;(ed) ** e-&gt;(ed) ** e == 1 mod phin<br>å› æ­¤æ ¹æ®eå’Œhintå³å¯æ±‚å¾—phin<br>ä»è€Œå¾—åˆ°phinå’Œnçš„æœ€å¤§å…¬çº¦æ•°p<br>è„šæœ¬å¦‚ä¸‹<br>&lt;!â€“codeï¿¼1â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>CTF</category>
      
    </categories>
    
    
    <tags>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¢¦å¼€å§‹çš„åœ°æ–¹</title>
    <link href="/2022/10/15/%E6%A2%A6%E5%BC%80%E5%A7%8B%E7%9A%84%E5%9C%B0%E6%96%B9/"/>
    <url>/2022/10/15/%E6%A2%A6%E5%BC%80%E5%A7%8B%E7%9A%84%E5%9C%B0%E6%96%B9/</url>
    
    <content type="html"><![CDATA[<h2 id="Macä¸‹åˆ©ç”¨Hexoå’Œgithub-pagesæ­å»ºä¸ªäººåšå®¢"><a class="header-anchor" href="#Macä¸‹åˆ©ç”¨Hexoå’Œgithub-pagesæ­å»ºä¸ªäººåšå®¢">Â¶</a>Macä¸‹åˆ©ç”¨Hexoå’Œgithub pagesæ­å»ºä¸ªäººåšå®¢</h2><h3 id="ç¯å¢ƒé…ç½®"><a class="header-anchor" href="#ç¯å¢ƒé…ç½®">Â¶</a>ç¯å¢ƒé…ç½®</h3><h4 id="1-Node-jså®‰è£…"><a class="header-anchor" href="#1-Node-jså®‰è£…">Â¶</a>1.Node.jså®‰è£…</h4><p>ä¸‹è½½åœ°å€ï¼š<a href="https://nodejs.org/en/">Node.js</a></p><h4 id="2-æ·˜å®é•œåƒå®‰è£…"><a class="header-anchor" href="#2-æ·˜å®é•œåƒå®‰è£…">Â¶</a>2.æ·˜å®é•œåƒå®‰è£…</h4><p>&lt;!â€“codeï¿¼0â€“&gt;</p><h4 id="3-å®‰è£…Hexo"><a class="header-anchor" href="#3-å®‰è£…Hexo">Â¶</a>3.å®‰è£…Hexo</h4><p>&lt;!â€“codeï¿¼1â€“&gt;</p><h3 id="åˆå§‹åŒ–Hexo-Blog"><a class="header-anchor" href="#åˆå§‹åŒ–Hexo-Blog">Â¶</a>åˆå§‹åŒ–Hexo Blog</h3><h4 id="1-åˆå§‹åŒ–Hexo"><a class="header-anchor" href="#1-åˆå§‹åŒ–Hexo">Â¶</a>1.åˆå§‹åŒ–Hexo</h4><p>æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å¹¶è¿›å…¥ï¼Œä¾‹å¦‚blog<br>&lt;!â€“codeï¿¼2â€“&gt;</p><h4 id="2-æœ¬åœ°å¯åŠ¨Hexo"><a class="header-anchor" href="#2-æœ¬åœ°å¯åŠ¨Hexo">Â¶</a>2.æœ¬åœ°å¯åŠ¨Hexo</h4><p>&lt;!â€“codeï¿¼3â€“&gt;<br>æµè§ˆå™¨æ‰“å¼€ç½‘ç«™ï¼Œå³å¯çœ‹åˆ°æœ¬åœ°åšå®¢</p><h3 id="åˆ›å»ºåšå®¢æ–‡ç« "><a class="header-anchor" href="#åˆ›å»ºåšå®¢æ–‡ç« ">Â¶</a>åˆ›å»ºåšå®¢æ–‡ç« </h3><h4 id="1-åˆ›å»ºæ–‡ç« "><a class="header-anchor" href="#1-åˆ›å»ºæ–‡ç« ">Â¶</a>1.åˆ›å»ºæ–‡ç« </h4><p>&lt;!â€“codeï¿¼4â€“&gt;<br>åœ¨blogæ–‡ä»¶å¤¹ä¸­çš„_posté‡Œå³å¯çœ‹åˆ°æ–°å»ºçš„mdæ–‡ä»¶</p><h4 id="2-æ¸…ç†ç¼“å­˜é¡¹ç›®"><a class="header-anchor" href="#2-æ¸…ç†ç¼“å­˜é¡¹ç›®">Â¶</a>2.æ¸…ç†ç¼“å­˜é¡¹ç›®</h4><p>åœ¨æ–°å»ºåšå®¢æˆ–ä¿®æ”¹åšå®¢æ—¶ï¼Œéœ€è¦è¿›è¡Œè¯¥æ“ä½œ<br>&lt;!â€“codeï¿¼5â€“&gt;</p><h4 id="3-é‡æ–°ç”Ÿæˆåšå®¢"><a class="header-anchor" href="#3-é‡æ–°ç”Ÿæˆåšå®¢">Â¶</a>3.é‡æ–°ç”Ÿæˆåšå®¢</h4><p>&lt;!â€“codeï¿¼6â€“&gt;</p><h4 id="4-å¯åŠ¨åšå®¢"><a class="header-anchor" href="#4-å¯åŠ¨åšå®¢">Â¶</a>4.å¯åŠ¨åšå®¢</h4><p>&lt;!â€“codeï¿¼7â€“&gt;</p>]]></content>
    
    
    <categories>
      
      <category>å»ºç«™</category>
      
    </categories>
    
    
    <tags>
      
      <tag>åšå®¢æ­å»º</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2022/10/15/hello-world/"/>
    <url>/2022/10/15/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a class="header-anchor" href="#Quick-Start">Â¶</a>Quick Start</h2><h3 id="Create-a-new-post"><a class="header-anchor" href="#Create-a-new-post">Â¶</a>Create a new post</h3><p>&lt;!â€“codeï¿¼0â€“&gt;</p><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a class="header-anchor" href="#Run-server">Â¶</a>Run server</h3><p>&lt;!â€“codeï¿¼1â€“&gt;</p><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a class="header-anchor" href="#Generate-static-files">Â¶</a>Generate static files</h3><p>&lt;!â€“codeï¿¼2â€“&gt;</p><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a class="header-anchor" href="#Deploy-to-remote-sites">Â¶</a>Deploy to remote sites</h3><p>&lt;!â€“codeï¿¼3â€“&gt;</p><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
