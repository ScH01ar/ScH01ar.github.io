<!DOCTYPE html>
<html lang=zh>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="renderer" content="webkit">
  <meta http-equiv="Cache-Control" content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no,email=no,adress=no">
  <!-- Color theme for statusbar -->
  <meta name="theme-color" content="#000000" />
  <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
  <meta http-equiv="window-target" content="_top" />
  
  
  <title>2022DASCTF_NOV-lllcccggg-wp | Y&#39;s Blog</title>
  <meta name="description" content="题目描述 如题目名字一样，有好多个lcg，当时看晕了 123456789101112131415161718192021222324252627282930313233343536373839404142434445from Crypto.Util.number import *key&#x3D;b&#39;*************&#39;key&#x3D;bytes_to_long(key)key&#x3D;bin(key)[2:]n">
<meta property="og:type" content="article">
<meta property="og:title" content="2022DASCTF_NOV-lllcccggg-wp">
<meta property="og:url" content="https://sch01ar.github.io/2022/11/30/2022DASCTF_NOV-lllcccgggwp/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="题目描述 如题目名字一样，有好多个lcg，当时看晕了 123456789101112131415161718192021222324252627282930313233343536373839404142434445from Crypto.Util.number import *key&#x3D;b&#39;*************&#39;key&#x3D;bytes_to_long(key)key&#x3D;bin(key)[2:]n">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2022-11-29T16:00:00.000Z">
<meta property="article:modified_time" content="2022-11-30T07:21:15.071Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="wp">
<meta name="twitter:card" content="summary">
  <!-- Canonical links -->
  <link rel="canonical" href="https://sch01ar.github.io/2022/11/30/2022DASCTF_NOV-lllcccgggwp/index.html">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/y.png" type="image/x-icon">
  
  
<link rel="stylesheet" href="/css/style.css">

  
    <link href="//cdn.jsdelivr.net/npm/katex@0.9.0/dist/katex.min.css" rel="stylesheet">
  
  
  
  
<meta name="generator" content="Hexo 6.3.0"><style>mjx-container[jax="SVG"] {
  direction: ltr;
}

mjx-container[jax="SVG"] > svg {
  overflow: visible;
}

mjx-container[jax="SVG"][display="true"] {
  display: block;
  text-align: center;
  margin: 1em 0;
}

mjx-container[jax="SVG"][justify="left"] {
  text-align: left;
}

mjx-container[jax="SVG"][justify="right"] {
  text-align: right;
}

g[data-mml-node="merror"] > g {
  fill: red;
  stroke: red;
}

g[data-mml-node="merror"] > rect[data-background] {
  fill: yellow;
  stroke: none;
}

g[data-mml-node="mtable"] > line[data-line] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > rect[data-frame] {
  stroke-width: 70px;
  fill: none;
}

g[data-mml-node="mtable"] > .mjx-dashed {
  stroke-dasharray: 140;
}

g[data-mml-node="mtable"] > .mjx-dotted {
  stroke-linecap: round;
  stroke-dasharray: 0,140;
}

g[data-mml-node="mtable"] > svg {
  overflow: visible;
}

[jax="SVG"] mjx-tool {
  display: inline-block;
  position: relative;
  width: 0;
  height: 0;
}

[jax="SVG"] mjx-tool > mjx-tip {
  position: absolute;
  top: 0;
  left: 0;
}

mjx-tool > mjx-tip {
  display: inline-block;
  padding: .2em;
  border: 1px solid #888;
  font-size: 70%;
  background-color: #F8F8F8;
  color: black;
  box-shadow: 2px 2px 5px #AAAAAA;
}

g[data-mml-node="maction"][data-toggle] {
  cursor: pointer;
}

mjx-status {
  display: block;
  position: fixed;
  left: 1em;
  bottom: 1em;
  min-width: 25%;
  padding: .2em .4em;
  border: 1px solid #888;
  font-size: 90%;
  background-color: #F8F8F8;
  color: black;
}

foreignObject[data-mjx-xml] {
  font-family: initial;
  line-height: normal;
  overflow: visible;
}

.MathJax path {
  stroke-width: 3;
}

mjx-container[display="true"] {
  overflow: auto hidden;
}

mjx-container[display="true"] + br {
  display: none;
}
</style></head>


<body class="main-center theme-black" itemscope itemtype="http://schema.org/WebPage">
  <header class="header" itemscope itemtype="http://schema.org/WPHeader">
  <div class="slimContent">
    <div class="navbar-header">
      
      
      <div class="profile-block text-center">
        <a id="avatar" href="https://github.com/Sch01ar" target="_blank">
          <img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200">
        </a>
        <h2 id="name" class="hidden-xs hidden-sm">yy</h2>
        <h3 id="title" class="hidden-xs hidden-sm hidden-md">Time tells</h3>
        <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> Dalian, China</small>
      </div>
      
      <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation">
      <ul class="nav navbar-nav main-nav ">
        
        
        <li class="menu-item menu-item-home">
          <a href="/.">
            
            <i class="icon icon-home-fill"></i>
            
            <span class="menu-title">首页</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives">
            
            <i class="icon icon-archives-fill"></i>
            
            <span class="menu-title">归档</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories">
            
            <i class="icon icon-folder"></i>
            
            <span class="menu-title">分类</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags">
            
            <i class="icon icon-tags"></i>
            
            <span class="menu-title">标签</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-repository">
          <a href="/repository">
            
            <i class="icon icon-project"></i>
            
            <span class="menu-title">项目</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-books">
          <a href="/books">
            
            <i class="icon icon-book-fill"></i>
            
            <span class="menu-title">书单</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-links">
          <a href="/links">
            
            <i class="icon icon-friendship"></i>
            
            <span class="menu-title">友链</span>
          </a>
        </li>
        
        
        <li class="menu-item menu-item-about">
          <a href="/about">
            
            <i class="icon icon-cup-fill"></i>
            
            <span class="menu-title">关于</span>
          </a>
        </li>
        
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/Sch01ar" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>

  
    <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>欢迎交流与分享经验!</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/">CTF</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%BB%BA%E7%AB%99/">建站</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/">数据结构与算法</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签</h3>
    <div class="widget-body">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/diary/" rel="tag">diary</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lattice/" rel="tag">lattice</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wp/" rel="tag">wp</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/" rel="tag">二叉树</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" rel="tag">博客搭建</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/" rel="tag">非对称加密</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签云</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/diary/" style="font-size: 13.5px;">diary</a> <a href="/tags/lattice/" style="font-size: 13px;">lattice</a> <a href="/tags/wp/" style="font-size: 14px;">wp</a> <a href="/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/" style="font-size: 13px;">二叉树</a> <a href="/tags/%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA/" style="font-size: 13px;">博客搭建</a> <a href="/tags/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86/" style="font-size: 13px;">非对称加密</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">归档</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">十月 2022</a><span class="archive-list-count">11</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/CTF/">CTF</a>
              </p>
              <p class="item-title">
                <a href="/2022/11/30/2022DASCTF_NOV-lllcccgggwp/" class="title">2022DASCTF_NOV-lllcccggg-wp</a>
              </p>
              <p class="item-date">
                <time datetime="2022-11-29T16:00:00.000Z" itemprop="datePublished">2022-11-30</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/CTF/">CTF</a>
              </p>
              <p class="item-title">
                <a href="/2022/11/29/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98%E7%AE%97%E6%B3%95/" class="title">背包加密算法</a>
              </p>
              <p class="item-date">
                <time datetime="2022-11-28T16:00:00.000Z" itemprop="datePublished">2022-11-29</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/CTF/">CTF</a>
              </p>
              <p class="item-title">
                <a href="/2022/11/28/hitcon2022-BabySSS/" class="title">Hitcon 2022-㊙️BabySSS</a>
              </p>
              <p class="item-date">
                <time datetime="2022-11-27T16:00:00.000Z" itemprop="datePublished">2022-11-28</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/CTF/">CTF</a>
              </p>
              <p class="item-title">
                <a href="/2022/11/24/Gauss%E6%A0%BC%E5%9F%BA%E7%BA%A6%E7%AE%80%E7%AE%97%E6%B3%95/" class="title">Gauss格基约简算法</a>
              </p>
              <p class="item-date">
                <time datetime="2022-11-23T16:00:00.000Z" itemprop="datePublished">2022-11-24</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/">数据结构与算法</a>
              </p>
              <p class="item-title">
                <a href="/2022/11/10/%E4%BA%8C%E5%8F%89%E6%A0%91%E5%BB%BA%E7%AB%8B%E4%B8%8E%E9%81%8D%E5%8E%86/" class="title">二叉树建立与遍历</a>
              </p>
              <p class="item-date">
                <time datetime="2022-11-09T16:00:00.000Z" itemprop="datePublished">2022-11-10</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

  
  
  <aside class="sidebar sidebar-toc collapse   in  " id="collapseToc" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    <nav id="toc" class="article-toc">
      <h3 class="toc-title">文章目录</h3>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text"> 题目描述</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text"> 题目分析</span></a></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">3.</span> <span class="toc-text"> EXP</span></a></li></ol>
    </nav>
  </div>
</aside>

<main class="main" role="main">
  <div class="content">
  <article id="post-2022DASCTF_NOV-lllcccgggwp" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting">
    
    <div class="article-header">
      
        
  
    <h1 class="article-title" itemprop="name">
      2022DASCTF_NOV-lllcccggg-wp
    </h1>
  

      
      <div class="article-meta">
        <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2022/11/30/2022DASCTF_NOV-lllcccgggwp/" class="article-date">
	  <time datetime="2022-11-29T16:00:00.000Z" itemprop="datePublished">2022-11-30</time>
	</a>
</span>
        
  <span class="article-category">
    <i class="icon icon-folder"></i>
    <a class="article-category-link" href="/categories/CTF/">CTF</a>
  </span>

        
  <span class="article-tag">
    <i class="icon icon-tags"></i>
	<a class="article-tag-link-link" href="/tags/wp/" rel="tag">wp</a>
  </span>


        
	<span class="article-read hidden-xs">
	    <i class="icon icon-eye-fill" aria-hidden="true"></i>
	    <span id="busuanzi_container_page_pv">
			<span id="busuanzi_value_page_pv">0</span>
		</span>
	</span>


        <span class="post-comment"><i class="icon icon-comment"></i> <a href="/2022/11/30/2022DASCTF_NOV-lllcccgggwp/#comments" class="article-comment-link">评论</a></span>
        
      </div>
    </div>
    <div class="article-entry marked-body" itemprop="articleBody">
      
        <h1><span id="题目描述"> 题目描述</span></h1>
<p>如题目名字一样，有好多个lcg，<s>当时看晕了</s></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line">key=<span class="string">b'*************'</span></span><br><span class="line">key=bytes_to_long(key)</span><br><span class="line">key=<span class="built_in">bin</span>(key)[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">n=getPrime(<span class="number">256</span>)</span><br><span class="line">a=[getPrime(<span class="number">256</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(key)):</span><br><span class="line">    a.append(a[i-<span class="number">1</span>]*<span class="number">2</span>)</span><br><span class="line">b=getPrime(<span class="number">256</span>)</span><br><span class="line">m=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">    m.append((a[i]*b)%n)</span><br><span class="line">s=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">    s+=m[i]*<span class="built_in">int</span>(key[i])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">seed=s</span><br><span class="line">a = getPrime(<span class="number">300</span>)</span><br><span class="line">b = getPrime(<span class="number">300</span>)</span><br><span class="line">n = getPrime(<span class="number">300</span>)</span><br><span class="line">output = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    seed = (a*seed+b)%n</span><br><span class="line">    output.append(seed)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"output = "</span>,output)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'m='</span>,m)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">state=<span class="built_in">int</span>(key,<span class="number">2</span>)</span><br><span class="line">a=getPrime(<span class="number">256</span>)</span><br><span class="line">b=getPrime(<span class="number">256</span>)</span><br><span class="line">c=getPrime(<span class="number">256</span>)</span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>**<span class="number">10000</span>):</span><br><span class="line">    state = (a * state + b) % c</span><br><span class="line">flag=<span class="string">b'****************************************'</span></span><br><span class="line">state_md5=hashlib.md5(<span class="built_in">str</span>(state).encode()).hexdigest()</span><br><span class="line">xorflag=xor(flag,state_md5).<span class="built_in">hex</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'a='</span>,a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'b='</span>,b)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'c='</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'xorflag='</span>,xorflag)</span><br></pre></td></tr></table></figure>
<h1><span id="题目分析"> 题目分析</span></h1>
<p>1.<code>key</code>是一个背包问题，已知公钥<code>m</code>，和的话目前不知道。</p>
<p>2.以1中的和为<code>seed</code>，通过LCG产生了一组序列<code>output</code>。</p>
<p>至此，已经可以根据<code>output</code>来求出LCG中的a、b、n，从而求出<code>seed</code>，从而通过背包可求得key。</p>
<p>3.以<code>key</code>为seed，称作<code>state</code>，再进行LCG，<code>state = (a * state + b) % c</code>，并且a，b，c已知。</p>
<p>但是想要直接正向求解出最后的state，十分困难，for循环了10^10000次，这里涉及到了<strong>矩阵快速幂</strong>的使用。</p>
<p>通过构造矩阵</p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi mathvariant="bold">A</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mi mathvariant="bold">C</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnalign="center center center center" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>a</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>b</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{A} = \left[
\begin{array}{cccc}
state &amp; 1
\end{array}
\right]

\mathbf{C} = \left[
\begin{array}{cccc}
a &amp; 0\\
b &amp; 1\\
\end{array}
\right]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68611em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">A</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.20001em;vertical-align:-0.35001em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">[</span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="mord mathnormal">t</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8500000000000001em;"><span style="top:-3.01em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.35000000000000003em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">]</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathbf">C</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">a</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></span></p>
<p>通过计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∗</mo><msup><mi>C</mi><mrow><mn>10</mn><mo>∗</mo><mn>10000</mn></mrow></msup></mrow><annotation encoding="application/x-tex">A*C^{10*10000}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mbin mtight">∗</span><span class="mord mtight">1</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">0</span><span class="mord mtight">0</span></span></span></span></span></span></span></span></span></span></span></span>即可得到矩阵B，B = [ state, 1]</p>
<p>4.求出state后进行异或解密即可。</p>
<h1><span id="exp"> EXP</span></h1>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> reduce</span><br><span class="line"><span class="keyword">from</span> math <span class="keyword">import</span> gcd</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crack_unknown_modulus</span>(<span class="params">states</span>):</span><br><span class="line">    diffs = [s1 - s0 <span class="keyword">for</span> s0, s1 <span class="keyword">in</span> <span class="built_in">zip</span>(states, states[<span class="number">1</span>:])]</span><br><span class="line">    zeroes = [t2*t0 - t1*t1 <span class="keyword">for</span> t0, t1, t2 <span class="keyword">in</span> <span class="built_in">zip</span>(diffs, diffs[<span class="number">1</span>:], diffs[<span class="number">2</span>:])]</span><br><span class="line">    modulus = <span class="built_in">abs</span>(reduce(gcd, zeroes))</span><br><span class="line">    <span class="keyword">return</span> modulus</span><br><span class="line"></span><br><span class="line">output = [<span class="number">75581294523880849612962675076574164955427439308298754836702542570856707873339581806556114</span>, <span class="number">85105032146983524265511965363979041936757881362506442483720291395014453678757599185295866</span>, <span class="number">1135521205967352800446368309480529634045225881261100886117662161359310082444102071893527191</span>, <span class="number">668602662320826002160475166323016971968419541611162501120982012317608523771962990634779874</span>, <span class="number">649673553234341629614052928960182629959348742983379959653724041939165898600067312959677865</span>, <span class="number">785853955591839090537858092210736716046894245185520583713505441606094906159642640920286905</span>, <span class="number">937799570303158165818350743257433287791556030352377438071495081189542968310256239806349207</span>, <span class="number">734514754865608924980327625447363286114899547828404532253101460271494241963897226149955073</span>, <span class="number">1106313725444442262780946046218124519471559148520571880678416934586056489046936771811070897</span>, <span class="number">8768152099561586039808874499029856564696410477579827751292882367683300035228537162519939</span>]</span><br><span class="line">m= [<span class="number">72110328606337761986452574632319920368225905906258123752738204764660440229296</span>, <span class="number">54011682421724526639264309053337133761455956763651742732220904522794415369243</span>, <span class="number">17814390052498055944887777895371560547916058478438980691186304039062365649137</span>, <span class="number">35628780104996111889775555790743121095832116956877961382372608078124731298274</span>, <span class="number">71257560209992223779551111581486242191664233913755922764745216156249462596548</span>, <span class="number">52306145629033450225461382951669777408332612778647340756234927305972460103747</span>, <span class="number">14403316467115903117281925692036847841669370508430176739214349605418455118145</span>, <span class="number">28806632934231806234563851384073695683338741016860353478428699210836910236290</span>, <span class="number">57613265868463612469127702768147391366677482033720706956857398421673820472580</span>, <span class="number">25017556945976227604614565324992075758359109018576909140459291836821175855811</span>, <span class="number">50035113891952455209229130649984151516718218037153818280918583673642351711622</span>, <span class="number">9861252992953913084817421088665596058440581025443131788581662340758238333895</span>, <span class="number">19722505985907826169634842177331192116881162050886263577163324681516476667790</span>, <span class="number">39445011971815652339269684354662384233762324101772527154326649363032953335580</span>, <span class="number">78890023943631304678539368709324768467524648203545054308653298726065906671160</span>, <span class="number">67571073096311612023437897207346829960053441358225603844051092445605348252971</span>, <span class="number">44933171401672226713234954203390952945111027667586702914846679884684231416593</span>, <span class="number">89866342803344453426469908406781905890222055335173405829693359769368462833186</span>, <span class="number">89523710815737909519298976602261104805448255621482306886131214532210460577023</span>, <span class="number">88838446840524821704957112993219502635900656194100108999006924057894456064697</span>, <span class="number">87467918890098646076273385775136298296805457339335713224758343109262447040045</span>, <span class="number">84726862989246294818905931338969889618615059629806921676261181211998428990741</span>, <span class="number">79244751187541592304171022466637072262234264210749338579266857417470392892133</span>, <span class="number">68280527584132187274701204721971437549472673372634172385278209828414320694917</span>, <span class="number">46352080377313377215761569232640168123949491696403839997300914650302176300485</span>, <span class="number">2495185963675757097882298253977629272903128343943175221346324294077887511621</span>, <span class="number">4990371927351514195764596507955258545806256687886350442692648588155775023242</span>, <span class="number">9980743854703028391529193015910517091612513375772700885385297176311550046484</span>, <span class="number">19961487709406056783058386031821034183225026751545401770770594352623100092968</span>, <span class="number">39922975418812113566116772063642068366450053503090803541541188705246200185936</span>, <span class="number">79845950837624227132233544127284136732900107006181607083082377410492400371872</span>, <span class="number">69482926884297456930826248043265566490804358963498709392909249814458335654395</span>, <span class="number">48756878977643916528011655875228426006612862878132914012562994622390206219441</span>, <span class="number">7304783164336835722382471539154145038229870707401323251870484238253947349533</span>, <span class="number">14609566328673671444764943078308290076459741414802646503740968476507894699066</span>, <span class="number">29219132657347342889529886156616580152919482829605293007481936953015789398132</span>, <span class="number">58438265314694685779059772313233160305838965659210586014963873906031578796264</span>, <span class="number">26667555838438374224478704415163613636682076269556667256672242805536692503179</span>, <span class="number">53335111676876748448957408830327227273364152539113334513344485611073385006358</span>, <span class="number">16461248562802499564273977449351747571732450029362164253433466215620304923367</span>, <span class="number">32922497125604999128547954898703495143464900058724328506866932431240609846734</span>, <span class="number">65844994251209998257095909797406990286929800117448657013733864862481219693468</span>, <span class="number">41481013711468999180550979383511273598863745186032809254212224718435974297587</span>, <span class="number">82962027422937998361101958767022547197727490372065618508424449436871948595174</span>, <span class="number">75715080054924999388563077322742387420459125695266732243593393867217432100999</span>, <span class="number">61221185318899001443485314434182067865922396341668959713931282727908399112649</span>, <span class="number">32233395846847005553329788657061428756848937634473414654607060449290333135949</span>, <span class="number">64466791693694011106659577314122857513697875268946829309214120898580666271898</span>, <span class="number">38724608596437024879678314416943008052399895489029153845172736790634867454447</span>, <span class="number">77449217192874049759356628833886016104799790978058307690345473581269734908894</span>, <span class="number">64689459594797102185072417456469325234603726907252110607435442156013004728439</span>, <span class="number">39169944398643207036503994701635943494211598765639716441615379305499544367529</span>, <span class="number">78339888797286414073007989403271886988423197531279432883230758610999088735058</span>, <span class="number">66470802803621830812375138595241067001850540013694360993206012215471712380767</span>, <span class="number">42732630816292664291109436979179427028705224978524217213156519424416959672185</span>, <span class="number">85465261632585328582218873958358854057410449957048434426313038848833919344370</span>, <span class="number">80721548474219659830796907705415001139825044865232364079370572691141373599391</span>, <span class="number">71234122157488322327952975199527295304654234681600223385485640375756282109433</span>, <span class="number">52259269524025647322265110187751883634312614314335941997715775744986099129517</span>, <span class="number">14309564257100297310889380164201060293629373579807379222176046483445733169685</span>, <span class="number">28619128514200594621778760328402120587258747159614758444352092966891466339370</span>, <span class="number">57238257028401189243557520656804241174517494319229516888704185933782932678740</span>, <span class="number">24267539265851381153474201102305775374039133589594529004152866861039400268131</span>, <span class="number">48535078531702762306948402204611550748078267179189058008305733722078800536262</span>, <span class="number">6861182272454527280255964197920394521160679309513611243355962437631135983175</span>, <span class="number">13722364544909054560511928395840789042321358619027222486711924875262271966350</span>, <span class="number">27444729089818109121023856791681578084642717238054444973423849750524543932700</span>, <span class="number">54889458179636218242047713583363156169285434476108889946847699501049087865400</span>, <span class="number">19569941568321439150454586955423605363575013903353275120439893995571710641451</span>, <span class="number">39139883136642878300909173910847210727150027806706550240879787991143421282902</span>, <span class="number">78279766273285756601818347821694421454300055613413100481759575982286842565804</span>, <span class="number">66350557755620515869995855432086135933604256177961696190263646958047220042259</span>, <span class="number">42492140720290034406350870652869564892212657307058887607271788909567974995169</span>, <span class="number">84984281440580068812701741305739129784425314614117775214543577819135949990338</span>, <span class="number">79759588090209140291762642400175552593854774179371045655831650631745434891327</span>, <span class="number">69310201389467283249884444589048398212713693309877586538407796256964404693305</span>, <span class="number">48411427987983569166128048966794089450431531570890668303560087507402344297261</span>, <span class="number">6613881185016140998615257722285471925867208092916831833864670008278223505173</span>, <span class="number">13227762370032281997230515444570943851734416185833663667729340016556447010346</span>, <span class="number">26455524740064563994461030889141887703468832371667327335458680033112894020692</span>, <span class="number">52911049480129127988922061778283775406937664743334654670917360066225788041384</span>, <span class="number">15613124169307258644203283345264843838879474437804804568579215125925110993419</span>, <span class="number">31226248338614517288406566690529687677758948875609609137158430251850221986838</span>, <span class="number">62452496677229034576813133381059375355517897751219218274316860503700443973676</span>, <span class="number">34696018563507071819985426550816043736039940453573931775378216000874422858003</span>, <span class="number">69392037127014143639970853101632087472079880907147863550756432001748845716006</span>, <span class="number">48575099463077289946300865991961467969163906765431222328257358996971226342663</span>, <span class="number">6941224135203582558960891772620228963331958481997939883259212987415987595977</span>, <span class="number">13882448270407165117921783545240457926663916963995879766518425974831975191954</span>, <span class="number">27764896540814330235843567090480915853327833927991759533036851949663950383908</span>, <span class="number">55529793081628660471687134180961831706655667855983519066073703899327900767816</span>, <span class="number">20850611372306323609733428150620956438315480663102533358891902792129336446283</span>, <span class="number">41701222744612647219466856301241912876630961326205066717783805584258672892566</span>, <span class="number">83402445489225294438933712602483825753261922652410133435567611168517345785132</span>, <span class="number">76595916187499591544226584993664944531527990255955762097879717330508226480915</span>, <span class="number">62982857584048185754812329776027182088060125463047019422503929654489987872481</span>, <span class="number">35756740377145374175983819340751657201124395877229534071752354302453510655613</span>, <span class="number">71513480754290748351967638681503314402248791754459068143504708604907021311226</span>, <span class="number">52817986717630499370294437151703921829501728460053631513753912203287577533103</span>, <span class="number">15426998644310001406948034092105136684007601871242758254252319400048689976857</span>, <span class="number">30853997288620002813896068184210273368015203742485516508504638800097379953714</span>, <span class="number">61707994577240005627792136368420546736030407484971033017009277600194759907428</span>, <span class="number">33207014363529013921943432525538386497064959921077561260763050193863054725507</span>, <span class="number">66414028727058027843886865051076772994129919842155122521526100387726109451014</span>, <span class="number">42619082663165058354132889890850839013263984635445740269796695768925753812679</span>, <span class="number">85238165326330116708265779781701678026527969270891480539593391537851507625358</span>, <span class="number">80267355861709236082890719352100649078060083492918456305931278069176550161367</span>, <span class="number">70325736932467474832140598492898591181124311936972407838607051131826635233385</span>, <span class="number">50442499073983952330640356774494475387252768825080310903958597257126805377421</span>, <span class="number">10676023357016907327639873337686243799509682601296117034661689507727145665493</span>, <span class="number">21352046714033814655279746675372487599019365202592234069323379015454291330986</span>, <span class="number">42704093428067629310559493350744975198038730405184468138646758030908582661972</span>, <span class="number">85408186856135258621118986701489950396077460810368936277293516061817165323944</span>, <span class="number">80607398921319519908597133191677193817159066571873367781331527117107865558539</span>, <span class="number">71005823051688042483553426172051680659322278094882230789407549227689266027729</span>, <span class="number">51802671312425087633466012132800654343648701140899956805559593448852066966109</span>, <span class="number">13396367833899177933291184054298601712301547232935408837863681891177668842869</span>, <span class="number">26792735667798355866582368108597203424603094465870817675727363782355337685738</span>, <span class="number">53585471335596711733164736217194406849206188931741635351454727564710675371476</span>, <span class="number">16961967880242426132688632223086106723416522814618765929653950122894885653603</span>, <span class="number">33923935760484852265377264446172213446833045629237531859307900245789771307206</span>, <span class="number">67847871520969704530754528892344426893666091258475063718615800491579542614412</span>, <span class="number">45486768250988411727868217573386146812336327468085622663976095976632620139475</span>, <span class="number">764561711025826122095594935469586649676799887306740554696686946738775189601</span>, <span class="number">1529123422051652244191189870939173299353599774613481109393373893477550379202</span>, <span class="number">3058246844103304488382379741878346598707199549226962218786747786955100758404</span>, <span class="number">6116493688206608976764759483756693197414399098453924437573495573910201516808</span>, <span class="number">12232987376413217953529518967513386394828798196907848875146991147820403033616</span>, <span class="number">24465974752826435907059037935026772789657596393815697750293982295640806067232</span>, <span class="number">48931949505652871814118075870053545579315192787631395500587964591281612134464</span>, <span class="number">7654924220354746294595311528804384183634530526398286227920424176036759179579</span>, <span class="number">15309848440709492589190623057608768367269061052796572455840848352073518359158</span>, <span class="number">30619696881418985178381246115217536734538122105593144911681696704147036718316</span>, <span class="number">61239393762837970356762492230435073469076244211186289823363393408294073436632</span>, <span class="number">32269812734724943379884144249567439963156633373508074873471281810061681783915</span>, <span class="number">64539625469449886759768288499134879926313266747016149746942563620123363567830</span>, <span class="number">38870276147948776185895736786967052877630678445167794720629622233720262046311</span>, <span class="number">77740552295897552371791473573934105755261356890335589441259244467440524092622</span>, <span class="number">65272129800844107409942106936565504535526858731806674109262983928354583095895</span>, <span class="number">40335284810737217486243373661828302096057862414748843445270462850182701102441</span>, <span class="number">80670569621474434972486747323656604192115724829497686890540925700365402204882</span>, <span class="number">71132164451997872611332654436010501409235594610130869007826346394204339320415</span>, <span class="number">52055354113044747889024468660718295843475334171397233242397187781882213551481</span>, <span class="number">13901733435138498444408097110133884711954813293929961711538870557237962013613</span>, <span class="number">27803466870276996888816194220267769423909626587859923423077741114475924027226</span>, <span class="number">55606933740553993777632388440535538847819253175719846846155482228951848054452</span>, <span class="number">21004892690156990221623936669768370720642651302575188919055459451377231019555</span>, <span class="number">42009785380313980443247873339536741441285302605150377838110918902754462039110</span>, <span class="number">84019570760627960886495746679073482882570605210300755676221837805508924078220</span>, <span class="number">77830166730304924439350653146844258790145355371737006579188170604491383067091</span>, <span class="number">65451358669658851545060466082385810605294855694609508385120836202456301044833</span>]</span><br><span class="line">a2= <span class="number">102146678855348749881681741830301892566150942749854546938156269348575567682569</span></span><br><span class="line">b2= <span class="number">57926598868103510549704115342815226386495366694945712679089221082045615713293</span></span><br><span class="line">c= <span class="number">79112540456632613121737537841885533313599936328220061653608162113976717833173</span></span><br><span class="line">xor = <span class="number">0x2079677330734e7d07116d73543d03316c6501555c02403b7201080612101049</span></span><br><span class="line">n = crack_unknown_modulus(output)</span><br><span class="line">a=(output[<span class="number">2</span>]-output[<span class="number">1</span>])*inverse((output[<span class="number">1</span>]-output[<span class="number">0</span>]),n)%n</span><br><span class="line">b=(output[<span class="number">1</span>]-a*output[<span class="number">0</span>])%n</span><br><span class="line">seed = (inverse(a,n)*(output[<span class="number">0</span>]-b))%n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># sage</span></span><br><span class="line"><span class="comment"># sum = seed</span></span><br><span class="line"><span class="comment"># nbits=len(m)</span></span><br><span class="line"><span class="comment"># A=Matrix(ZZ,nbits+1,nbits+1)</span></span><br><span class="line"><span class="comment"># for i in range(nbits):</span></span><br><span class="line"><span class="comment">#     A[i,i]=2</span></span><br><span class="line"><span class="comment">#     A[i,-1]=m[i]</span></span><br><span class="line"><span class="comment"># for i in range(nbits+1):</span></span><br><span class="line"><span class="comment">#     A[-1,i]=1</span></span><br><span class="line"><span class="comment"># A[-1,-1]=sum</span></span><br><span class="line"><span class="comment"># A[:,-1]=2**100</span></span><br><span class="line"><span class="comment"># r=A.LLL()</span></span><br><span class="line"><span class="comment"># for i in r:</span></span><br><span class="line"><span class="comment">#     if len(set(i[:-1])) == 2:</span></span><br><span class="line"><span class="comment">#         print(i)</span></span><br><span class="line"></span><br><span class="line">key=[-<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>, <span class="number">0</span>]</span><br><span class="line">key0=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">    <span class="keyword">if</span> key[i]==-<span class="number">1</span>:</span><br><span class="line">        key0.append(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> key[i]==<span class="number">1</span>:</span><br><span class="line">        key0.append(<span class="number">0</span>)</span><br><span class="line">state = <span class="built_in">int</span>(<span class="string">''</span>.join([<span class="built_in">str</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> key0]), <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 矩阵快速幂</span></span><br><span class="line"><span class="comment"># a = 102146678855348749881681741830301892566150942749854546938156269348575567682569</span></span><br><span class="line"><span class="comment"># b = 57926598868103510549704115342815226386495366694945712679089221082045615713293</span></span><br><span class="line"><span class="comment"># c = 79112540456632613121737537841885533313599936328220061653608162113976717833173</span></span><br><span class="line"><span class="comment"># state = 1459518099080641908882248947391577149455413355</span></span><br><span class="line"><span class="comment"># A=[state,1]</span></span><br><span class="line"><span class="comment"># A = Matrix(Zmod(c),A)</span></span><br><span class="line"><span class="comment"># C = Matrix(Zmod(c),[[a, 0], [b, 1]])</span></span><br><span class="line"><span class="comment"># state=A*C^(10**10000)</span></span><br><span class="line"><span class="comment"># print(state)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">state=<span class="number">5413978693489756582509930284917854732906886271552898511650182850401353715151</span></span><br><span class="line">state_md5=hashlib.md5(<span class="built_in">str</span>(state).encode()).hexdigest()</span><br><span class="line">state_md5=bytes_to_long(state_md5.encode())</span><br><span class="line">flag=long_to_bytes(state_md5^xor)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># b'DASCTF{D0u_Ge_1S_R4al1y_G00d!!!}'</span></span><br></pre></td></tr></table></figure>
      
    </div>
    <div class="article-footer">
      <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
    <li class="post-copyright-link hidden-xs">
      <strong>本文链接：</strong>
      <a href="https://sch01ar.github.io/2022/11/30/2022DASCTF_NOV-lllcccgggwp/" title="2022DASCTF_NOV-lllcccggg-wp" target="_blank" rel="external">https://sch01ar.github.io/2022/11/30/2022DASCTF_NOV-lllcccgggwp/</a>
    </li>
    
    <li class="post-copyright-license">
      <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
    </li>
  </ul>
</blockquote>


<div class="panel panel-default panel-badger">
  <div class="panel-body">
    <figure class="media">
      <div class="media-left">
        <a href="https://github.com/Sch01ar" target="_blank" class="img-burn thumb-sm visible-lg">
          <img src="/images/avatar.jpg" class="img-rounded w-full" alt="">
        </a>
      </div>
      <div class="media-body">
        <h3 class="media-heading"><a href="https://github.com/Sch01ar" target="_blank"><span class="text-dark">yy</span><small class="ml-1x">Time tells</small></a></h3>
        <div></div>
      </div>
    </figure>
  </div>
</div>


    </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="vcomments"></div>
    
  </section>


  
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    
    <li class="next">
      <a href="/2022/11/29/%E8%83%8C%E5%8C%85%E9%97%AE%E9%A2%98%E7%AE%97%E6%B3%95/" title="背包加密算法"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
    <li class="toggle-toc">
      <a class="toggle-btn " data-toggle="collapse" href="#collapseToc" aria-expanded="false" title="文章目录" role="button">    <span>[&nbsp;</span><span>文章目录</span>
        <i class="text-collapsed icon icon-anchor"></i>
        <i class="text-in icon icon-close"></i>
        <span>]</span>
      </a>
    </li>
    
  </ul>
  
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div>
    
  </div>
  </div>
</nav>
  


</main>

  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
	
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/Sch01ar" target="_blank" title="Github" data-toggle=tooltip data-placement=top><i class="icon icon-github"></i></a></li>
        
    </ul>

    <div class="copyright">
    	
        <div class="publishby">
        	Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div>
    </div>
</footer>
  <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>


<script src="/js/application.js"></script>


    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>






   
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





   
    
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/valine"></script>
  <script type="text/javascript">
  var GUEST = ['nick', 'mail', 'link'];
  var meta = 'nick,mail,link';
  meta = meta.split(',').filter(function(item) {
    return GUEST.indexOf(item) > -1;
  });
  new Valine({
    el: '#vcomments',
    verify: false,
    notify: false,
    appId: 'Rhw3kBGfeXk25zumsz2Th5Sy-gzGzoHsz',
    appKey: 'a1iD3B9BVfe3b1tHRmB8dCwE',
    placeholder: 'Just go go',
    avatar: 'mm',
    meta: meta,
    pageSize: '10' || 10,
    visitor: false
  });
  </script>

     







</body>
</html>